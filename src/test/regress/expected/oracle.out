\set ECHO all
SET client_min_messages = warning;
SET datestyle TO ISO;
SET client_encoding = utf8;
-- test guc enable_oracle_compatible
select name, setting, context, vartype, source, boot_val
    from pg_settings 
    where name = 'enable_oracle_compatible';
           name           | setting | context | vartype | source  | boot_val 
--------------------------+---------+---------+---------+---------+----------
 enable_oracle_compatible | off     | user    | bool    | default | off
(1 row)

-- test pg_oracle namespace
select oid, nspname, nspowner 
    from pg_namespace 
    where oid = 5500;
 oid  |  nspname  | nspowner 
------+-----------+----------
 5500 | pg_oracle |       10
(1 row)

set enable_oracle_compatible = on;
set search_path = foo, public, not_there_initially;
select current_schemas(true);
        current_schemas        
-------------------------------
 {pg_catalog,public,pg_oracle}
(1 row)

create schema not_there_initially;
select current_schemas(true);
                  current_schemas                  
---------------------------------------------------
 {pg_catalog,public,not_there_initially,pg_oracle}
(1 row)

drop schema not_there_initially;
select current_schemas(true);
        current_schemas        
-------------------------------
 {pg_catalog,public,pg_oracle}
(1 row)

reset search_path;
reset enable_oracle_compatible;
select current_schemas(true);
        current_schemas        
-------------------------------
 {pg_catalog,public,pg_oracle}
(1 row)

set enable_oracle_compatible = off;
set search_path = foo, public, not_there_initially;
select current_schemas(true);
        current_schemas        
-------------------------------
 {pg_catalog,public,pg_oracle}
(1 row)

create schema not_there_initially;
select current_schemas(true);
                  current_schemas                  
---------------------------------------------------
 {pg_catalog,public,not_there_initially,pg_oracle}
(1 row)

drop schema not_there_initially;
select current_schemas(true);
        current_schemas        
-------------------------------
 {pg_catalog,public,pg_oracle}
(1 row)

reset search_path;
reset enable_oracle_compatible;
select current_schemas(true);
        current_schemas        
-------------------------------
 {pg_catalog,public,pg_oracle}
(1 row)

-- test Alias
select * from (VALUES(1,2,3)) as v0;
 column1 | column2 | column3 
---------+---------+---------
       1 |       2 |       3
(1 row)

select * from (VALUES(1,2,3));
 column1 | column2 | column3 
---------+---------+---------
       1 |       2 |       3
(1 row)

drop table if exists test1;
create table test1(tc1 int2, tc2 int4, tc3 int8, tc4 float4, tc5 float8);
drop table if exists test2;
create table test2(tc1 int2, tc2 int4, tc3 int8, tc4 float4, tc5 float8);
insert into test1 values(1,2,3,4,5);
insert into test1 values(6,7,8,9,0);
insert into test2 values(1,2,3,4,5);
insert into test2 values(6,7,8,9,0);
select * 
    from (select * from test1 order by tc1, tc2, tc3, tc4, tc5),
         (select * from test2 order by tc5, tc4, tc3, tc2, tc1);
 tc1 | tc2 | tc3 | tc4 | tc5 | tc1 | tc2 | tc3 | tc4 | tc5 
-----+-----+-----+-----+-----+-----+-----+-----+-----+-----
   1 |   2 |   3 |   4 |   5 |   6 |   7 |   8 |   9 |   0
   1 |   2 |   3 |   4 |   5 |   1 |   2 |   3 |   4 |   5
   6 |   7 |   8 |   9 |   0 |   6 |   7 |   8 |   9 |   0
   6 |   7 |   8 |   9 |   0 |   1 |   2 |   3 |   4 |   5
(4 rows)

drop table test1;
drop table test2;
-- test number/binary_float/binary_double
drop table if exists test1;
create table test1(tc1 binary_float, tc2 binary_double, tc3 number, tc4 float4, tc5 float8, tc6 numeric);
create index idx_test1_tc1 on test1(tc1);
create index idx_test1_tc2 on test1(tc2);
create index idx_test1_tc3 on test1(tc3);
create index idx_test1_tc4 on test1(tc4);
create index idx_test1_tc5 on test1(tc5);
create index idx_test1_tc6 on test1(tc6);
\d+ test1
                                       Table "public.test1"
 Column |       Type       | Collation | Nullable | Default | Storage | Stats target | Description 
--------+------------------+-----------+----------+---------+---------+--------------+-------------
 tc1    | real             |           |          |         | plain   |              | 
 tc2    | double precision |           |          |         | plain   |              | 
 tc3    | numeric          |           |          |         | main    |              | 
 tc4    | real             |           |          |         | plain   |              | 
 tc5    | double precision |           |          |         | plain   |              | 
 tc6    | numeric          |           |          |         | main    |              | 
Indexes:
    "idx_test1_tc1" btree (tc1)
    "idx_test1_tc2" btree (tc2)
    "idx_test1_tc3" btree (tc3)
    "idx_test1_tc4" btree (tc4)
    "idx_test1_tc5" btree (tc5)
    "idx_test1_tc6" btree (tc6)
Distribute By: HASH(tc1)
Location Nodes: ALL DATANODES

insert into test1 values(10.0123456789, 11.0123456789, 12.0123456789, 13.0123456789, 14.0123456789, 15.0123456789);
insert into test1 values(20.0123456789, 22.0123456789, 22.0123456789, 23.0123456789, 24.0123456789, 25.0123456789);
insert into test1 values(30.0123456789, 33.0123456789, 32.0123456789, 33.0123456789, 34.0123456789, 35.0123456789);
insert into test1 values(40.0123456789, 44.0123456789, 42.0123456789, 43.0123456789, 44.0123456789, 45.0123456789);
insert into test1 values(50.0123456789, 55.0123456789, 52.0123456789, 53.0123456789, 54.0123456789, 55.0123456789);
insert into test1 values(60.0123456789, 66.0123456789, 62.0123456789, 63.0123456789, 64.0123456789, 65.0123456789);
insert into test1 values(70.0123456789, 77.0123456789, 72.0123456789, 73.0123456789, 74.0123456789, 75.0123456789);
insert into test1 values(80.0123456789, 88.0123456789, 82.0123456789, 83.0123456789, 84.0123456789, 85.0123456789);
insert into test1 values(90.0123456789, 99.0123456789, 92.0123456789, 93.0123456789, 94.0123456789, 95.0123456789);
-- explain select * from test1 where tc1 > 20.0123456789 and tc1 < 70.0123456789 order by tc1;
-- explain select * from test1 where tc2 > 20.0123456789 and tc2 < 70.0123456789 order by tc2;
-- explain select * from test1 where tc3 > 20.0123456789 and tc3 < 70.0123456789 order by tc3;
-- explain select * from test1 where tc4 > 20.0123456789 and tc4 < 70.0123456789 order by tc4;
-- explain select * from test1 where tc5 > 20.0123456789 and tc5 < 70.0123456789 order by tc5;
-- explain select * from test1 where tc6 > 20.0123456789 and tc6 < 70.0123456789 order by tc6;
select * from test1 where tc1 > 20.0123456789 and tc1 < 70.0123456789 order by tc1;
   tc1   |      tc2      |      tc3      |   tc4   |      tc5      |      tc6      
---------+---------------+---------------+---------+---------------+---------------
 20.0123 | 22.0123456789 | 22.0123456789 | 23.0123 | 24.0123456789 | 25.0123456789
 30.0123 | 33.0123456789 | 32.0123456789 | 33.0123 | 34.0123456789 | 35.0123456789
 40.0123 | 44.0123456789 | 42.0123456789 | 43.0123 | 44.0123456789 | 45.0123456789
 50.0123 | 55.0123456789 | 52.0123456789 | 53.0123 | 54.0123456789 | 55.0123456789
 60.0123 | 66.0123456789 | 62.0123456789 | 63.0123 | 64.0123456789 | 65.0123456789
 70.0123 | 77.0123456789 | 72.0123456789 | 73.0123 | 74.0123456789 | 75.0123456789
(6 rows)

select * from test1 where tc2 > 20.0123456789 and tc2 < 70.0123456789 order by tc2;
   tc1   |      tc2      |      tc3      |   tc4   |      tc5      |      tc6      
---------+---------------+---------------+---------+---------------+---------------
 20.0123 | 22.0123456789 | 22.0123456789 | 23.0123 | 24.0123456789 | 25.0123456789
 30.0123 | 33.0123456789 | 32.0123456789 | 33.0123 | 34.0123456789 | 35.0123456789
 40.0123 | 44.0123456789 | 42.0123456789 | 43.0123 | 44.0123456789 | 45.0123456789
 50.0123 | 55.0123456789 | 52.0123456789 | 53.0123 | 54.0123456789 | 55.0123456789
 60.0123 | 66.0123456789 | 62.0123456789 | 63.0123 | 64.0123456789 | 65.0123456789
(5 rows)

select * from test1 where tc3 > 20.0123456789 and tc3 < 70.0123456789 order by tc3;
   tc1   |      tc2      |      tc3      |   tc4   |      tc5      |      tc6      
---------+---------------+---------------+---------+---------------+---------------
 20.0123 | 22.0123456789 | 22.0123456789 | 23.0123 | 24.0123456789 | 25.0123456789
 30.0123 | 33.0123456789 | 32.0123456789 | 33.0123 | 34.0123456789 | 35.0123456789
 40.0123 | 44.0123456789 | 42.0123456789 | 43.0123 | 44.0123456789 | 45.0123456789
 50.0123 | 55.0123456789 | 52.0123456789 | 53.0123 | 54.0123456789 | 55.0123456789
 60.0123 | 66.0123456789 | 62.0123456789 | 63.0123 | 64.0123456789 | 65.0123456789
(5 rows)

select * from test1 where tc4 > 20.0123456789 and tc4 < 70.0123456789 order by tc4;
   tc1   |      tc2      |      tc3      |   tc4   |      tc5      |      tc6      
---------+---------------+---------------+---------+---------------+---------------
 20.0123 | 22.0123456789 | 22.0123456789 | 23.0123 | 24.0123456789 | 25.0123456789
 30.0123 | 33.0123456789 | 32.0123456789 | 33.0123 | 34.0123456789 | 35.0123456789
 40.0123 | 44.0123456789 | 42.0123456789 | 43.0123 | 44.0123456789 | 45.0123456789
 50.0123 | 55.0123456789 | 52.0123456789 | 53.0123 | 54.0123456789 | 55.0123456789
 60.0123 | 66.0123456789 | 62.0123456789 | 63.0123 | 64.0123456789 | 65.0123456789
(5 rows)

select * from test1 where tc5 > 20.0123456789 and tc5 < 70.0123456789 order by tc5;
   tc1   |      tc2      |      tc3      |   tc4   |      tc5      |      tc6      
---------+---------------+---------------+---------+---------------+---------------
 20.0123 | 22.0123456789 | 22.0123456789 | 23.0123 | 24.0123456789 | 25.0123456789
 30.0123 | 33.0123456789 | 32.0123456789 | 33.0123 | 34.0123456789 | 35.0123456789
 40.0123 | 44.0123456789 | 42.0123456789 | 43.0123 | 44.0123456789 | 45.0123456789
 50.0123 | 55.0123456789 | 52.0123456789 | 53.0123 | 54.0123456789 | 55.0123456789
 60.0123 | 66.0123456789 | 62.0123456789 | 63.0123 | 64.0123456789 | 65.0123456789
(5 rows)

select * from test1 where tc6 > 20.0123456789 and tc6 < 70.0123456789 order by tc6;
   tc1   |      tc2      |      tc3      |   tc4   |      tc5      |      tc6      
---------+---------------+---------------+---------+---------------+---------------
 20.0123 | 22.0123456789 | 22.0123456789 | 23.0123 | 24.0123456789 | 25.0123456789
 30.0123 | 33.0123456789 | 32.0123456789 | 33.0123 | 34.0123456789 | 35.0123456789
 40.0123 | 44.0123456789 | 42.0123456789 | 43.0123 | 44.0123456789 | 45.0123456789
 50.0123 | 55.0123456789 | 52.0123456789 | 53.0123 | 54.0123456789 | 55.0123456789
 60.0123 | 66.0123456789 | 62.0123456789 | 63.0123 | 64.0123456789 | 65.0123456789
(5 rows)

drop table test1;
-- test sysdate
select sysdate - sysdate as mi;
 mi  
-----
 @ 0
(1 row)

-- test int4div
set enable_oracle_compatible = off;
select 1/2 as div;
 div 
-----
   0
(1 row)

select 1/2::int2 as div;
 div 
-----
   0
(1 row)

select 1/2::int8 as div;
 div 
-----
   0
(1 row)

set enable_oracle_compatible = on;
select 1/2 as div;
          div           
------------------------
 0.50000000000000000000
(1 row)

select 1/2::int2 as div;
 div 
-----
   0
(1 row)

select 1/2::int8 as div;
 div 
-----
   0
(1 row)

drop table if exists test;
create table test(tc1 int4, tc2 int4);
insert into test values(1,2);
insert into test values(1,3);
insert into test values(1,4);
insert into test values(2,2);
insert into test values(3,2);
insert into test values(4,2);
insert into test values(5,2);
insert into test values(null, null);
insert into test values(null, 1);
insert into test values(1, null);
\d+ test
                                   Table "public.test"
 Column |  Type   | Collation | Nullable | Default | Storage | Stats target | Description 
--------+---------+-----------+----------+---------+---------+--------------+-------------
 tc1    | integer |           |          |         | plain   |              | 
 tc2    | integer |           |          |         | plain   |              | 
Distribute By: HASH(tc1)
Location Nodes: ALL DATANODES

set enable_oracle_compatible = on;
select tc1 / tc2 as div1,
        tc2 / tc1 as div2,
        (tc1 + tc2) / (tc1) as div3,
        (tc1::int2 + tc2::int2) / (tc1::int2) as div4, 
        tc1::int4 / tc2::int8 as div5,
        tc2::int2 / tc1::int2 as div6
    from test 
    order by div1, div2, div3, div4, div5, div6;
          div1          |          div2          |        div3        | div4 | div5 | div6 
------------------------+------------------------+--------------------+------+------+------
 0.25000000000000000000 |     4.0000000000000000 | 5.0000000000000000 |    5 |    0 |    4
 0.33333333333333333333 |     3.0000000000000000 | 4.0000000000000000 |    4 |    0 |    3
 0.50000000000000000000 |     2.0000000000000000 | 3.0000000000000000 |    3 |    0 |    2
 1.00000000000000000000 | 1.00000000000000000000 | 2.0000000000000000 |    2 |    1 |    1
     1.5000000000000000 | 0.66666666666666666667 | 1.6666666666666667 |    1 |    1 |    0
     2.0000000000000000 | 0.50000000000000000000 | 1.5000000000000000 |    1 |    2 |    0
     2.5000000000000000 | 0.40000000000000000000 | 1.4000000000000000 |    1 |    2 |    0
                        |                        |                    |      |      |     
                        |                        |                    |      |      |     
                        |                        |                    |      |      |     
(10 rows)

set enable_oracle_compatible = off;
select tc1 / tc2 as div1,
        tc2 / tc1 as div2,
        (tc1 + tc2) / (tc1) as div3,
        (tc1::int2 + tc2::int2) / (tc1::int2) as div4, 
        tc1::int4 / tc2::int8 as div5,
        tc2::int2 / tc1::int2 as div6
    from test 
    order by div1, div2, div3, div4, div5, div6;
 div1 | div2 | div3 | div4 | div5 | div6 
------+------+------+------+------+------
    0 |    2 |    3 |    3 |    0 |    2
    0 |    3 |    4 |    4 |    0 |    3
    0 |    4 |    5 |    5 |    0 |    4
    1 |    0 |    1 |    1 |    1 |    0
    1 |    1 |    2 |    2 |    1 |    1
    2 |    0 |    1 |    1 |    2 |    0
    2 |    0 |    1 |    1 |    2 |    0
      |      |      |      |      |     
      |      |      |      |      |     
      |      |      |      |      |     
(10 rows)

drop table test;
-- test Oracle date
set enable_oracle_compatible = off;
drop table if exists test1;
create table test1(tc1 date, tc2 timestamp);
\d+ test1
                                             Table "public.test1"
 Column |            Type             | Collation | Nullable | Default | Storage | Stats target | Description 
--------+-----------------------------+-----------+----------+---------+---------+--------------+-------------
 tc1    | date                        |           |          |         | plain   |              | 
 tc2    | timestamp without time zone |           |          |         | plain   |              | 
Distribute By: HASH(tc1)
Location Nodes: ALL DATANODES

insert into test1 values('2003-08-01 10:12:21.01234', '2003-08-01 10:12:21.09876');
insert into test1 values('2004-08-01 10:12:21.02234', '2004-08-01 10:12:21.09875');
insert into test1 values('2005-08-01 10:12:21.03234', '2005-08-01 10:12:21.09874');
insert into test1 values('2006-08-01 10:12:21.04234', '2006-08-01 10:12:21.09873');
insert into test1 values('2007-08-01 10:12:21.05234', '2007-08-01 10:12:21.09872');
insert into test1 values('2008-08-01 10:12:21.06234', '2008-08-01 10:12:21.09871');
insert into test1 values('2009-08-01 10:12:21.07234', '2009-08-01 10:12:21.09870');
insert into test1 select tc1 + interval '1 year' 
                             + interval '2 month'
                             + interval '3 week'
                             + interval '4 day'
                             + interval '5 hour'
                             + interval '6 minute'
                             + interval '7.09876 second' as tc1,
                         tc2 + interval '1 year'
                             + interval '2 month'
                             + interval '3 week'
                             + interval '4 day'
                             + interval '5 hour'
                             + interval '6 minute' 
                             + interval '7.09876 second' as tc2
                        from test1; 
select tc1, tc2 from test1 order by tc1, tc2;
    tc1     |            tc2            
------------+---------------------------
 2003-08-01 | 2003-08-01 10:12:21.09876
 2004-08-01 | 2004-08-01 10:12:21.09875
 2004-10-26 | 2004-10-26 15:18:28.19752
 2005-08-01 | 2005-08-01 10:12:21.09874
 2005-10-26 | 2005-10-26 15:18:28.19751
 2006-08-01 | 2006-08-01 10:12:21.09873
 2006-10-26 | 2006-10-26 15:18:28.1975
 2007-08-01 | 2007-08-01 10:12:21.09872
 2007-10-26 | 2007-10-26 15:18:28.19749
 2008-08-01 | 2008-08-01 10:12:21.09871
 2008-10-26 | 2008-10-26 15:18:28.19748
 2009-08-01 | 2009-08-01 10:12:21.0987
 2009-10-26 | 2009-10-26 15:18:28.19747
 2010-10-26 | 2010-10-26 15:18:28.19746
(14 rows)

set enable_oracle_compatible = on;
drop table if exists test2;
create table test2(tc1 date, tc2 timestamp);
\d+ test2
                                              Table "public.test2"
 Column |              Type              | Collation | Nullable | Default | Storage | Stats target | Description 
--------+--------------------------------+-----------+----------+---------+---------+--------------+-------------
 tc1    | timestamp(0) without time zone |           |          |         | plain   |              | 
 tc2    | timestamp without time zone    |           |          |         | plain   |              | 
Distribute By: HASH(tc1)
Location Nodes: ALL DATANODES

insert into test2 values('2003-08-01 10:12:21.01234', '2003-08-01 10:12:21.09876');
insert into test2 values('2004-08-01 10:12:21.02234', '2004-08-01 10:12:21.09875');
insert into test2 values('2005-08-01 10:12:21.03234', '2005-08-01 10:12:21.09874');
insert into test2 values('2006-08-01 10:12:21.04234', '2006-08-01 10:12:21.09873');
insert into test2 values('2007-08-01 10:12:21.05234', '2007-08-01 10:12:21.09872');
insert into test2 values('2008-08-01 10:12:21.06234', '2008-08-01 10:12:21.09871');
insert into test2 values('2009-08-01 10:12:21.07234', '2009-08-01 10:12:21.09870');
insert into test2 select tc1 + interval '1 year' 
                             + interval '2 month'
                             + interval '3 week'
                             + interval '4 day'
                             + interval '5 hour'
                             + interval '6 minute'
                             + interval '7.09876 second' as tc1,
                         tc2 + interval '1 year'
                             + interval '2 month'
                             + interval '3 week'
                             + interval '4 day'
                             + interval '5 hour'
                             + interval '6 minute' 
                             + interval '7.09876 second' as tc2
                        from test2; 
select tc1, tc2 from test2 order by tc1, tc2;
         tc1         |            tc2            
---------------------+---------------------------
 2003-08-01 10:12:21 | 2003-08-01 10:12:21.09876
 2004-08-01 10:12:21 | 2004-08-01 10:12:21.09875
 2004-10-26 15:18:28 | 2004-10-26 15:18:28.19752
 2005-08-01 10:12:21 | 2005-08-01 10:12:21.09874
 2005-10-26 15:18:28 | 2005-10-26 15:18:28.19751
 2006-08-01 10:12:21 | 2006-08-01 10:12:21.09873
 2006-10-26 15:18:28 | 2006-10-26 15:18:28.1975
 2007-08-01 10:12:21 | 2007-08-01 10:12:21.09872
 2007-10-26 15:18:28 | 2007-10-26 15:18:28.19749
 2008-08-01 10:12:21 | 2008-08-01 10:12:21.09871
 2008-10-26 15:18:28 | 2008-10-26 15:18:28.19748
 2009-08-01 10:12:21 | 2009-08-01 10:12:21.0987
 2009-10-26 15:18:28 | 2009-10-26 15:18:28.19747
 2010-10-26 15:18:28 | 2010-10-26 15:18:28.19746
(14 rows)

-- test timestamp_pl_day/timestamp_mi_day/timestamp_mi
set enable_oracle_compatible = off;
select tc1 - 1::int2::int4 as t1 from test1 order by t1;
     t1     
------------
 2003-07-31
 2004-07-31
 2004-10-25
 2005-07-31
 2005-10-25
 2006-07-31
 2006-10-25
 2007-07-31
 2007-10-25
 2008-07-31
 2008-10-25
 2009-07-31
 2009-10-25
 2010-10-25
(14 rows)

select tc1 - 2::int4 as t2  from test1 order by t2;
     t2     
------------
 2003-07-30
 2004-07-30
 2004-10-24
 2005-07-30
 2005-10-24
 2006-07-30
 2006-10-24
 2007-07-30
 2007-10-24
 2008-07-30
 2008-10-24
 2009-07-30
 2009-10-24
 2010-10-24
(14 rows)

select tc1 - 3::int8 as t3 from test1 order by t3;
         t3          
---------------------
 2003-07-29 00:00:00
 2004-07-29 00:00:00
 2004-10-23 00:00:00
 2005-07-29 00:00:00
 2005-10-23 00:00:00
 2006-07-29 00:00:00
 2006-10-23 00:00:00
 2007-07-29 00:00:00
 2007-10-23 00:00:00
 2008-07-29 00:00:00
 2008-10-23 00:00:00
 2009-07-29 00:00:00
 2009-10-23 00:00:00
 2010-10-23 00:00:00
(14 rows)

select tc1 - 4::float4::int4 as t4 from test1 order by t4;
     t4     
------------
 2003-07-28
 2004-07-28
 2004-10-22
 2005-07-28
 2005-10-22
 2006-07-28
 2006-10-22
 2007-07-28
 2007-10-22
 2008-07-28
 2008-10-22
 2009-07-28
 2009-10-22
 2010-10-22
(14 rows)

select tc1 - 5::float8::int4 as t5 from test1 order by t5;
     t5     
------------
 2003-07-27
 2004-07-27
 2004-10-21
 2005-07-27
 2005-10-21
 2006-07-27
 2006-10-21
 2007-07-27
 2007-10-21
 2008-07-27
 2008-10-21
 2009-07-27
 2009-10-21
 2010-10-21
(14 rows)

select tc2 - 1::int2 as t6 from test1  order by t6;
            t6             
---------------------------
 2003-07-31 10:12:21.09876
 2004-07-31 10:12:21.09875
 2004-10-25 15:18:28.19752
 2005-07-31 10:12:21.09874
 2005-10-25 15:18:28.19751
 2006-07-31 10:12:21.09873
 2006-10-25 15:18:28.1975
 2007-07-31 10:12:21.09872
 2007-10-25 15:18:28.19749
 2008-07-31 10:12:21.09871
 2008-10-25 15:18:28.19748
 2009-07-31 10:12:21.0987
 2009-10-25 15:18:28.19747
 2010-10-25 15:18:28.19746
(14 rows)

select tc2 - 2::int4 as t7 from test1  order by t7;
            t7             
---------------------------
 2003-07-30 10:12:21.09876
 2004-07-30 10:12:21.09875
 2004-10-24 15:18:28.19752
 2005-07-30 10:12:21.09874
 2005-10-24 15:18:28.19751
 2006-07-30 10:12:21.09873
 2006-10-24 15:18:28.1975
 2007-07-30 10:12:21.09872
 2007-10-24 15:18:28.19749
 2008-07-30 10:12:21.09871
 2008-10-24 15:18:28.19748
 2009-07-30 10:12:21.0987
 2009-10-24 15:18:28.19747
 2010-10-24 15:18:28.19746
(14 rows)

select tc2 - 3::int8 as t8 from test1  order by t8;
            t8             
---------------------------
 2003-07-29 10:12:21.09876
 2004-07-29 10:12:21.09875
 2004-10-23 15:18:28.19752
 2005-07-29 10:12:21.09874
 2005-10-23 15:18:28.19751
 2006-07-29 10:12:21.09873
 2006-10-23 15:18:28.1975
 2007-07-29 10:12:21.09872
 2007-10-23 15:18:28.19749
 2008-07-29 10:12:21.09871
 2008-10-23 15:18:28.19748
 2009-07-29 10:12:21.0987
 2009-10-23 15:18:28.19747
 2010-10-23 15:18:28.19746
(14 rows)

select tc2 - 4::float4::numeric as t9 from test1  order by t9;
            t9             
---------------------------
 2003-07-28 10:12:21.09876
 2004-07-28 10:12:21.09875
 2004-10-22 15:18:28.19752
 2005-07-28 10:12:21.09874
 2005-10-22 15:18:28.19751
 2006-07-28 10:12:21.09873
 2006-10-22 15:18:28.1975
 2007-07-28 10:12:21.09872
 2007-10-22 15:18:28.19749
 2008-07-28 10:12:21.09871
 2008-10-22 15:18:28.19748
 2009-07-28 10:12:21.0987
 2009-10-22 15:18:28.19747
 2010-10-22 15:18:28.19746
(14 rows)

select tc2 - 5::float8::numeric as t10 from test1 order by t10;
            t10            
---------------------------
 2003-07-27 10:12:21.09876
 2004-07-27 10:12:21.09875
 2004-10-21 15:18:28.19752
 2005-07-27 10:12:21.09874
 2005-10-21 15:18:28.19751
 2006-07-27 10:12:21.09873
 2006-10-21 15:18:28.1975
 2007-07-27 10:12:21.09872
 2007-10-21 15:18:28.19749
 2008-07-27 10:12:21.09871
 2008-10-21 15:18:28.19748
 2009-07-27 10:12:21.0987
 2009-10-21 15:18:28.19747
 2010-10-21 15:18:28.19746
(14 rows)

select tc1 - tc2 as t11 from test1  order by t11; -- 
                 t11                  
--------------------------------------
 @ 15 hours 18 mins 28.19752 secs ago
 @ 15 hours 18 mins 28.19751 secs ago
 @ 15 hours 18 mins 28.1975 secs ago
 @ 15 hours 18 mins 28.19749 secs ago
 @ 15 hours 18 mins 28.19748 secs ago
 @ 15 hours 18 mins 28.19747 secs ago
 @ 15 hours 18 mins 28.19746 secs ago
 @ 10 hours 12 mins 21.09876 secs ago
 @ 10 hours 12 mins 21.09875 secs ago
 @ 10 hours 12 mins 21.09874 secs ago
 @ 10 hours 12 mins 21.09873 secs ago
 @ 10 hours 12 mins 21.09872 secs ago
 @ 10 hours 12 mins 21.09871 secs ago
 @ 10 hours 12 mins 21.0987 secs ago
(14 rows)

select tc2 - tc1 as t12 from test1  order by t12; --
               t12                
----------------------------------
 @ 10 hours 12 mins 21.0987 secs
 @ 10 hours 12 mins 21.09871 secs
 @ 10 hours 12 mins 21.09872 secs
 @ 10 hours 12 mins 21.09873 secs
 @ 10 hours 12 mins 21.09874 secs
 @ 10 hours 12 mins 21.09875 secs
 @ 10 hours 12 mins 21.09876 secs
 @ 15 hours 18 mins 28.19746 secs
 @ 15 hours 18 mins 28.19747 secs
 @ 15 hours 18 mins 28.19748 secs
 @ 15 hours 18 mins 28.19749 secs
 @ 15 hours 18 mins 28.1975 secs
 @ 15 hours 18 mins 28.19751 secs
 @ 15 hours 18 mins 28.19752 secs
(14 rows)

select tc1 - tc1 as t13 from test1  order by t13;
 t13 
-----
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
(14 rows)

select tc2 - tc2 as t14  from test1  order by t14;
 t14 
-----
 @ 0
 @ 0
 @ 0
 @ 0
 @ 0
 @ 0
 @ 0
 @ 0
 @ 0
 @ 0
 @ 0
 @ 0
 @ 0
 @ 0
(14 rows)

select tc1 - 1::int2::int4 as t1,
       tc1 - 2::int4 as t2,  
       tc1 - 3::int8 as t3, 
       tc1 - 4::float4::int4 as t4, 
       tc1 - 5::float8::int4 as t5,
       tc2 - 1::int2 as t6,
       tc2 - 2::int4 as t7, 
       tc2 - 3::int8 as t8, 
       tc2 - 4::float4::numeric as t9,
       tc2 - 5::float8::numeric as t10,
       tc1 - tc2 as t11,
       tc2 - tc1 as t12,
       tc1 - tc1 as t13,
       tc2 - tc2 as t14
    from test1 
    order by t1, t2, t3, t4, t5, t6, t7, t8, t9, t10, t11, t12, t13, t14;
     t1     |     t2     |         t3          |     t4     |     t5     |            t6             |            t7             |            t8             |            t9             |            t10            |                 t11                  |               t12                | t13 | t14 
------------+------------+---------------------+------------+------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+--------------------------------------+----------------------------------+-----+-----
 2003-07-31 | 2003-07-30 | 2003-07-29 00:00:00 | 2003-07-28 | 2003-07-27 | 2003-07-31 10:12:21.09876 | 2003-07-30 10:12:21.09876 | 2003-07-29 10:12:21.09876 | 2003-07-28 10:12:21.09876 | 2003-07-27 10:12:21.09876 | @ 10 hours 12 mins 21.09876 secs ago | @ 10 hours 12 mins 21.09876 secs |   0 | @ 0
 2004-07-31 | 2004-07-30 | 2004-07-29 00:00:00 | 2004-07-28 | 2004-07-27 | 2004-07-31 10:12:21.09875 | 2004-07-30 10:12:21.09875 | 2004-07-29 10:12:21.09875 | 2004-07-28 10:12:21.09875 | 2004-07-27 10:12:21.09875 | @ 10 hours 12 mins 21.09875 secs ago | @ 10 hours 12 mins 21.09875 secs |   0 | @ 0
 2004-10-25 | 2004-10-24 | 2004-10-23 00:00:00 | 2004-10-22 | 2004-10-21 | 2004-10-25 15:18:28.19752 | 2004-10-24 15:18:28.19752 | 2004-10-23 15:18:28.19752 | 2004-10-22 15:18:28.19752 | 2004-10-21 15:18:28.19752 | @ 15 hours 18 mins 28.19752 secs ago | @ 15 hours 18 mins 28.19752 secs |   0 | @ 0
 2005-07-31 | 2005-07-30 | 2005-07-29 00:00:00 | 2005-07-28 | 2005-07-27 | 2005-07-31 10:12:21.09874 | 2005-07-30 10:12:21.09874 | 2005-07-29 10:12:21.09874 | 2005-07-28 10:12:21.09874 | 2005-07-27 10:12:21.09874 | @ 10 hours 12 mins 21.09874 secs ago | @ 10 hours 12 mins 21.09874 secs |   0 | @ 0
 2005-10-25 | 2005-10-24 | 2005-10-23 00:00:00 | 2005-10-22 | 2005-10-21 | 2005-10-25 15:18:28.19751 | 2005-10-24 15:18:28.19751 | 2005-10-23 15:18:28.19751 | 2005-10-22 15:18:28.19751 | 2005-10-21 15:18:28.19751 | @ 15 hours 18 mins 28.19751 secs ago | @ 15 hours 18 mins 28.19751 secs |   0 | @ 0
 2006-07-31 | 2006-07-30 | 2006-07-29 00:00:00 | 2006-07-28 | 2006-07-27 | 2006-07-31 10:12:21.09873 | 2006-07-30 10:12:21.09873 | 2006-07-29 10:12:21.09873 | 2006-07-28 10:12:21.09873 | 2006-07-27 10:12:21.09873 | @ 10 hours 12 mins 21.09873 secs ago | @ 10 hours 12 mins 21.09873 secs |   0 | @ 0
 2006-10-25 | 2006-10-24 | 2006-10-23 00:00:00 | 2006-10-22 | 2006-10-21 | 2006-10-25 15:18:28.1975  | 2006-10-24 15:18:28.1975  | 2006-10-23 15:18:28.1975  | 2006-10-22 15:18:28.1975  | 2006-10-21 15:18:28.1975  | @ 15 hours 18 mins 28.1975 secs ago  | @ 15 hours 18 mins 28.1975 secs  |   0 | @ 0
 2007-07-31 | 2007-07-30 | 2007-07-29 00:00:00 | 2007-07-28 | 2007-07-27 | 2007-07-31 10:12:21.09872 | 2007-07-30 10:12:21.09872 | 2007-07-29 10:12:21.09872 | 2007-07-28 10:12:21.09872 | 2007-07-27 10:12:21.09872 | @ 10 hours 12 mins 21.09872 secs ago | @ 10 hours 12 mins 21.09872 secs |   0 | @ 0
 2007-10-25 | 2007-10-24 | 2007-10-23 00:00:00 | 2007-10-22 | 2007-10-21 | 2007-10-25 15:18:28.19749 | 2007-10-24 15:18:28.19749 | 2007-10-23 15:18:28.19749 | 2007-10-22 15:18:28.19749 | 2007-10-21 15:18:28.19749 | @ 15 hours 18 mins 28.19749 secs ago | @ 15 hours 18 mins 28.19749 secs |   0 | @ 0
 2008-07-31 | 2008-07-30 | 2008-07-29 00:00:00 | 2008-07-28 | 2008-07-27 | 2008-07-31 10:12:21.09871 | 2008-07-30 10:12:21.09871 | 2008-07-29 10:12:21.09871 | 2008-07-28 10:12:21.09871 | 2008-07-27 10:12:21.09871 | @ 10 hours 12 mins 21.09871 secs ago | @ 10 hours 12 mins 21.09871 secs |   0 | @ 0
 2008-10-25 | 2008-10-24 | 2008-10-23 00:00:00 | 2008-10-22 | 2008-10-21 | 2008-10-25 15:18:28.19748 | 2008-10-24 15:18:28.19748 | 2008-10-23 15:18:28.19748 | 2008-10-22 15:18:28.19748 | 2008-10-21 15:18:28.19748 | @ 15 hours 18 mins 28.19748 secs ago | @ 15 hours 18 mins 28.19748 secs |   0 | @ 0
 2009-07-31 | 2009-07-30 | 2009-07-29 00:00:00 | 2009-07-28 | 2009-07-27 | 2009-07-31 10:12:21.0987  | 2009-07-30 10:12:21.0987  | 2009-07-29 10:12:21.0987  | 2009-07-28 10:12:21.0987  | 2009-07-27 10:12:21.0987  | @ 10 hours 12 mins 21.0987 secs ago  | @ 10 hours 12 mins 21.0987 secs  |   0 | @ 0
 2009-10-25 | 2009-10-24 | 2009-10-23 00:00:00 | 2009-10-22 | 2009-10-21 | 2009-10-25 15:18:28.19747 | 2009-10-24 15:18:28.19747 | 2009-10-23 15:18:28.19747 | 2009-10-22 15:18:28.19747 | 2009-10-21 15:18:28.19747 | @ 15 hours 18 mins 28.19747 secs ago | @ 15 hours 18 mins 28.19747 secs |   0 | @ 0
 2010-10-25 | 2010-10-24 | 2010-10-23 00:00:00 | 2010-10-22 | 2010-10-21 | 2010-10-25 15:18:28.19746 | 2010-10-24 15:18:28.19746 | 2010-10-23 15:18:28.19746 | 2010-10-22 15:18:28.19746 | 2010-10-21 15:18:28.19746 | @ 15 hours 18 mins 28.19746 secs ago | @ 15 hours 18 mins 28.19746 secs |   0 | @ 0
(14 rows)

select tc1 + 1::int2::int4 as t1,
       tc1 + 2::int4 as t2,  
       tc1 + 3::int8 as t3, 
       tc1 + 4::float4::int4 as t4, 
       tc1 + 5::float8::int4 as t5,
       tc2 + 1::int2 as t6,
       tc2 + 2::int4 as t7, 
       tc2 + 3::int8 as t8, 
       tc2 + 4::float4::numeric as t9,
       tc2 + 5::float8::numeric as t10
    from test1 
    order by t1, t2, t3, t4, t5, t6, t7, t8, t9, t10;
     t1     |     t2     |         t3          |     t4     |     t5     |            t6             |            t7             |            t8             |            t9             |            t10            
------------+------------+---------------------+------------+------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------
 2003-08-02 | 2003-08-03 | 2003-08-04 00:00:00 | 2003-08-05 | 2003-08-06 | 2003-08-02 10:12:21.09876 | 2003-08-03 10:12:21.09876 | 2003-08-04 10:12:21.09876 | 2003-08-05 10:12:21.09876 | 2003-08-06 10:12:21.09876
 2004-08-02 | 2004-08-03 | 2004-08-04 00:00:00 | 2004-08-05 | 2004-08-06 | 2004-08-02 10:12:21.09875 | 2004-08-03 10:12:21.09875 | 2004-08-04 10:12:21.09875 | 2004-08-05 10:12:21.09875 | 2004-08-06 10:12:21.09875
 2004-10-27 | 2004-10-28 | 2004-10-29 00:00:00 | 2004-10-30 | 2004-10-31 | 2004-10-27 15:18:28.19752 | 2004-10-28 15:18:28.19752 | 2004-10-29 15:18:28.19752 | 2004-10-30 15:18:28.19752 | 2004-10-31 15:18:28.19752
 2005-08-02 | 2005-08-03 | 2005-08-04 00:00:00 | 2005-08-05 | 2005-08-06 | 2005-08-02 10:12:21.09874 | 2005-08-03 10:12:21.09874 | 2005-08-04 10:12:21.09874 | 2005-08-05 10:12:21.09874 | 2005-08-06 10:12:21.09874
 2005-10-27 | 2005-10-28 | 2005-10-29 00:00:00 | 2005-10-30 | 2005-10-31 | 2005-10-27 15:18:28.19751 | 2005-10-28 15:18:28.19751 | 2005-10-29 15:18:28.19751 | 2005-10-30 15:18:28.19751 | 2005-10-31 15:18:28.19751
 2006-08-02 | 2006-08-03 | 2006-08-04 00:00:00 | 2006-08-05 | 2006-08-06 | 2006-08-02 10:12:21.09873 | 2006-08-03 10:12:21.09873 | 2006-08-04 10:12:21.09873 | 2006-08-05 10:12:21.09873 | 2006-08-06 10:12:21.09873
 2006-10-27 | 2006-10-28 | 2006-10-29 00:00:00 | 2006-10-30 | 2006-10-31 | 2006-10-27 15:18:28.1975  | 2006-10-28 15:18:28.1975  | 2006-10-29 15:18:28.1975  | 2006-10-30 15:18:28.1975  | 2006-10-31 15:18:28.1975
 2007-08-02 | 2007-08-03 | 2007-08-04 00:00:00 | 2007-08-05 | 2007-08-06 | 2007-08-02 10:12:21.09872 | 2007-08-03 10:12:21.09872 | 2007-08-04 10:12:21.09872 | 2007-08-05 10:12:21.09872 | 2007-08-06 10:12:21.09872
 2007-10-27 | 2007-10-28 | 2007-10-29 00:00:00 | 2007-10-30 | 2007-10-31 | 2007-10-27 15:18:28.19749 | 2007-10-28 15:18:28.19749 | 2007-10-29 15:18:28.19749 | 2007-10-30 15:18:28.19749 | 2007-10-31 15:18:28.19749
 2008-08-02 | 2008-08-03 | 2008-08-04 00:00:00 | 2008-08-05 | 2008-08-06 | 2008-08-02 10:12:21.09871 | 2008-08-03 10:12:21.09871 | 2008-08-04 10:12:21.09871 | 2008-08-05 10:12:21.09871 | 2008-08-06 10:12:21.09871
 2008-10-27 | 2008-10-28 | 2008-10-29 00:00:00 | 2008-10-30 | 2008-10-31 | 2008-10-27 15:18:28.19748 | 2008-10-28 15:18:28.19748 | 2008-10-29 15:18:28.19748 | 2008-10-30 15:18:28.19748 | 2008-10-31 15:18:28.19748
 2009-08-02 | 2009-08-03 | 2009-08-04 00:00:00 | 2009-08-05 | 2009-08-06 | 2009-08-02 10:12:21.0987  | 2009-08-03 10:12:21.0987  | 2009-08-04 10:12:21.0987  | 2009-08-05 10:12:21.0987  | 2009-08-06 10:12:21.0987
 2009-10-27 | 2009-10-28 | 2009-10-29 00:00:00 | 2009-10-30 | 2009-10-31 | 2009-10-27 15:18:28.19747 | 2009-10-28 15:18:28.19747 | 2009-10-29 15:18:28.19747 | 2009-10-30 15:18:28.19747 | 2009-10-31 15:18:28.19747
 2010-10-27 | 2010-10-28 | 2010-10-29 00:00:00 | 2010-10-30 | 2010-10-31 | 2010-10-27 15:18:28.19746 | 2010-10-28 15:18:28.19746 | 2010-10-29 15:18:28.19746 | 2010-10-30 15:18:28.19746 | 2010-10-31 15:18:28.19746
(14 rows)

    
select tc1 - 1::int2::int4 as t1,
       tc1 - 2::int4 as t2,  
       tc1 - 3::int8 as t3, 
       tc1 - 4::float4::int4 as t4, 
       tc1 - 5::float8::int4 as t5,
       tc2 - 1::int2 as t6,
       tc2 - 2::int4 as t7, 
       tc2 - 3::int8 as t8, 
       tc2 - 4::float4::numeric as t9,
       tc2 - 5::float8::numeric as t10,
       tc1 - tc2 as t11,
       tc2 - tc1 as t12,
       tc1 - tc1 as t13,
       tc2 - tc2 as t14
    from test2 
    order by t1, t2, t3, t4, t5, t6, t7, t8, t9, t10, t11, t12, t13, t14;
         t1          |         t2          |         t3          |         t4          |         t5          |            t6             |            t7             |            t8             |            t9             |            t10            |        t11         |      t12       | t13 | t14 
---------------------+---------------------+---------------------+---------------------+---------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+--------------------+----------------+-----+-----
 2003-07-31 10:12:21 | 2003-07-30 10:12:21 | 2003-07-29 10:12:21 | 2003-07-28 10:12:21 | 2003-07-27 10:12:21 | 2003-07-31 10:12:21.09876 | 2003-07-30 10:12:21.09876 | 2003-07-29 10:12:21.09876 | 2003-07-28 10:12:21.09876 | 2003-07-27 10:12:21.09876 | @ 0.09876 secs ago | @ 0.09876 secs | @ 0 | @ 0
 2004-07-31 10:12:21 | 2004-07-30 10:12:21 | 2004-07-29 10:12:21 | 2004-07-28 10:12:21 | 2004-07-27 10:12:21 | 2004-07-31 10:12:21.09875 | 2004-07-30 10:12:21.09875 | 2004-07-29 10:12:21.09875 | 2004-07-28 10:12:21.09875 | 2004-07-27 10:12:21.09875 | @ 0.09875 secs ago | @ 0.09875 secs | @ 0 | @ 0
 2004-10-25 15:18:28 | 2004-10-24 15:18:28 | 2004-10-23 15:18:28 | 2004-10-22 15:18:28 | 2004-10-21 15:18:28 | 2004-10-25 15:18:28.19752 | 2004-10-24 15:18:28.19752 | 2004-10-23 15:18:28.19752 | 2004-10-22 15:18:28.19752 | 2004-10-21 15:18:28.19752 | @ 0.19752 secs ago | @ 0.19752 secs | @ 0 | @ 0
 2005-07-31 10:12:21 | 2005-07-30 10:12:21 | 2005-07-29 10:12:21 | 2005-07-28 10:12:21 | 2005-07-27 10:12:21 | 2005-07-31 10:12:21.09874 | 2005-07-30 10:12:21.09874 | 2005-07-29 10:12:21.09874 | 2005-07-28 10:12:21.09874 | 2005-07-27 10:12:21.09874 | @ 0.09874 secs ago | @ 0.09874 secs | @ 0 | @ 0
 2005-10-25 15:18:28 | 2005-10-24 15:18:28 | 2005-10-23 15:18:28 | 2005-10-22 15:18:28 | 2005-10-21 15:18:28 | 2005-10-25 15:18:28.19751 | 2005-10-24 15:18:28.19751 | 2005-10-23 15:18:28.19751 | 2005-10-22 15:18:28.19751 | 2005-10-21 15:18:28.19751 | @ 0.19751 secs ago | @ 0.19751 secs | @ 0 | @ 0
 2006-07-31 10:12:21 | 2006-07-30 10:12:21 | 2006-07-29 10:12:21 | 2006-07-28 10:12:21 | 2006-07-27 10:12:21 | 2006-07-31 10:12:21.09873 | 2006-07-30 10:12:21.09873 | 2006-07-29 10:12:21.09873 | 2006-07-28 10:12:21.09873 | 2006-07-27 10:12:21.09873 | @ 0.09873 secs ago | @ 0.09873 secs | @ 0 | @ 0
 2006-10-25 15:18:28 | 2006-10-24 15:18:28 | 2006-10-23 15:18:28 | 2006-10-22 15:18:28 | 2006-10-21 15:18:28 | 2006-10-25 15:18:28.1975  | 2006-10-24 15:18:28.1975  | 2006-10-23 15:18:28.1975  | 2006-10-22 15:18:28.1975  | 2006-10-21 15:18:28.1975  | @ 0.1975 secs ago  | @ 0.1975 secs  | @ 0 | @ 0
 2007-07-31 10:12:21 | 2007-07-30 10:12:21 | 2007-07-29 10:12:21 | 2007-07-28 10:12:21 | 2007-07-27 10:12:21 | 2007-07-31 10:12:21.09872 | 2007-07-30 10:12:21.09872 | 2007-07-29 10:12:21.09872 | 2007-07-28 10:12:21.09872 | 2007-07-27 10:12:21.09872 | @ 0.09872 secs ago | @ 0.09872 secs | @ 0 | @ 0
 2007-10-25 15:18:28 | 2007-10-24 15:18:28 | 2007-10-23 15:18:28 | 2007-10-22 15:18:28 | 2007-10-21 15:18:28 | 2007-10-25 15:18:28.19749 | 2007-10-24 15:18:28.19749 | 2007-10-23 15:18:28.19749 | 2007-10-22 15:18:28.19749 | 2007-10-21 15:18:28.19749 | @ 0.19749 secs ago | @ 0.19749 secs | @ 0 | @ 0
 2008-07-31 10:12:21 | 2008-07-30 10:12:21 | 2008-07-29 10:12:21 | 2008-07-28 10:12:21 | 2008-07-27 10:12:21 | 2008-07-31 10:12:21.09871 | 2008-07-30 10:12:21.09871 | 2008-07-29 10:12:21.09871 | 2008-07-28 10:12:21.09871 | 2008-07-27 10:12:21.09871 | @ 0.09871 secs ago | @ 0.09871 secs | @ 0 | @ 0
 2008-10-25 15:18:28 | 2008-10-24 15:18:28 | 2008-10-23 15:18:28 | 2008-10-22 15:18:28 | 2008-10-21 15:18:28 | 2008-10-25 15:18:28.19748 | 2008-10-24 15:18:28.19748 | 2008-10-23 15:18:28.19748 | 2008-10-22 15:18:28.19748 | 2008-10-21 15:18:28.19748 | @ 0.19748 secs ago | @ 0.19748 secs | @ 0 | @ 0
 2009-07-31 10:12:21 | 2009-07-30 10:12:21 | 2009-07-29 10:12:21 | 2009-07-28 10:12:21 | 2009-07-27 10:12:21 | 2009-07-31 10:12:21.0987  | 2009-07-30 10:12:21.0987  | 2009-07-29 10:12:21.0987  | 2009-07-28 10:12:21.0987  | 2009-07-27 10:12:21.0987  | @ 0.0987 secs ago  | @ 0.0987 secs  | @ 0 | @ 0
 2009-10-25 15:18:28 | 2009-10-24 15:18:28 | 2009-10-23 15:18:28 | 2009-10-22 15:18:28 | 2009-10-21 15:18:28 | 2009-10-25 15:18:28.19747 | 2009-10-24 15:18:28.19747 | 2009-10-23 15:18:28.19747 | 2009-10-22 15:18:28.19747 | 2009-10-21 15:18:28.19747 | @ 0.19747 secs ago | @ 0.19747 secs | @ 0 | @ 0
 2010-10-25 15:18:28 | 2010-10-24 15:18:28 | 2010-10-23 15:18:28 | 2010-10-22 15:18:28 | 2010-10-21 15:18:28 | 2010-10-25 15:18:28.19746 | 2010-10-24 15:18:28.19746 | 2010-10-23 15:18:28.19746 | 2010-10-22 15:18:28.19746 | 2010-10-21 15:18:28.19746 | @ 0.19746 secs ago | @ 0.19746 secs | @ 0 | @ 0
(14 rows)

select tc1 + 1::int2::int4 as t1,
       tc1 + 2::int4 as t2,  
       tc1 + 3::int8 as t3, 
       tc1 + 4::float4::int4 as t4, 
       tc1 + 5::float8::int4 as t5,
       tc2 + 1::int2 as t6,
       tc2 + 2::int4 as t7, 
       tc2 + 3::int8 as t8, 
       tc2 + 4::float4::numeric as t9,
       tc2 + 5::float8::numeric as t10
    from test2 
    order by t1, t2, t3, t4, t5, t6, t7, t8, t9, t10;
         t1          |         t2          |         t3          |         t4          |         t5          |            t6             |            t7             |            t8             |            t9             |            t10            
---------------------+---------------------+---------------------+---------------------+---------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------
 2003-08-02 10:12:21 | 2003-08-03 10:12:21 | 2003-08-04 10:12:21 | 2003-08-05 10:12:21 | 2003-08-06 10:12:21 | 2003-08-02 10:12:21.09876 | 2003-08-03 10:12:21.09876 | 2003-08-04 10:12:21.09876 | 2003-08-05 10:12:21.09876 | 2003-08-06 10:12:21.09876
 2004-08-02 10:12:21 | 2004-08-03 10:12:21 | 2004-08-04 10:12:21 | 2004-08-05 10:12:21 | 2004-08-06 10:12:21 | 2004-08-02 10:12:21.09875 | 2004-08-03 10:12:21.09875 | 2004-08-04 10:12:21.09875 | 2004-08-05 10:12:21.09875 | 2004-08-06 10:12:21.09875
 2004-10-27 15:18:28 | 2004-10-28 15:18:28 | 2004-10-29 15:18:28 | 2004-10-30 15:18:28 | 2004-10-31 15:18:28 | 2004-10-27 15:18:28.19752 | 2004-10-28 15:18:28.19752 | 2004-10-29 15:18:28.19752 | 2004-10-30 15:18:28.19752 | 2004-10-31 15:18:28.19752
 2005-08-02 10:12:21 | 2005-08-03 10:12:21 | 2005-08-04 10:12:21 | 2005-08-05 10:12:21 | 2005-08-06 10:12:21 | 2005-08-02 10:12:21.09874 | 2005-08-03 10:12:21.09874 | 2005-08-04 10:12:21.09874 | 2005-08-05 10:12:21.09874 | 2005-08-06 10:12:21.09874
 2005-10-27 15:18:28 | 2005-10-28 15:18:28 | 2005-10-29 15:18:28 | 2005-10-30 15:18:28 | 2005-10-31 15:18:28 | 2005-10-27 15:18:28.19751 | 2005-10-28 15:18:28.19751 | 2005-10-29 15:18:28.19751 | 2005-10-30 15:18:28.19751 | 2005-10-31 15:18:28.19751
 2006-08-02 10:12:21 | 2006-08-03 10:12:21 | 2006-08-04 10:12:21 | 2006-08-05 10:12:21 | 2006-08-06 10:12:21 | 2006-08-02 10:12:21.09873 | 2006-08-03 10:12:21.09873 | 2006-08-04 10:12:21.09873 | 2006-08-05 10:12:21.09873 | 2006-08-06 10:12:21.09873
 2006-10-27 15:18:28 | 2006-10-28 15:18:28 | 2006-10-29 15:18:28 | 2006-10-30 15:18:28 | 2006-10-31 15:18:28 | 2006-10-27 15:18:28.1975  | 2006-10-28 15:18:28.1975  | 2006-10-29 15:18:28.1975  | 2006-10-30 15:18:28.1975  | 2006-10-31 15:18:28.1975
 2007-08-02 10:12:21 | 2007-08-03 10:12:21 | 2007-08-04 10:12:21 | 2007-08-05 10:12:21 | 2007-08-06 10:12:21 | 2007-08-02 10:12:21.09872 | 2007-08-03 10:12:21.09872 | 2007-08-04 10:12:21.09872 | 2007-08-05 10:12:21.09872 | 2007-08-06 10:12:21.09872
 2007-10-27 15:18:28 | 2007-10-28 15:18:28 | 2007-10-29 15:18:28 | 2007-10-30 15:18:28 | 2007-10-31 15:18:28 | 2007-10-27 15:18:28.19749 | 2007-10-28 15:18:28.19749 | 2007-10-29 15:18:28.19749 | 2007-10-30 15:18:28.19749 | 2007-10-31 15:18:28.19749
 2008-08-02 10:12:21 | 2008-08-03 10:12:21 | 2008-08-04 10:12:21 | 2008-08-05 10:12:21 | 2008-08-06 10:12:21 | 2008-08-02 10:12:21.09871 | 2008-08-03 10:12:21.09871 | 2008-08-04 10:12:21.09871 | 2008-08-05 10:12:21.09871 | 2008-08-06 10:12:21.09871
 2008-10-27 15:18:28 | 2008-10-28 15:18:28 | 2008-10-29 15:18:28 | 2008-10-30 15:18:28 | 2008-10-31 15:18:28 | 2008-10-27 15:18:28.19748 | 2008-10-28 15:18:28.19748 | 2008-10-29 15:18:28.19748 | 2008-10-30 15:18:28.19748 | 2008-10-31 15:18:28.19748
 2009-08-02 10:12:21 | 2009-08-03 10:12:21 | 2009-08-04 10:12:21 | 2009-08-05 10:12:21 | 2009-08-06 10:12:21 | 2009-08-02 10:12:21.0987  | 2009-08-03 10:12:21.0987  | 2009-08-04 10:12:21.0987  | 2009-08-05 10:12:21.0987  | 2009-08-06 10:12:21.0987
 2009-10-27 15:18:28 | 2009-10-28 15:18:28 | 2009-10-29 15:18:28 | 2009-10-30 15:18:28 | 2009-10-31 15:18:28 | 2009-10-27 15:18:28.19747 | 2009-10-28 15:18:28.19747 | 2009-10-29 15:18:28.19747 | 2009-10-30 15:18:28.19747 | 2009-10-31 15:18:28.19747
 2010-10-27 15:18:28 | 2010-10-28 15:18:28 | 2010-10-29 15:18:28 | 2010-10-30 15:18:28 | 2010-10-31 15:18:28 | 2010-10-27 15:18:28.19746 | 2010-10-28 15:18:28.19746 | 2010-10-29 15:18:28.19746 | 2010-10-30 15:18:28.19746 | 2010-10-31 15:18:28.19746
(14 rows)

    
select tc1 - tc2 as t1, tc2 - tc1 as t2 from test1 order by t1, t2;
                  t1                  |                t2                
--------------------------------------+----------------------------------
 @ 15 hours 18 mins 28.19752 secs ago | @ 15 hours 18 mins 28.19752 secs
 @ 15 hours 18 mins 28.19751 secs ago | @ 15 hours 18 mins 28.19751 secs
 @ 15 hours 18 mins 28.1975 secs ago  | @ 15 hours 18 mins 28.1975 secs
 @ 15 hours 18 mins 28.19749 secs ago | @ 15 hours 18 mins 28.19749 secs
 @ 15 hours 18 mins 28.19748 secs ago | @ 15 hours 18 mins 28.19748 secs
 @ 15 hours 18 mins 28.19747 secs ago | @ 15 hours 18 mins 28.19747 secs
 @ 15 hours 18 mins 28.19746 secs ago | @ 15 hours 18 mins 28.19746 secs
 @ 10 hours 12 mins 21.09876 secs ago | @ 10 hours 12 mins 21.09876 secs
 @ 10 hours 12 mins 21.09875 secs ago | @ 10 hours 12 mins 21.09875 secs
 @ 10 hours 12 mins 21.09874 secs ago | @ 10 hours 12 mins 21.09874 secs
 @ 10 hours 12 mins 21.09873 secs ago | @ 10 hours 12 mins 21.09873 secs
 @ 10 hours 12 mins 21.09872 secs ago | @ 10 hours 12 mins 21.09872 secs
 @ 10 hours 12 mins 21.09871 secs ago | @ 10 hours 12 mins 21.09871 secs
 @ 10 hours 12 mins 21.0987 secs ago  | @ 10 hours 12 mins 21.0987 secs
(14 rows)

select tc1 - tc2 as t1, tc2 - tc1 as t2 from test2 order by t1, t2;
         t1         |       t2       
--------------------+----------------
 @ 0.19752 secs ago | @ 0.19752 secs
 @ 0.19751 secs ago | @ 0.19751 secs
 @ 0.1975 secs ago  | @ 0.1975 secs
 @ 0.19749 secs ago | @ 0.19749 secs
 @ 0.19748 secs ago | @ 0.19748 secs
 @ 0.19747 secs ago | @ 0.19747 secs
 @ 0.19746 secs ago | @ 0.19746 secs
 @ 0.09876 secs ago | @ 0.09876 secs
 @ 0.09875 secs ago | @ 0.09875 secs
 @ 0.09874 secs ago | @ 0.09874 secs
 @ 0.09873 secs ago | @ 0.09873 secs
 @ 0.09872 secs ago | @ 0.09872 secs
 @ 0.09871 secs ago | @ 0.09871 secs
 @ 0.0987 secs ago  | @ 0.0987 secs
(14 rows)

select tc1, tc1 + 1/24/3600  t1 from test1 order by tc1, t1;
    tc1     |     t1     
------------+------------
 2003-08-01 | 2003-08-01
 2004-08-01 | 2004-08-01
 2004-10-26 | 2004-10-26
 2005-08-01 | 2005-08-01
 2005-10-26 | 2005-10-26
 2006-08-01 | 2006-08-01
 2006-10-26 | 2006-10-26
 2007-08-01 | 2007-08-01
 2007-10-26 | 2007-10-26
 2008-08-01 | 2008-08-01
 2008-10-26 | 2008-10-26
 2009-08-01 | 2009-08-01
 2009-10-26 | 2009-10-26
 2010-10-26 | 2010-10-26
(14 rows)

select tc1, tc1 + 1/24/3600  t1 from test2 order by tc1, t1;
         tc1         |         t1          
---------------------+---------------------
 2003-08-01 10:12:21 | 2003-08-01 10:12:21
 2004-08-01 10:12:21 | 2004-08-01 10:12:21
 2004-10-26 15:18:28 | 2004-10-26 15:18:28
 2005-08-01 10:12:21 | 2005-08-01 10:12:21
 2005-10-26 15:18:28 | 2005-10-26 15:18:28
 2006-08-01 10:12:21 | 2006-08-01 10:12:21
 2006-10-26 15:18:28 | 2006-10-26 15:18:28
 2007-08-01 10:12:21 | 2007-08-01 10:12:21
 2007-10-26 15:18:28 | 2007-10-26 15:18:28
 2008-08-01 10:12:21 | 2008-08-01 10:12:21
 2008-10-26 15:18:28 | 2008-10-26 15:18:28
 2009-08-01 10:12:21 | 2009-08-01 10:12:21
 2009-10-26 15:18:28 | 2009-10-26 15:18:28
 2010-10-26 15:18:28 | 2010-10-26 15:18:28
(14 rows)

select tc1, tc1 - 1/24/3600  t1 from test1 order by tc1, t1;
    tc1     |     t1     
------------+------------
 2003-08-01 | 2003-08-01
 2004-08-01 | 2004-08-01
 2004-10-26 | 2004-10-26
 2005-08-01 | 2005-08-01
 2005-10-26 | 2005-10-26
 2006-08-01 | 2006-08-01
 2006-10-26 | 2006-10-26
 2007-08-01 | 2007-08-01
 2007-10-26 | 2007-10-26
 2008-08-01 | 2008-08-01
 2008-10-26 | 2008-10-26
 2009-08-01 | 2009-08-01
 2009-10-26 | 2009-10-26
 2010-10-26 | 2010-10-26
(14 rows)

select tc1, tc1 - 1/24/3600  t1 from test2 order by tc1, t1;
         tc1         |         t1          
---------------------+---------------------
 2003-08-01 10:12:21 | 2003-08-01 10:12:21
 2004-08-01 10:12:21 | 2004-08-01 10:12:21
 2004-10-26 15:18:28 | 2004-10-26 15:18:28
 2005-08-01 10:12:21 | 2005-08-01 10:12:21
 2005-10-26 15:18:28 | 2005-10-26 15:18:28
 2006-08-01 10:12:21 | 2006-08-01 10:12:21
 2006-10-26 15:18:28 | 2006-10-26 15:18:28
 2007-08-01 10:12:21 | 2007-08-01 10:12:21
 2007-10-26 15:18:28 | 2007-10-26 15:18:28
 2008-08-01 10:12:21 | 2008-08-01 10:12:21
 2008-10-26 15:18:28 | 2008-10-26 15:18:28
 2009-08-01 10:12:21 | 2009-08-01 10:12:21
 2009-10-26 15:18:28 | 2009-10-26 15:18:28
 2010-10-26 15:18:28 | 2010-10-26 15:18:28
(14 rows)

set enable_oracle_compatible = on;
select tc1 - 1::int2::int4 as t1 from test1 order by t1;
     t1     
------------
 2003-07-31
 2004-07-31
 2004-10-25
 2005-07-31
 2005-10-25
 2006-07-31
 2006-10-25
 2007-07-31
 2007-10-25
 2008-07-31
 2008-10-25
 2009-07-31
 2009-10-25
 2010-10-25
(14 rows)

select tc1 - 2::int4 as t2  from test1 order by t2;
     t2     
------------
 2003-07-30
 2004-07-30
 2004-10-24
 2005-07-30
 2005-10-24
 2006-07-30
 2006-10-24
 2007-07-30
 2007-10-24
 2008-07-30
 2008-10-24
 2009-07-30
 2009-10-24
 2010-10-24
(14 rows)

select tc1 - 3::int8 as t3 from test1 order by t3;
         t3          
---------------------
 2003-07-29 00:00:00
 2004-07-29 00:00:00
 2004-10-23 00:00:00
 2005-07-29 00:00:00
 2005-10-23 00:00:00
 2006-07-29 00:00:00
 2006-10-23 00:00:00
 2007-07-29 00:00:00
 2007-10-23 00:00:00
 2008-07-29 00:00:00
 2008-10-23 00:00:00
 2009-07-29 00:00:00
 2009-10-23 00:00:00
 2010-10-23 00:00:00
(14 rows)

select tc1 - 4::float4::int4 as t4 from test1 order by t4;
     t4     
------------
 2003-07-28
 2004-07-28
 2004-10-22
 2005-07-28
 2005-10-22
 2006-07-28
 2006-10-22
 2007-07-28
 2007-10-22
 2008-07-28
 2008-10-22
 2009-07-28
 2009-10-22
 2010-10-22
(14 rows)

select tc1 - 5::float8::int4 as t5 from test1 order by t5;
     t5     
------------
 2003-07-27
 2004-07-27
 2004-10-21
 2005-07-27
 2005-10-21
 2006-07-27
 2006-10-21
 2007-07-27
 2007-10-21
 2008-07-27
 2008-10-21
 2009-07-27
 2009-10-21
 2010-10-21
(14 rows)

select tc2 - 1::int2 as t6 from test1  order by t6;
            t6             
---------------------------
 2003-07-31 10:12:21.09876
 2004-07-31 10:12:21.09875
 2004-10-25 15:18:28.19752
 2005-07-31 10:12:21.09874
 2005-10-25 15:18:28.19751
 2006-07-31 10:12:21.09873
 2006-10-25 15:18:28.1975
 2007-07-31 10:12:21.09872
 2007-10-25 15:18:28.19749
 2008-07-31 10:12:21.09871
 2008-10-25 15:18:28.19748
 2009-07-31 10:12:21.0987
 2009-10-25 15:18:28.19747
 2010-10-25 15:18:28.19746
(14 rows)

select tc2 - 2::int4 as t7 from test1  order by t7;
            t7             
---------------------------
 2003-07-30 10:12:21.09876
 2004-07-30 10:12:21.09875
 2004-10-24 15:18:28.19752
 2005-07-30 10:12:21.09874
 2005-10-24 15:18:28.19751
 2006-07-30 10:12:21.09873
 2006-10-24 15:18:28.1975
 2007-07-30 10:12:21.09872
 2007-10-24 15:18:28.19749
 2008-07-30 10:12:21.09871
 2008-10-24 15:18:28.19748
 2009-07-30 10:12:21.0987
 2009-10-24 15:18:28.19747
 2010-10-24 15:18:28.19746
(14 rows)

select tc2 - 3::int8 as t8 from test1  order by t8;
            t8             
---------------------------
 2003-07-29 10:12:21.09876
 2004-07-29 10:12:21.09875
 2004-10-23 15:18:28.19752
 2005-07-29 10:12:21.09874
 2005-10-23 15:18:28.19751
 2006-07-29 10:12:21.09873
 2006-10-23 15:18:28.1975
 2007-07-29 10:12:21.09872
 2007-10-23 15:18:28.19749
 2008-07-29 10:12:21.09871
 2008-10-23 15:18:28.19748
 2009-07-29 10:12:21.0987
 2009-10-23 15:18:28.19747
 2010-10-23 15:18:28.19746
(14 rows)

select tc2 - 4::float4::numeric as t9 from test1  order by t9;
            t9             
---------------------------
 2003-07-28 10:12:21.09876
 2004-07-28 10:12:21.09875
 2004-10-22 15:18:28.19752
 2005-07-28 10:12:21.09874
 2005-10-22 15:18:28.19751
 2006-07-28 10:12:21.09873
 2006-10-22 15:18:28.1975
 2007-07-28 10:12:21.09872
 2007-10-22 15:18:28.19749
 2008-07-28 10:12:21.09871
 2008-10-22 15:18:28.19748
 2009-07-28 10:12:21.0987
 2009-10-22 15:18:28.19747
 2010-10-22 15:18:28.19746
(14 rows)

select tc2 - 5::float8::numeric as t10 from test1 order by t10;
            t10            
---------------------------
 2003-07-27 10:12:21.09876
 2004-07-27 10:12:21.09875
 2004-10-21 15:18:28.19752
 2005-07-27 10:12:21.09874
 2005-10-21 15:18:28.19751
 2006-07-27 10:12:21.09873
 2006-10-21 15:18:28.1975
 2007-07-27 10:12:21.09872
 2007-10-21 15:18:28.19749
 2008-07-27 10:12:21.09871
 2008-10-21 15:18:28.19748
 2009-07-27 10:12:21.0987
 2009-10-21 15:18:28.19747
 2010-10-21 15:18:28.19746
(14 rows)

select tc1 - tc2 as t11 from test1  order by t11; -- 
        t11         
--------------------
 -0.637826360185185
 -0.637826360069444
 -0.637826359953704
 -0.637826359837963
 -0.637826359722222
 -0.637826359606481
 -0.637826359490741
 -0.425244198611111
  -0.42524419849537
  -0.42524419837963
 -0.425244198263889
 -0.425244198148148
 -0.425244198032407
 -0.425244197916667
(14 rows)

select tc2 - tc1 as t12 from test1  order by t12; --
        t12        
-------------------
 0.425244197916667
 0.425244198032407
 0.425244198148148
 0.425244198263889
  0.42524419837963
  0.42524419849537
 0.425244198611111
 0.637826359490741
 0.637826359606481
 0.637826359722222
 0.637826359837963
 0.637826359953704
 0.637826360069444
 0.637826360185185
(14 rows)

select tc1 - tc1 as t13 from test1  order by t13;
 t13 
-----
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
(14 rows)

select tc2 - tc2 as t14  from test1  order by t14;
 t14 
-----
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
(14 rows)

select tc1 - 1::int2::int4 as t1,
       tc1 - 2::int4 as t2,  
       tc1 - 3::int8 as t3, 
       tc1 - 4::float4::int4 as t4, 
       tc1 - 5::float8::int4 as t5,
       tc2 - 1::int2 as t6,
       tc2 - 2::int4 as t7, 
       tc2 - 3::int8 as t8, 
       tc2 - 4::float4::numeric as t9,
       tc2 - 5::float8::numeric as t10,
       tc1 - tc2 as t11,
       tc2 - tc1 as t12,
       tc1 - tc1 as t13,
       tc2 - tc2 as t14
    from test1 
    order by t1, t2, t3, t4, t5, t6, t7, t8, t9, t10, t11, t12, t13, t14;
     t1     |     t2     |         t3          |     t4     |     t5     |            t6             |            t7             |            t8             |            t9             |            t10            |        t11         |        t12        | t13 | t14 
------------+------------+---------------------+------------+------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+--------------------+-------------------+-----+-----
 2003-07-31 | 2003-07-30 | 2003-07-29 00:00:00 | 2003-07-28 | 2003-07-27 | 2003-07-31 10:12:21.09876 | 2003-07-30 10:12:21.09876 | 2003-07-29 10:12:21.09876 | 2003-07-28 10:12:21.09876 | 2003-07-27 10:12:21.09876 | -0.425244198611111 | 0.425244198611111 |   0 |   0
 2004-07-31 | 2004-07-30 | 2004-07-29 00:00:00 | 2004-07-28 | 2004-07-27 | 2004-07-31 10:12:21.09875 | 2004-07-30 10:12:21.09875 | 2004-07-29 10:12:21.09875 | 2004-07-28 10:12:21.09875 | 2004-07-27 10:12:21.09875 |  -0.42524419849537 |  0.42524419849537 |   0 |   0
 2004-10-25 | 2004-10-24 | 2004-10-23 00:00:00 | 2004-10-22 | 2004-10-21 | 2004-10-25 15:18:28.19752 | 2004-10-24 15:18:28.19752 | 2004-10-23 15:18:28.19752 | 2004-10-22 15:18:28.19752 | 2004-10-21 15:18:28.19752 | -0.637826360185185 | 0.637826360185185 |   0 |   0
 2005-07-31 | 2005-07-30 | 2005-07-29 00:00:00 | 2005-07-28 | 2005-07-27 | 2005-07-31 10:12:21.09874 | 2005-07-30 10:12:21.09874 | 2005-07-29 10:12:21.09874 | 2005-07-28 10:12:21.09874 | 2005-07-27 10:12:21.09874 |  -0.42524419837963 |  0.42524419837963 |   0 |   0
 2005-10-25 | 2005-10-24 | 2005-10-23 00:00:00 | 2005-10-22 | 2005-10-21 | 2005-10-25 15:18:28.19751 | 2005-10-24 15:18:28.19751 | 2005-10-23 15:18:28.19751 | 2005-10-22 15:18:28.19751 | 2005-10-21 15:18:28.19751 | -0.637826360069444 | 0.637826360069444 |   0 |   0
 2006-07-31 | 2006-07-30 | 2006-07-29 00:00:00 | 2006-07-28 | 2006-07-27 | 2006-07-31 10:12:21.09873 | 2006-07-30 10:12:21.09873 | 2006-07-29 10:12:21.09873 | 2006-07-28 10:12:21.09873 | 2006-07-27 10:12:21.09873 | -0.425244198263889 | 0.425244198263889 |   0 |   0
 2006-10-25 | 2006-10-24 | 2006-10-23 00:00:00 | 2006-10-22 | 2006-10-21 | 2006-10-25 15:18:28.1975  | 2006-10-24 15:18:28.1975  | 2006-10-23 15:18:28.1975  | 2006-10-22 15:18:28.1975  | 2006-10-21 15:18:28.1975  | -0.637826359953704 | 0.637826359953704 |   0 |   0
 2007-07-31 | 2007-07-30 | 2007-07-29 00:00:00 | 2007-07-28 | 2007-07-27 | 2007-07-31 10:12:21.09872 | 2007-07-30 10:12:21.09872 | 2007-07-29 10:12:21.09872 | 2007-07-28 10:12:21.09872 | 2007-07-27 10:12:21.09872 | -0.425244198148148 | 0.425244198148148 |   0 |   0
 2007-10-25 | 2007-10-24 | 2007-10-23 00:00:00 | 2007-10-22 | 2007-10-21 | 2007-10-25 15:18:28.19749 | 2007-10-24 15:18:28.19749 | 2007-10-23 15:18:28.19749 | 2007-10-22 15:18:28.19749 | 2007-10-21 15:18:28.19749 | -0.637826359837963 | 0.637826359837963 |   0 |   0
 2008-07-31 | 2008-07-30 | 2008-07-29 00:00:00 | 2008-07-28 | 2008-07-27 | 2008-07-31 10:12:21.09871 | 2008-07-30 10:12:21.09871 | 2008-07-29 10:12:21.09871 | 2008-07-28 10:12:21.09871 | 2008-07-27 10:12:21.09871 | -0.425244198032407 | 0.425244198032407 |   0 |   0
 2008-10-25 | 2008-10-24 | 2008-10-23 00:00:00 | 2008-10-22 | 2008-10-21 | 2008-10-25 15:18:28.19748 | 2008-10-24 15:18:28.19748 | 2008-10-23 15:18:28.19748 | 2008-10-22 15:18:28.19748 | 2008-10-21 15:18:28.19748 | -0.637826359722222 | 0.637826359722222 |   0 |   0
 2009-07-31 | 2009-07-30 | 2009-07-29 00:00:00 | 2009-07-28 | 2009-07-27 | 2009-07-31 10:12:21.0987  | 2009-07-30 10:12:21.0987  | 2009-07-29 10:12:21.0987  | 2009-07-28 10:12:21.0987  | 2009-07-27 10:12:21.0987  | -0.425244197916667 | 0.425244197916667 |   0 |   0
 2009-10-25 | 2009-10-24 | 2009-10-23 00:00:00 | 2009-10-22 | 2009-10-21 | 2009-10-25 15:18:28.19747 | 2009-10-24 15:18:28.19747 | 2009-10-23 15:18:28.19747 | 2009-10-22 15:18:28.19747 | 2009-10-21 15:18:28.19747 | -0.637826359606481 | 0.637826359606481 |   0 |   0
 2010-10-25 | 2010-10-24 | 2010-10-23 00:00:00 | 2010-10-22 | 2010-10-21 | 2010-10-25 15:18:28.19746 | 2010-10-24 15:18:28.19746 | 2010-10-23 15:18:28.19746 | 2010-10-22 15:18:28.19746 | 2010-10-21 15:18:28.19746 | -0.637826359490741 | 0.637826359490741 |   0 |   0
(14 rows)

select tc1 + 1::int2::int4 as t1,
       tc1 + 2::int4 as t2,  
       tc1 + 3::int8 as t3, 
       tc1 + 4::float4::int4 as t4, 
       tc1 + 5::float8::int4 as t5,
       tc2 + 1::int2 as t6,
       tc2 + 2::int4 as t7, 
       tc2 + 3::int8 as t8, 
       tc2 + 4::float4::numeric as t9,
       tc2 + 5::float8::numeric as t10
    from test1 
    order by t1, t2, t3, t4, t5, t6, t7, t8, t9, t10;
     t1     |     t2     |         t3          |     t4     |     t5     |            t6             |            t7             |            t8             |            t9             |            t10            
------------+------------+---------------------+------------+------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------
 2003-08-02 | 2003-08-03 | 2003-08-04 00:00:00 | 2003-08-05 | 2003-08-06 | 2003-08-02 10:12:21.09876 | 2003-08-03 10:12:21.09876 | 2003-08-04 10:12:21.09876 | 2003-08-05 10:12:21.09876 | 2003-08-06 10:12:21.09876
 2004-08-02 | 2004-08-03 | 2004-08-04 00:00:00 | 2004-08-05 | 2004-08-06 | 2004-08-02 10:12:21.09875 | 2004-08-03 10:12:21.09875 | 2004-08-04 10:12:21.09875 | 2004-08-05 10:12:21.09875 | 2004-08-06 10:12:21.09875
 2004-10-27 | 2004-10-28 | 2004-10-29 00:00:00 | 2004-10-30 | 2004-10-31 | 2004-10-27 15:18:28.19752 | 2004-10-28 15:18:28.19752 | 2004-10-29 15:18:28.19752 | 2004-10-30 15:18:28.19752 | 2004-10-31 15:18:28.19752
 2005-08-02 | 2005-08-03 | 2005-08-04 00:00:00 | 2005-08-05 | 2005-08-06 | 2005-08-02 10:12:21.09874 | 2005-08-03 10:12:21.09874 | 2005-08-04 10:12:21.09874 | 2005-08-05 10:12:21.09874 | 2005-08-06 10:12:21.09874
 2005-10-27 | 2005-10-28 | 2005-10-29 00:00:00 | 2005-10-30 | 2005-10-31 | 2005-10-27 15:18:28.19751 | 2005-10-28 15:18:28.19751 | 2005-10-29 15:18:28.19751 | 2005-10-30 15:18:28.19751 | 2005-10-31 15:18:28.19751
 2006-08-02 | 2006-08-03 | 2006-08-04 00:00:00 | 2006-08-05 | 2006-08-06 | 2006-08-02 10:12:21.09873 | 2006-08-03 10:12:21.09873 | 2006-08-04 10:12:21.09873 | 2006-08-05 10:12:21.09873 | 2006-08-06 10:12:21.09873
 2006-10-27 | 2006-10-28 | 2006-10-29 00:00:00 | 2006-10-30 | 2006-10-31 | 2006-10-27 15:18:28.1975  | 2006-10-28 15:18:28.1975  | 2006-10-29 15:18:28.1975  | 2006-10-30 15:18:28.1975  | 2006-10-31 15:18:28.1975
 2007-08-02 | 2007-08-03 | 2007-08-04 00:00:00 | 2007-08-05 | 2007-08-06 | 2007-08-02 10:12:21.09872 | 2007-08-03 10:12:21.09872 | 2007-08-04 10:12:21.09872 | 2007-08-05 10:12:21.09872 | 2007-08-06 10:12:21.09872
 2007-10-27 | 2007-10-28 | 2007-10-29 00:00:00 | 2007-10-30 | 2007-10-31 | 2007-10-27 15:18:28.19749 | 2007-10-28 15:18:28.19749 | 2007-10-29 15:18:28.19749 | 2007-10-30 15:18:28.19749 | 2007-10-31 15:18:28.19749
 2008-08-02 | 2008-08-03 | 2008-08-04 00:00:00 | 2008-08-05 | 2008-08-06 | 2008-08-02 10:12:21.09871 | 2008-08-03 10:12:21.09871 | 2008-08-04 10:12:21.09871 | 2008-08-05 10:12:21.09871 | 2008-08-06 10:12:21.09871
 2008-10-27 | 2008-10-28 | 2008-10-29 00:00:00 | 2008-10-30 | 2008-10-31 | 2008-10-27 15:18:28.19748 | 2008-10-28 15:18:28.19748 | 2008-10-29 15:18:28.19748 | 2008-10-30 15:18:28.19748 | 2008-10-31 15:18:28.19748
 2009-08-02 | 2009-08-03 | 2009-08-04 00:00:00 | 2009-08-05 | 2009-08-06 | 2009-08-02 10:12:21.0987  | 2009-08-03 10:12:21.0987  | 2009-08-04 10:12:21.0987  | 2009-08-05 10:12:21.0987  | 2009-08-06 10:12:21.0987
 2009-10-27 | 2009-10-28 | 2009-10-29 00:00:00 | 2009-10-30 | 2009-10-31 | 2009-10-27 15:18:28.19747 | 2009-10-28 15:18:28.19747 | 2009-10-29 15:18:28.19747 | 2009-10-30 15:18:28.19747 | 2009-10-31 15:18:28.19747
 2010-10-27 | 2010-10-28 | 2010-10-29 00:00:00 | 2010-10-30 | 2010-10-31 | 2010-10-27 15:18:28.19746 | 2010-10-28 15:18:28.19746 | 2010-10-29 15:18:28.19746 | 2010-10-30 15:18:28.19746 | 2010-10-31 15:18:28.19746
(14 rows)

    
select tc1 - 1::int2::int4 as t1,
       tc1 - 2::int4 as t2,  
       tc1 - 3::int8 as t3, 
       tc1 - 4::float4::int4 as t4, 
       tc1 - 5::float8::int4 as t5,
       tc2 - 1::int2 as t6,
       tc2 - 2::int4 as t7, 
       tc2 - 3::int8 as t8, 
       tc2 - 4::float4::numeric as t9,
       tc2 - 5::float8::numeric as t10,
       tc1 - tc2 as t11,
       tc2 - tc1 as t12,
       tc1 - tc1 as t13,
       tc2 - tc2 as t14
    from test2 
    order by t1, t2, t3, t4, t5, t6, t7, t8, t9, t10, t11, t12, t13, t14;
         t1          |         t2          |         t3          |         t4          |         t5          |            t6             |            t7             |            t8             |            t9             |            t10            |          t11          |         t12          | t13 | t14 
---------------------+---------------------+---------------------+---------------------+---------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+-----------------------+----------------------+-----+-----
 2003-07-31 10:12:21 | 2003-07-30 10:12:21 | 2003-07-29 10:12:21 | 2003-07-28 10:12:21 | 2003-07-27 10:12:21 | 2003-07-31 10:12:21.09876 | 2003-07-30 10:12:21.09876 | 2003-07-29 10:12:21.09876 | 2003-07-28 10:12:21.09876 | 2003-07-27 10:12:21.09876 | -1.14305555555556e-06 | 1.14305555555556e-06 |   0 |   0
 2004-07-31 10:12:21 | 2004-07-30 10:12:21 | 2004-07-29 10:12:21 | 2004-07-28 10:12:21 | 2004-07-27 10:12:21 | 2004-07-31 10:12:21.09875 | 2004-07-30 10:12:21.09875 | 2004-07-29 10:12:21.09875 | 2004-07-28 10:12:21.09875 | 2004-07-27 10:12:21.09875 | -1.14293981481481e-06 | 1.14293981481481e-06 |   0 |   0
 2004-10-25 15:18:28 | 2004-10-24 15:18:28 | 2004-10-23 15:18:28 | 2004-10-22 15:18:28 | 2004-10-21 15:18:28 | 2004-10-25 15:18:28.19752 | 2004-10-24 15:18:28.19752 | 2004-10-23 15:18:28.19752 | 2004-10-22 15:18:28.19752 | 2004-10-21 15:18:28.19752 | -2.28611111111111e-06 | 2.28611111111111e-06 |   0 |   0
 2005-07-31 10:12:21 | 2005-07-30 10:12:21 | 2005-07-29 10:12:21 | 2005-07-28 10:12:21 | 2005-07-27 10:12:21 | 2005-07-31 10:12:21.09874 | 2005-07-30 10:12:21.09874 | 2005-07-29 10:12:21.09874 | 2005-07-28 10:12:21.09874 | 2005-07-27 10:12:21.09874 | -1.14282407407407e-06 | 1.14282407407407e-06 |   0 |   0
 2005-10-25 15:18:28 | 2005-10-24 15:18:28 | 2005-10-23 15:18:28 | 2005-10-22 15:18:28 | 2005-10-21 15:18:28 | 2005-10-25 15:18:28.19751 | 2005-10-24 15:18:28.19751 | 2005-10-23 15:18:28.19751 | 2005-10-22 15:18:28.19751 | 2005-10-21 15:18:28.19751 | -2.28599537037037e-06 | 2.28599537037037e-06 |   0 |   0
 2006-07-31 10:12:21 | 2006-07-30 10:12:21 | 2006-07-29 10:12:21 | 2006-07-28 10:12:21 | 2006-07-27 10:12:21 | 2006-07-31 10:12:21.09873 | 2006-07-30 10:12:21.09873 | 2006-07-29 10:12:21.09873 | 2006-07-28 10:12:21.09873 | 2006-07-27 10:12:21.09873 | -1.14270833333333e-06 | 1.14270833333333e-06 |   0 |   0
 2006-10-25 15:18:28 | 2006-10-24 15:18:28 | 2006-10-23 15:18:28 | 2006-10-22 15:18:28 | 2006-10-21 15:18:28 | 2006-10-25 15:18:28.1975  | 2006-10-24 15:18:28.1975  | 2006-10-23 15:18:28.1975  | 2006-10-22 15:18:28.1975  | 2006-10-21 15:18:28.1975  | -2.28587962962963e-06 | 2.28587962962963e-06 |   0 |   0
 2007-07-31 10:12:21 | 2007-07-30 10:12:21 | 2007-07-29 10:12:21 | 2007-07-28 10:12:21 | 2007-07-27 10:12:21 | 2007-07-31 10:12:21.09872 | 2007-07-30 10:12:21.09872 | 2007-07-29 10:12:21.09872 | 2007-07-28 10:12:21.09872 | 2007-07-27 10:12:21.09872 | -1.14259259259259e-06 | 1.14259259259259e-06 |   0 |   0
 2007-10-25 15:18:28 | 2007-10-24 15:18:28 | 2007-10-23 15:18:28 | 2007-10-22 15:18:28 | 2007-10-21 15:18:28 | 2007-10-25 15:18:28.19749 | 2007-10-24 15:18:28.19749 | 2007-10-23 15:18:28.19749 | 2007-10-22 15:18:28.19749 | 2007-10-21 15:18:28.19749 | -2.28576388888889e-06 | 2.28576388888889e-06 |   0 |   0
 2008-07-31 10:12:21 | 2008-07-30 10:12:21 | 2008-07-29 10:12:21 | 2008-07-28 10:12:21 | 2008-07-27 10:12:21 | 2008-07-31 10:12:21.09871 | 2008-07-30 10:12:21.09871 | 2008-07-29 10:12:21.09871 | 2008-07-28 10:12:21.09871 | 2008-07-27 10:12:21.09871 | -1.14247685185185e-06 | 1.14247685185185e-06 |   0 |   0
 2008-10-25 15:18:28 | 2008-10-24 15:18:28 | 2008-10-23 15:18:28 | 2008-10-22 15:18:28 | 2008-10-21 15:18:28 | 2008-10-25 15:18:28.19748 | 2008-10-24 15:18:28.19748 | 2008-10-23 15:18:28.19748 | 2008-10-22 15:18:28.19748 | 2008-10-21 15:18:28.19748 | -2.28564814814815e-06 | 2.28564814814815e-06 |   0 |   0
 2009-07-31 10:12:21 | 2009-07-30 10:12:21 | 2009-07-29 10:12:21 | 2009-07-28 10:12:21 | 2009-07-27 10:12:21 | 2009-07-31 10:12:21.0987  | 2009-07-30 10:12:21.0987  | 2009-07-29 10:12:21.0987  | 2009-07-28 10:12:21.0987  | 2009-07-27 10:12:21.0987  | -1.14236111111111e-06 | 1.14236111111111e-06 |   0 |   0
 2009-10-25 15:18:28 | 2009-10-24 15:18:28 | 2009-10-23 15:18:28 | 2009-10-22 15:18:28 | 2009-10-21 15:18:28 | 2009-10-25 15:18:28.19747 | 2009-10-24 15:18:28.19747 | 2009-10-23 15:18:28.19747 | 2009-10-22 15:18:28.19747 | 2009-10-21 15:18:28.19747 | -2.28553240740741e-06 | 2.28553240740741e-06 |   0 |   0
 2010-10-25 15:18:28 | 2010-10-24 15:18:28 | 2010-10-23 15:18:28 | 2010-10-22 15:18:28 | 2010-10-21 15:18:28 | 2010-10-25 15:18:28.19746 | 2010-10-24 15:18:28.19746 | 2010-10-23 15:18:28.19746 | 2010-10-22 15:18:28.19746 | 2010-10-21 15:18:28.19746 | -2.28541666666667e-06 | 2.28541666666667e-06 |   0 |   0
(14 rows)

select tc1 + 1::int2::int4 as t1,
       tc1 + 2::int4 as t2,  
       tc1 + 3::int8 as t3, 
       tc1 + 4::float4::int4 as t4, 
       tc1 + 5::float8::int4 as t5,
       tc2 + 1::int2 as t6,
       tc2 + 2::int4 as t7, 
       tc2 + 3::int8 as t8, 
       tc2 + 4::float4::numeric as t9,
       tc2 + 5::float8::numeric as t10
    from test2 
    order by t1, t2, t3, t4, t5, t6, t7, t8, t9, t10;
         t1          |         t2          |         t3          |         t4          |         t5          |            t6             |            t7             |            t8             |            t9             |            t10            
---------------------+---------------------+---------------------+---------------------+---------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------
 2003-08-02 10:12:21 | 2003-08-03 10:12:21 | 2003-08-04 10:12:21 | 2003-08-05 10:12:21 | 2003-08-06 10:12:21 | 2003-08-02 10:12:21.09876 | 2003-08-03 10:12:21.09876 | 2003-08-04 10:12:21.09876 | 2003-08-05 10:12:21.09876 | 2003-08-06 10:12:21.09876
 2004-08-02 10:12:21 | 2004-08-03 10:12:21 | 2004-08-04 10:12:21 | 2004-08-05 10:12:21 | 2004-08-06 10:12:21 | 2004-08-02 10:12:21.09875 | 2004-08-03 10:12:21.09875 | 2004-08-04 10:12:21.09875 | 2004-08-05 10:12:21.09875 | 2004-08-06 10:12:21.09875
 2004-10-27 15:18:28 | 2004-10-28 15:18:28 | 2004-10-29 15:18:28 | 2004-10-30 15:18:28 | 2004-10-31 15:18:28 | 2004-10-27 15:18:28.19752 | 2004-10-28 15:18:28.19752 | 2004-10-29 15:18:28.19752 | 2004-10-30 15:18:28.19752 | 2004-10-31 15:18:28.19752
 2005-08-02 10:12:21 | 2005-08-03 10:12:21 | 2005-08-04 10:12:21 | 2005-08-05 10:12:21 | 2005-08-06 10:12:21 | 2005-08-02 10:12:21.09874 | 2005-08-03 10:12:21.09874 | 2005-08-04 10:12:21.09874 | 2005-08-05 10:12:21.09874 | 2005-08-06 10:12:21.09874
 2005-10-27 15:18:28 | 2005-10-28 15:18:28 | 2005-10-29 15:18:28 | 2005-10-30 15:18:28 | 2005-10-31 15:18:28 | 2005-10-27 15:18:28.19751 | 2005-10-28 15:18:28.19751 | 2005-10-29 15:18:28.19751 | 2005-10-30 15:18:28.19751 | 2005-10-31 15:18:28.19751
 2006-08-02 10:12:21 | 2006-08-03 10:12:21 | 2006-08-04 10:12:21 | 2006-08-05 10:12:21 | 2006-08-06 10:12:21 | 2006-08-02 10:12:21.09873 | 2006-08-03 10:12:21.09873 | 2006-08-04 10:12:21.09873 | 2006-08-05 10:12:21.09873 | 2006-08-06 10:12:21.09873
 2006-10-27 15:18:28 | 2006-10-28 15:18:28 | 2006-10-29 15:18:28 | 2006-10-30 15:18:28 | 2006-10-31 15:18:28 | 2006-10-27 15:18:28.1975  | 2006-10-28 15:18:28.1975  | 2006-10-29 15:18:28.1975  | 2006-10-30 15:18:28.1975  | 2006-10-31 15:18:28.1975
 2007-08-02 10:12:21 | 2007-08-03 10:12:21 | 2007-08-04 10:12:21 | 2007-08-05 10:12:21 | 2007-08-06 10:12:21 | 2007-08-02 10:12:21.09872 | 2007-08-03 10:12:21.09872 | 2007-08-04 10:12:21.09872 | 2007-08-05 10:12:21.09872 | 2007-08-06 10:12:21.09872
 2007-10-27 15:18:28 | 2007-10-28 15:18:28 | 2007-10-29 15:18:28 | 2007-10-30 15:18:28 | 2007-10-31 15:18:28 | 2007-10-27 15:18:28.19749 | 2007-10-28 15:18:28.19749 | 2007-10-29 15:18:28.19749 | 2007-10-30 15:18:28.19749 | 2007-10-31 15:18:28.19749
 2008-08-02 10:12:21 | 2008-08-03 10:12:21 | 2008-08-04 10:12:21 | 2008-08-05 10:12:21 | 2008-08-06 10:12:21 | 2008-08-02 10:12:21.09871 | 2008-08-03 10:12:21.09871 | 2008-08-04 10:12:21.09871 | 2008-08-05 10:12:21.09871 | 2008-08-06 10:12:21.09871
 2008-10-27 15:18:28 | 2008-10-28 15:18:28 | 2008-10-29 15:18:28 | 2008-10-30 15:18:28 | 2008-10-31 15:18:28 | 2008-10-27 15:18:28.19748 | 2008-10-28 15:18:28.19748 | 2008-10-29 15:18:28.19748 | 2008-10-30 15:18:28.19748 | 2008-10-31 15:18:28.19748
 2009-08-02 10:12:21 | 2009-08-03 10:12:21 | 2009-08-04 10:12:21 | 2009-08-05 10:12:21 | 2009-08-06 10:12:21 | 2009-08-02 10:12:21.0987  | 2009-08-03 10:12:21.0987  | 2009-08-04 10:12:21.0987  | 2009-08-05 10:12:21.0987  | 2009-08-06 10:12:21.0987
 2009-10-27 15:18:28 | 2009-10-28 15:18:28 | 2009-10-29 15:18:28 | 2009-10-30 15:18:28 | 2009-10-31 15:18:28 | 2009-10-27 15:18:28.19747 | 2009-10-28 15:18:28.19747 | 2009-10-29 15:18:28.19747 | 2009-10-30 15:18:28.19747 | 2009-10-31 15:18:28.19747
 2010-10-27 15:18:28 | 2010-10-28 15:18:28 | 2010-10-29 15:18:28 | 2010-10-30 15:18:28 | 2010-10-31 15:18:28 | 2010-10-27 15:18:28.19746 | 2010-10-28 15:18:28.19746 | 2010-10-29 15:18:28.19746 | 2010-10-30 15:18:28.19746 | 2010-10-31 15:18:28.19746
(14 rows)

select tc1 - tc2 as t1, tc2 - tc1 as t2 from test1 order by t1, t2;
         t1         |        t2         
--------------------+-------------------
 -0.637826360185185 | 0.637826360185185
 -0.637826360069444 | 0.637826360069444
 -0.637826359953704 | 0.637826359953704
 -0.637826359837963 | 0.637826359837963
 -0.637826359722222 | 0.637826359722222
 -0.637826359606481 | 0.637826359606481
 -0.637826359490741 | 0.637826359490741
 -0.425244198611111 | 0.425244198611111
  -0.42524419849537 |  0.42524419849537
  -0.42524419837963 |  0.42524419837963
 -0.425244198263889 | 0.425244198263889
 -0.425244198148148 | 0.425244198148148
 -0.425244198032407 | 0.425244198032407
 -0.425244197916667 | 0.425244197916667
(14 rows)

select tc1 - tc2 as t1, tc2 - tc1 as t2 from test2 order by t1, t2;
          t1           |          t2          
-----------------------+----------------------
 -2.28611111111111e-06 | 2.28611111111111e-06
 -2.28599537037037e-06 | 2.28599537037037e-06
 -2.28587962962963e-06 | 2.28587962962963e-06
 -2.28576388888889e-06 | 2.28576388888889e-06
 -2.28564814814815e-06 | 2.28564814814815e-06
 -2.28553240740741e-06 | 2.28553240740741e-06
 -2.28541666666667e-06 | 2.28541666666667e-06
 -1.14305555555556e-06 | 1.14305555555556e-06
 -1.14293981481481e-06 | 1.14293981481481e-06
 -1.14282407407407e-06 | 1.14282407407407e-06
 -1.14270833333333e-06 | 1.14270833333333e-06
 -1.14259259259259e-06 | 1.14259259259259e-06
 -1.14247685185185e-06 | 1.14247685185185e-06
 -1.14236111111111e-06 | 1.14236111111111e-06
(14 rows)

select tc1, tc1 + 1/24/3600  t1 from test1 order by tc1, t1;
    tc1     |         t1          
------------+---------------------
 2003-08-01 | 2003-08-01 00:00:01
 2004-08-01 | 2004-08-01 00:00:01
 2004-10-26 | 2004-10-26 00:00:01
 2005-08-01 | 2005-08-01 00:00:01
 2005-10-26 | 2005-10-26 00:00:01
 2006-08-01 | 2006-08-01 00:00:01
 2006-10-26 | 2006-10-26 00:00:01
 2007-08-01 | 2007-08-01 00:00:01
 2007-10-26 | 2007-10-26 00:00:01
 2008-08-01 | 2008-08-01 00:00:01
 2008-10-26 | 2008-10-26 00:00:01
 2009-08-01 | 2009-08-01 00:00:01
 2009-10-26 | 2009-10-26 00:00:01
 2010-10-26 | 2010-10-26 00:00:01
(14 rows)

select tc1, tc1 + 1/24/3600  t1 from test2 order by tc1, t1;
         tc1         |         t1          
---------------------+---------------------
 2003-08-01 10:12:21 | 2003-08-01 10:12:22
 2004-08-01 10:12:21 | 2004-08-01 10:12:22
 2004-10-26 15:18:28 | 2004-10-26 15:18:29
 2005-08-01 10:12:21 | 2005-08-01 10:12:22
 2005-10-26 15:18:28 | 2005-10-26 15:18:29
 2006-08-01 10:12:21 | 2006-08-01 10:12:22
 2006-10-26 15:18:28 | 2006-10-26 15:18:29
 2007-08-01 10:12:21 | 2007-08-01 10:12:22
 2007-10-26 15:18:28 | 2007-10-26 15:18:29
 2008-08-01 10:12:21 | 2008-08-01 10:12:22
 2008-10-26 15:18:28 | 2008-10-26 15:18:29
 2009-08-01 10:12:21 | 2009-08-01 10:12:22
 2009-10-26 15:18:28 | 2009-10-26 15:18:29
 2010-10-26 15:18:28 | 2010-10-26 15:18:29
(14 rows)

select tc1, tc1 - 1/24/3600  t1 from test1 order by tc1, t1;
    tc1     |         t1          
------------+---------------------
 2003-08-01 | 2003-07-31 23:59:59
 2004-08-01 | 2004-07-31 23:59:59
 2004-10-26 | 2004-10-25 23:59:59
 2005-08-01 | 2005-07-31 23:59:59
 2005-10-26 | 2005-10-25 23:59:59
 2006-08-01 | 2006-07-31 23:59:59
 2006-10-26 | 2006-10-25 23:59:59
 2007-08-01 | 2007-07-31 23:59:59
 2007-10-26 | 2007-10-25 23:59:59
 2008-08-01 | 2008-07-31 23:59:59
 2008-10-26 | 2008-10-25 23:59:59
 2009-08-01 | 2009-07-31 23:59:59
 2009-10-26 | 2009-10-25 23:59:59
 2010-10-26 | 2010-10-25 23:59:59
(14 rows)

select tc1, tc1 - 1/24/3600  t1 from test2 order by tc1, t1;
         tc1         |         t1          
---------------------+---------------------
 2003-08-01 10:12:21 | 2003-08-01 10:12:20
 2004-08-01 10:12:21 | 2004-08-01 10:12:20
 2004-10-26 15:18:28 | 2004-10-26 15:18:27
 2005-08-01 10:12:21 | 2005-08-01 10:12:20
 2005-10-26 15:18:28 | 2005-10-26 15:18:27
 2006-08-01 10:12:21 | 2006-08-01 10:12:20
 2006-10-26 15:18:28 | 2006-10-26 15:18:27
 2007-08-01 10:12:21 | 2007-08-01 10:12:20
 2007-10-26 15:18:28 | 2007-10-26 15:18:27
 2008-08-01 10:12:21 | 2008-08-01 10:12:20
 2008-10-26 15:18:28 | 2008-10-26 15:18:27
 2009-08-01 10:12:21 | 2009-08-01 10:12:20
 2009-10-26 15:18:28 | 2009-10-26 15:18:27
 2010-10-26 15:18:28 | 2010-10-26 15:18:27
(14 rows)

drop table test1;
drop table test2;
reset enable_oracle_compatible;
--test sequence
set enable_oracle_compatible = off;
create sequence public.my_serial start 11;
select nextval('public.my_serial');
 nextval 
---------
      11
(1 row)

select currval('public.my_serial');
 currval 
---------
      11
(1 row)

select lastval();
 lastval 
---------
      11
(1 row)

select setval('public.my_serial', 12);
 setval 
--------
     12
(1 row)

select currval('public.my_serial');
 currval 
---------
      12
(1 row)

select nextval('public.my_serial');
 nextval 
---------
      13
(1 row)

select lastval();
 lastval 
---------
      13
(1 row)

select setval('public.my_serial', 22, true);
 setval 
--------
     22
(1 row)

select currval('public.my_serial');
 currval 
---------
      22
(1 row)

select nextval('public.my_serial');
 nextval 
---------
      23
(1 row)

select lastval();
 lastval 
---------
      23
(1 row)

select setval('public.my_serial', 33, false);
 setval 
--------
     33
(1 row)

select currval('public.my_serial');
 currval 
---------
      23
(1 row)

select nextval('public.my_serial');
 nextval 
---------
      33
(1 row)

select lastval();
 lastval 
---------
      33
(1 row)

select currval('postgres.public.my_serial');
ERROR:  cross-database references are not implemented: "postgres.public.my_serial"
LINE 1: select currval('postgres.public.my_serial');
                       ^
select nextval('postgres.public.my_serial');
ERROR:  cross-database references are not implemented: "postgres.public.my_serial"
LINE 1: select nextval('postgres.public.my_serial');
                       ^
select lastval();
 lastval 
---------
      33
(1 row)

select currval('my_serial');
 currval 
---------
      33
(1 row)

select nextval('my_serial');
 nextval 
---------
      34
(1 row)

select lastval();
 lastval 
---------
      34
(1 row)

drop sequence public.my_serial;
create sequence public.my_serial start 11;
set enable_oracle_compatible = on;
select public.my_serial.nextval;
 nextval 
---------
      11
(1 row)

select public.my_serial.currval;
 currval 
---------
      11
(1 row)

select lastval();
 lastval 
---------
      11
(1 row)

select setval('public.my_serial', 12);
 setval 
--------
     12
(1 row)

select public.my_serial.currval;
 currval 
---------
      12
(1 row)

select public.my_serial.nextval;
 nextval 
---------
      13
(1 row)

select lastval();
 lastval 
---------
      13
(1 row)

select setval('public.my_serial', 22, true);
 setval 
--------
     22
(1 row)

select public.my_serial.currval;
 currval 
---------
      22
(1 row)

select public.my_serial.nextval;
 nextval 
---------
      23
(1 row)

select lastval();
 lastval 
---------
      23
(1 row)

select setval('public.my_serial', 33, false);
 setval 
--------
     33
(1 row)

select public.my_serial.currval;
 currval 
---------
      23
(1 row)

select public.my_serial.nextval;
 nextval 
---------
      33
(1 row)

select lastval();
 lastval 
---------
      33
(1 row)

select postgres.public.my_serial.currval;
ERROR:  cross-database references are not implemented: postgres.public.my_serial.currval
LINE 1: select postgres.public.my_serial.currval;
               ^
select postgres.public.my_serial.nextval;
ERROR:  cross-database references are not implemented: postgres.public.my_serial.nextval
LINE 1: select postgres.public.my_serial.nextval;
               ^
select lastval();
 lastval 
---------
      33
(1 row)

select my_serial.currval;
 currval 
---------
      33
(1 row)

select my_serial.nextval;
 nextval 
---------
      34
(1 row)

select lastval();
 lastval 
---------
      34
(1 row)

drop sequence public.my_serial;
reset enable_oracle_compatible;
-- test dual;
select * from dual;
 dummy 
-------
 X
(1 row)

select 1 as t from dual;
 t 
---
 1
(1 row)

select sysdate - sysdate AS now from dual;
 now 
-----
 @ 0
(1 row)

-- test using index
drop table if exists t cascade;
create table t (f1 integer not null,nc text);
alter table t add constraint t_f1_PK primary key (f1) using index;
drop table t cascade;
drop table if exists t;
create table t (f1 integer not null,nc text);
alter table t add constraint t_f1_PK primary key (f1);
drop table t cascade;
drop table if exists t;
create table t (f1 integer not null primary key using index,nc text);
drop table t cascade;
drop table if exists t;
create table t (f1 integer not null primary key,nc text);
drop table t cascade;
-- test varchar2
    -- ERROR (typmod >= 1)
    CREATE TABLE foo (a VARCHAR2(0));
ERROR:  length for type varchar2 must be at least 1
LINE 1: CREATE TABLE foo (a VARCHAR2(0));
                            ^
    -- ERROR (number of typmods = 1)
    CREATE TABLE foo (a VARCHAR2(10, 1));
ERROR:  invalid type modifier
LINE 1: CREATE TABLE foo (a VARCHAR2(10, 1));
                            ^
    -- OK
    CREATE TABLE foo (a VARCHAR(5000));
    -- cleanup
    DROP TABLE foo;
    -- OK
    CREATE TABLE foo (a VARCHAR2(5));
    CREATE INDEX ON foo(a);
    --
    -- test that no value longer than maxlen is allowed
    --
    -- ERROR (length > 5)
    INSERT INTO foo VALUES ('abcdef');
ERROR:  input value length is 6; too long for type varchar2(5)
    -- ERROR (length > 5);
    -- VARCHAR2 does not truncate blank spaces on implicit coercion
    INSERT INTO foo VALUES ('abcde  ');
ERROR:  input value length is 7; too long for type varchar2(5)
    -- OK
    INSERT INTO foo VALUES ('abcde');
    -- OK
    INSERT INTO foo VALUES ('abcdef'::VARCHAR2(5));
    -- OK
    INSERT INTO foo VALUES ('abcde  '::VARCHAR2(5));
    --OK
    INSERT INTO foo VALUES ('abc'::VARCHAR2(5));
    --
    -- test whitespace semantics on comparison
    --
    -- equal
    SELECT 'abcde   '::VARCHAR2(10) = 'abcde   '::VARCHAR2(10);
 ?column? 
----------
 t
(1 row)

    -- not equal
    SELECT 'abcde  '::VARCHAR2(10) = 'abcde   '::VARCHAR2(10);
 ?column? 
----------
 f
(1 row)

    -- cleanup
    DROP TABLE foo;
-- test nvarchar2
    --
    -- test type modifier related rules
    --
    -- ERROR (typmod >= 1)
    CREATE TABLE bar (a NVARCHAR2(0));
ERROR:  length for type nvarchar2 must be at least 1
LINE 1: CREATE TABLE bar (a NVARCHAR2(0));
                            ^
    -- ERROR (number of typmods = 1)
    CREATE TABLE bar (a NVARCHAR2(10, 1));
ERROR:  invalid type modifier
LINE 1: CREATE TABLE bar (a NVARCHAR2(10, 1));
                            ^
    -- OK
    CREATE TABLE bar (a VARCHAR(5000));
    CREATE INDEX ON bar(a);
    -- cleanup
    DROP TABLE bar;
    -- OK
    CREATE TABLE bar (a NVARCHAR2(5));
    --
    -- test that no value longer than maxlen is allowed
    --
    -- ERROR (length > 5)
    INSERT INTO bar VALUES ('abcdef');
ERROR:  input value too long for type nvarchar2(5)
    -- ERROR (length > 5);
    -- NVARCHAR2 does not truncate blank spaces on implicit coercion
    INSERT INTO bar VALUES ('abcde  ');
ERROR:  input value too long for type nvarchar2(5)
    -- OK
    INSERT INTO bar VALUES ('abcde');
    -- OK
    INSERT INTO bar VALUES ('abcdef'::NVARCHAR2(5));
    -- OK
    INSERT INTO bar VALUES ('abcde  '::NVARCHAR2(5));
    --OK
    INSERT INTO bar VALUES ('abc'::NVARCHAR2(5));
    --
    -- test whitespace semantics on comparison
    --
    -- equal
    SELECT 'abcde   '::NVARCHAR2(10) = 'abcde   '::NVARCHAR2(10);
 ?column? 
----------
 t
(1 row)

    -- not equal
    SELECT 'abcde  '::NVARCHAR2(10) = 'abcde   '::NVARCHAR2(10);
 ?column? 
----------
 f
(1 row)

    -- cleanup
    DROP TABLE bar;
-- test cast string to numeric
drop table if exists test_t;
create table test_t(id varchar2(20));
insert into test_t values('1'); 
insert into test_t values(23);
insert into test_t values(24);
insert into test_t values(25);
set enable_oracle_compatible = off;
select * from test_t where id = 1 order by id asc;
ERROR:  operator is not unique: varchar2 = integer
LINE 1: select * from test_t where id = 1 order by id asc;
                                      ^
HINT:  Could not choose a best candidate operator. You might need to add explicit type casts.
select * from test_t where id = '1' order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id=1::text order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id = 'xxx' order by id asc;
 id 
----
(0 rows)

select * from test_t where id = 1 order by id asc;
ERROR:  operator is not unique: varchar2 = integer
LINE 1: select * from test_t where id = 1 order by id asc;
                                      ^
HINT:  Could not choose a best candidate operator. You might need to add explicit type casts.
select * from test_t where id = '1' order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id=1::text order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id = 'xxx' order by id asc;
 id 
----
(0 rows)

set enable_oracle_compatible = on;
select * from test_t where id = 1 order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id = '1' order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id=1::text order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id = 'xxx' order by id asc;
 id 
----
(0 rows)

select * from test_t where id = 1 order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id = '1' order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id=1::text order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id = 'xxx' order by id asc;
 id 
----
(0 rows)

insert into test_t values('xxx');
set enable_oracle_compatible = off;
select * from test_t where id = 1 order by id asc;
ERROR:  operator is not unique: varchar2 = integer
LINE 1: select * from test_t where id = 1 order by id asc;
                                      ^
HINT:  Could not choose a best candidate operator. You might need to add explicit type casts.
select * from test_t where id = '1' order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id=1::text order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id = 'xxx' order by id asc;
 id  
-----
 xxx
(1 row)

select * from test_t where id = 1 order by id asc;
ERROR:  operator is not unique: varchar2 = integer
LINE 1: select * from test_t where id = 1 order by id asc;
                                      ^
HINT:  Could not choose a best candidate operator. You might need to add explicit type casts.
select * from test_t where id = '1' order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id=1::text order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id = 'xxx' order by id asc;
 id  
-----
 xxx
(1 row)

set enable_oracle_compatible = on;
select * from test_t where id = 1 order by id asc;
ERROR:  invalid input syntax for type numeric: "xxx"
select * from test_t where id = '1' order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id=1::text order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id = 'xxx' order by id asc;
 id  
-----
 xxx
(1 row)

select * from test_t where id = 1 order by id asc;
ERROR:  invalid input syntax for type numeric: "xxx"
select * from test_t where id = '1' order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id=1::text order by id asc;
 id 
----
 1
(1 row)

select * from test_t where id = 'xxx' order by id asc;
 id  
-----
 xxx
(1 row)

drop table if exists test_t;
select 'xxx' || 1 as r;
  r   
------
 xxx1
(1 row)

select 1 || 'xxxx' as r;
   r   
-------
 1xxxx
(1 row)

drop table if exists test_t;
create table test_t (n int);
insert into test_t values(1);
insert into test_t values(2);
insert into test_t values(3);
insert into test_t values(4);
insert into test_t values(5);
insert into test_t values(6);
insert into test_t values(7);
insert into test_t values(8);
insert into test_t values(9);
select r from (SELECT '7' as r from dual UNION ALL SELECT n+1 as r FROM test_t WHERE n < 7 ) order by r;
 r 
---
 2
 3
 4
 5
 6
 7
 7
(7 rows)

drop table if exists test_t;
--test nlssort
SET client_encoding = utf8;
DROP DATABASE IF EXISTS regression_sort;
CREATE DATABASE regression_sort WITH TEMPLATE = template0 ENCODING='SQL_ASCII' LC_COLLATE='C' LC_CTYPE='C';
\c regression_sort
CREATE TABLE test_sort (name TEXT);
INSERT INTO test_sort VALUES ('red'), ('brown'), ('yellow'), ('Purple');
INSERT INTO test_sort VALUES ('guangdong'), ('shenzhen'), ('Tencent'), ('TBase');
SELECT * FROM test_sort ORDER BY NLSSORT(name, 'en_US.utf8');
   name    
-----------
 brown
 guangdong
 Purple
 red
 shenzhen
 TBase
 Tencent
 yellow
(8 rows)

SELECT * FROM test_sort ORDER BY NLSSORT(name, '');
   name    
-----------
 Purple
 TBase
 Tencent
 brown
 guangdong
 red
 shenzhen
 yellow
(8 rows)

SELECT set_nls_sort('invalid');
 set_nls_sort 
--------------
 
(1 row)

SELECT * FROM test_sort ORDER BY NLSSORT(name);
ERROR:  failed to set the requested LC_COLLATE value [invalid]
SELECT set_nls_sort('');
 set_nls_sort 
--------------
 
(1 row)

SELECT * FROM test_sort ORDER BY NLSSORT(name);
   name    
-----------
 Purple
 TBase
 Tencent
 brown
 guangdong
 red
 shenzhen
 yellow
(8 rows)

SELECT set_nls_sort('en_US.utf8');
 set_nls_sort 
--------------
 
(1 row)

SELECT * FROM test_sort ORDER BY NLSSORT(name);
   name    
-----------
 brown
 guangdong
 Purple
 red
 shenzhen
 TBase
 Tencent
 yellow
(8 rows)

INSERT INTO test_sort VALUES(NULL);
SELECT * FROM test_sort ORDER BY NLSSORT(name);
   name    
-----------
 brown
 guangdong
 Purple
 red
 shenzhen
 TBase
 Tencent
 yellow
 
(9 rows)

SELECT set_nls_sort('nls_sort = russian');
 set_nls_sort 
--------------
 
(1 row)

SELECT * FROM test_sort ORDER BY NLSSORT(name);
   name    
-----------
 brown
 guangdong
 Purple
 red
 shenzhen
 TBase
 Tencent
 yellow
 
(9 rows)

SELECT set_nls_sort('nls_sortr = pt_PT.iso885915@euro');
 set_nls_sort 
--------------
 
(1 row)

SELECT * FROM test_sort ORDER BY NLSSORT(name);
ERROR:  failed to set the requested LC_COLLATE value [nls_sortr = pt_PT.iso885915@euro]
SELECT set_nls_sort('nls_sortr = en_US.iso885915');
 set_nls_sort 
--------------
 
(1 row)

SELECT * FROM test_sort ORDER BY NLSSORT(name, 'Nls_sort =   ');
   name    
-----------
 Purple
 TBase
 Tencent
 brown
 guangdong
 red
 shenzhen
 yellow
 
(9 rows)

SELECT * FROM test_sort ORDER BY NLSSORT(name, 'Nls_sort =  zh_CN.gb18030 ');
   name    
-----------
 brown
 guangdong
 Purple
 red
 shenzhen
 TBase
 Tencent
 yellow
 
(9 rows)

SELECT * FROM test_sort ORDER BY NLSSORT(name, 'Nls_sort =  wa_BE.iso885915@euro ');
   name    
-----------
 brown
 guangdong
 Purple
 red
 shenzhen
 TBase
 Tencent
 yellow
 
(9 rows)

SELECT * FROM test_sort ORDER BY NLSSORT(name, 'NLS_SORT =  tt_RU.utf8@iqtelif ');
   name    
-----------
 brown
 guangdong
 Purple
 red
 shenzhen
 TBase
 Tencent
 yellow
 
(9 rows)

SELECT * FROM test_sort ORDER BY NLSSORT(name, 'Nls_sortR =  tt_RU.utf8@iqtelif ');
ERROR:  failed to set the requested LC_COLLATE value [Nls_sortR =  tt_RU.utf8@iqtelif]
drop table test_sort;
\c postgres
DROP DATABASE IF EXISTS regression_sort;
ERROR:  database "regression_sort" is being accessed by other users
SET client_encoding to default;
-- test !=- operator
set enable_oracle_compatible = off;
drop table if exists test cascade;
NOTICE:  table "test" does not exist, skipping
create table test(tc1 int);
insert into test values(1),(-1),(null);
insert into test values(2),(-2),(null);
set enable_oracle_compatible = off;
select * from test where tc1 != -1  order by tc1 asc;
 tc1 
-----
  -2
   1
   2
(3 rows)

select * from test where tc1 !=-1  order by tc1 asc;	-- error
ERROR:  operator does not exist: integer !=- integer
LINE 1: select * from test where tc1 !=-1  order by tc1 asc;
                                     ^
HINT:  No operator matches the given name and argument type(s). You might need to add explicit type casts.
select * from test where tc1 <> -1  order by tc1 asc;
 tc1 
-----
  -2
   1
   2
(3 rows)

select * from test where tc1 <>-1  order by tc1 asc;
 tc1 
-----
  -2
   1
   2
(3 rows)

set enable_oracle_compatible to on;
select * from test where tc1 != -1  order by tc1 asc;
 tc1 
-----
  -2
   1
   2
(3 rows)

select * from test where tc1 !=-1  order by tc1 asc;
 tc1 
-----
  -2
   1
   2
(3 rows)

select * from test where tc1 <> -1  order by tc1 asc;
 tc1 
-----
  -2
   1
   2
(3 rows)

select * from test where tc1 <>-1  order by tc1 asc;
 tc1 
-----
  -2
   1
   2
(3 rows)

set enable_oracle_compatible = off;
CREATE OPERATOR pg_oracle.!=- (
  LEFTARG   = INTEGER,
  RIGHTARG  = INTEGER,
  PROCEDURE = pg_catalog.int4div
);
set enable_oracle_compatible = off;
select * from test where tc1 != -1  order by tc1 asc;
 tc1 
-----
  -2
   1
   2
(3 rows)

select * from test where tc1 !=-1  order by tc1 asc;
ERROR:  argument of WHERE must be type boolean, not type integer
LINE 1: select * from test where tc1 !=-1  order by tc1 asc;
                                 ^
select * from test where tc1 <> -1  order by tc1 asc;
 tc1 
-----
  -2
   1
   2
(3 rows)

select * from test where tc1 <>-1  order by tc1 asc;
 tc1 
-----
  -2
   1
   2
(3 rows)

set enable_oracle_compatible = on;
select * from test where tc1 != -1  order by tc1 asc;
 tc1 
-----
  -2
   1
   2
(3 rows)

select * from test where tc1 !=-1  order by tc1 asc;
 tc1 
-----
  -2
   1
   2
(3 rows)

select * from test where tc1 <> -1  order by tc1 asc;
 tc1 
-----
  -2
   1
   2
(3 rows)

select * from test where tc1 <>-1  order by tc1 asc;
 tc1 
-----
  -2
   1
   2
(3 rows)

set enable_oracle_compatible = on;
drop operator pg_oracle.!=-(integer, integer);
ERROR:  syntax error at or near "-"
LINE 1: drop operator pg_oracle.!=-(integer, integer);
                                  ^
set enable_oracle_compatible = off;
drop operator pg_oracle.!=-(integer, integer);
set enable_oracle_compatible to on;
CREATE OPERATOR pg_oracle.!=- (
  LEFTARG   = INTEGER,
  RIGHTARG  = INTEGER,
  PROCEDURE = pg_catalog.int4div
);
ERROR:  syntax error at or near "-"
LINE 1: CREATE OPERATOR pg_oracle.!=- (
                                    ^
drop table if exists test cascade;
--test to_date
set enable_oracle_compatible to off;
select to_date('2005-01-01 13:14:20', 'YYYY-MM-DD HH24:MI:SS') from dual;
  to_date   
------------
 01-01-2005
(1 row)

select to_date('2005-01-01 13:14:20') from dual;
         to_date          
--------------------------
 Sat Jan 01 13:14:20 2005
(1 row)

select to_date('2005-01-01 13:14:20', '') from dual;
    to_date    
---------------
 01-01-0001 BC
(1 row)

select to_date('', 'YYYY-MM-DD HH24:MI:SS') from dual;
    to_date    
---------------
 01-01-0001 BC
(1 row)

select to_date('','') from dual;
    to_date    
---------------
 01-01-0001 BC
(1 row)

select to_timestamp('2005-01-01 13:14:20', 'YYYY-MM-DD HH24:MI:SS') from dual;
         to_timestamp         
------------------------------
 Sat Jan 01 13:14:20 2005 PST
(1 row)

select to_timestamp('2005-01-01 13:14:20') from dual;
       to_timestamp       
--------------------------
 Sat Jan 01 13:14:20 2005
(1 row)

select to_timestamp('2005-01-01 13:14:20', '') from dual;
          to_timestamp           
---------------------------------
 Sat Jan 01 00:00:00 0001 PST BC
(1 row)

select to_timestamp('', 'YYYY-MM-DD HH24:MI:SS') from dual;
          to_timestamp           
---------------------------------
 Sat Jan 01 00:00:00 0001 PST BC
(1 row)

select to_timestamp('','') from dual;
          to_timestamp           
---------------------------------
 Sat Jan 01 00:00:00 0001 PST BC
(1 row)

SELECT to_timestamp('10-Sep-02 14:10:10.123000', 'DD-Mon-RR HH24:MI:SS.FF') from dual;
          to_timestamp           
---------------------------------
 Sun Sep 10 14:10:10 0001 PST BC
(1 row)

SELECT to_timestamp('10-Sep-02 14:10:10.123000', 'DD-Mon-YY HH24:MI:SS.FF') from dual;
         to_timestamp         
------------------------------
 Tue Sep 10 14:10:10 2002 PDT
(1 row)

set enable_oracle_compatible to on;
select to_date('2005-01-01 13:14:20', 'YYYY-MM-DD HH24:MI:SS') from dual;
         to_date          
--------------------------
 Sat Jan 01 13:14:20 2005
(1 row)

select to_date('2005-01-01 13:14:20') from dual;
         to_date          
--------------------------
 Sat Jan 01 13:14:20 2005
(1 row)

select to_date('2005-01-01 13:14:20', '') from dual;
 to_date 
---------
 
(1 row)

select to_date('', 'YYYY-MM-DD HH24:MI:SS') from dual;
 to_date 
---------
 
(1 row)

select to_date('','') from dual;
 to_date 
---------
 
(1 row)

select to_timestamp('2005-01-01 13:14:20', 'YYYY-MM-DD HH24:MI:SS') from dual;
       to_timestamp       
--------------------------
 Sat Jan 01 13:14:20 2005
(1 row)

select to_timestamp('2005-01-01 13:14:20') from dual;
       to_timestamp       
--------------------------
 Sat Jan 01 13:14:20 2005
(1 row)

select to_timestamp('2005-01-01 13:14:20', '') from dual;
 to_timestamp 
--------------
 
(1 row)

select to_timestamp('', 'YYYY-MM-DD HH24:MI:SS') from dual;
 to_timestamp 
--------------
 
(1 row)

select to_timestamp('','') from dual;
 to_timestamp 
--------------
 
(1 row)

SELECT to_timestamp('10-Sep-02 14:10:10.123000', 'DD-Mon-RR HH24:MI:SS.FF') from dual;
        to_timestamp         
-----------------------------
 Sun Sep 10 14:10:10 0001 BC
(1 row)

SELECT to_timestamp('10-Sep-02 14:10:10.123000', 'DD-Mon-YY HH24:MI:SS.FF') from dual;
       to_timestamp       
--------------------------
 Tue Sep 10 14:10:10 2002
(1 row)

select TO_TIMESTAMP_TZ('2005-01-01 13:14:20', 'YYYY-MM-DD HH24:MI:SS') from dual;
       to_timestamp_tz        
------------------------------
 Sat Jan 01 13:14:20 2005 PST
(1 row)

select TO_TIMESTAMP_TZ('2005-01-01 13:14:20') from dual;
       to_timestamp_tz        
------------------------------
 Sat Jan 01 13:14:20 2005 PST
(1 row)

select TO_TIMESTAMP_TZ('2005-01-01 13:14:20', '') from dual;
 to_timestamp_tz 
-----------------
 
(1 row)

select TO_TIMESTAMP_TZ('', 'YYYY-MM-DD HH24:MI:SS') from dual;
 to_timestamp_tz 
-----------------
 
(1 row)

select TO_TIMESTAMP_TZ('','') from dual;
 to_timestamp_tz 
-----------------
 
(1 row)

SELECT TO_TIMESTAMP_TZ('1999-12-01 11:00:00 -8:00', 'YYYY-MM-DD HH:MI:SS TZH:TZM') FROM DUAL;
ERROR:  formatting field "TZ" is only supported in to_char
SELECT TO_TIMESTAMP_TZ('10-Sep-02 14:10:10.123000', 'DD-Mon-YY HH24:MI:SS.FF') from dual;
       to_timestamp_tz        
------------------------------
 Tue Sep 10 14:10:10 2002 PDT
(1 row)

set enable_oracle_compatible to on;
SET datestyle TO ISO;
set intervalstyle to sql_standard;
select to_date('2017-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') + 365000 from dual;
      ?column?       
---------------------
 3017-04-06 10:00:00
(1 row)

select to_date('2017-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') + 0.365000 from dual;
      ?column?       
---------------------
 2017-12-04 18:45:36
(1 row)

select to_date('2017-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') + -365000 from dual;
      ?column?       
---------------------
 1018-08-04 10:00:00
(1 row)

select to_date('2017-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') - 365000 from dual;
      ?column?       
---------------------
 1018-08-04 10:00:00
(1 row)

select to_date('2017-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') - 0.365000 from dual;
      ?column?       
---------------------
 2017-12-04 01:14:25
(1 row)

select to_date('2017-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') - -365000 from dual;
      ?column?       
---------------------
 3017-04-06 10:00:00
(1 row)

select to_date('2017-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') + 1/24/60 from dual;
      ?column?       
---------------------
 2017-12-04 10:01:00
(1 row)

select to_date('2017-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') - 1/24/60 from dual;
      ?column?       
---------------------
 2017-12-04 09:59:00
(1 row)

select to_date('2017-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') + 365.0 from dual;
      ?column?       
---------------------
 2018-12-04 10:00:00
(1 row)

select to_date('2017-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') - 365.0 from dual;
      ?column?       
---------------------
 2016-12-04 10:00:00
(1 row)

select to_date('2017-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') + 0.466757686856445 from dual;
      ?column?       
---------------------
 2017-12-04 21:12:07
(1 row)

select to_date('2017-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') - 0.466757686856445 from dual;
      ?column?       
---------------------
 2017-12-03 22:47:53
(1 row)

select to_date('2017-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') - to_date('2017-05-23 09:23:14','yyyy-mm-dd hh24:mi:ss') from dual;
     ?column?     
------------------
 195.025532407407
(1 row)

select to_date('2017-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') - to_date('2017-05-23 09:23:14','yyyy-mm-dd hh24:mi:ss') from dual;
     ?column?     
------------------
 195.025532407407
(1 row)

select to_date('2017-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') - to_date('2022-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') from dual;
 ?column? 
----------
    -1826
(1 row)

select to_date('2017-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') - to_date('2022-12-04 10:00:00','yyyy-mm-dd hh24:mi:ss') from dual;
 ?column? 
----------
    -1826
(1 row)

select to_date(sysdate,'yyyy-mm-dd hh24:mi:ss') - to_date(sysdate,'yyyy-mm-dd hh24:mi:ss') from dual;
 ?column? 
----------
        0
(1 row)

select to_date(current_date,'yyyy-mm-dd hh24:mi:ss') - to_date(current_date,'yyyy-mm-dd hh24:mi:ss') from dual;
 ?column? 
----------
        0
(1 row)

--test add_months
SELECT add_months ('2003-08-01', 3);
       add_months       
------------------------
 2003-11-01 00:00:00-08
(1 row)

SELECT add_months ('2003-08-01', -3);
       add_months       
------------------------
 2003-05-01 00:00:00-07
(1 row)

SELECT add_months ('2003-08-21', -3);
       add_months       
------------------------
 2003-05-21 00:00:00-07
(1 row)

SELECT add_months ('2003-01-31', 1);
       add_months       
------------------------
 2003-02-28 00:00:00-08
(1 row)

SELECT add_months ('2008-02-28', 1);
       add_months       
------------------------
 2008-03-28 00:00:00-07
(1 row)

SELECT add_months ('2008-02-29', 1);
       add_months       
------------------------
 2008-03-31 00:00:00-07
(1 row)

SELECT add_months ('2008-01-31', 12);
       add_months       
------------------------
 2009-01-31 00:00:00-08
(1 row)

SELECT add_months ('2008-01-31', -12);
       add_months       
------------------------
 2007-01-31 00:00:00-08
(1 row)

SELECT add_months ('2008-01-31', 95903);
       add_months       
------------------------
 9999-12-31 00:00:00-08
(1 row)

SELECT add_months ('2008-01-31', -80640);
        add_months         
---------------------------
 4713-01-31 00:00:00-08 BC
(1 row)

SELECT add_months ('03-21-2008',3);
       add_months       
------------------------
 2008-06-21 00:00:00-07
(1 row)

SELECT add_months ('21-MAR-2008',3);
       add_months       
------------------------
 2008-06-21 00:00:00-07
(1 row)

SELECT add_months ('21-MAR-08',3);
       add_months       
------------------------
 2008-06-21 00:00:00-07
(1 row)

SELECT add_months ('2008-MAR-21',3);
       add_months       
------------------------
 2008-06-21 00:00:00-07
(1 row)

SELECT add_months ('March 21,2008',3);
       add_months       
------------------------
 2008-06-21 00:00:00-07
(1 row)

SELECT add_months('03/21/2008',3);
       add_months       
------------------------
 2008-06-21 00:00:00-07
(1 row)

SELECT add_months('20080321',3);
       add_months       
------------------------
 2008-06-21 00:00:00-07
(1 row)

SELECT add_months('080321',3);
       add_months       
------------------------
 2008-06-21 00:00:00-07
(1 row)

SELECT add_months ('2003-08-01 10:12:21', 3);
       add_months       
------------------------
 2003-11-01 10:12:21-08
(1 row)

SELECT add_months ('2003-08-01 10:21:21', -3);
       add_months       
------------------------
 2003-05-01 10:21:21-07
(1 row)

SELECT add_months ('2003-08-21 12:21:21', -3);
       add_months       
------------------------
 2003-05-21 12:21:21-07
(1 row)

SELECT add_months ('2003-01-31 01:12:45', 1);
       add_months       
------------------------
 2003-02-28 01:12:45-08
(1 row)

SELECT add_months ('2008-02-28 02:12:12', 1);
       add_months       
------------------------
 2008-03-28 02:12:12-07
(1 row)

SELECT add_months ('2008-02-29 12:12:12', 1);
       add_months       
------------------------
 2008-03-31 12:12:12-07
(1 row)

SELECT add_months ('2008-01-31 11:11:21', 12);
       add_months       
------------------------
 2009-01-31 11:11:21-08
(1 row)

SELECT add_months ('2008-01-31 11:21:21', -12);
       add_months       
------------------------
 2007-01-31 11:21:21-08
(1 row)

SELECT add_months ('2008-01-31 12:12:12', 95903);
       add_months       
------------------------
 9999-12-31 12:12:12-08
(1 row)

SELECT add_months ('2008-01-31 11:32:12', -80640);
        add_months         
---------------------------
 4713-01-31 11:32:12-08 BC
(1 row)

SELECT add_months ('03-21-2008 08:12:22',3);
       add_months       
------------------------
 2008-06-21 08:12:22-07
(1 row)

SELECT add_months ('21-MAR-2008 06:02:12',3);
       add_months       
------------------------
 2008-06-21 06:02:12-07
(1 row)

SELECT add_months ('21-MAR-08 12:11:22',3);
       add_months       
------------------------
 2008-06-21 12:11:22-07
(1 row)

SELECT add_months ('2008-MAR-21 11:32:43',3);
       add_months       
------------------------
 2008-06-21 11:32:43-07
(1 row)

SELECT add_months ('March 21,2008 12:32:12',3);
       add_months       
------------------------
 2008-06-21 12:32:12-07
(1 row)

SELECT add_months('03/21/2008 12:32:12',3);
       add_months       
------------------------
 2008-06-21 12:32:12-07
(1 row)

SELECT add_months('20080321 123244',3);
       add_months       
------------------------
 2008-06-21 12:32:44-07
(1 row)

SELECT add_months('080321 121212',3);
       add_months       
------------------------
 2008-06-21 12:12:12-07
(1 row)

SELECT add_months('10-Sep-02 14:10:10.123000', 3);
         add_months         
----------------------------
 2002-12-10 14:10:10.123-08
(1 row)

SELECT add_months ('10-Sep-02 14:10:10.123000'::date, 3);
 add_months 
------------
 2002-12-10
(1 row)

SELECT add_months ('10-Sep-02 14:10:10.123000'::timestamp, 3);
       add_months        
-------------------------
 2002-12-10 14:10:10.123
(1 row)

SELECT add_months ('10-Sep-02 14:10:10.123000'::timestamptz, 3);
         add_months         
----------------------------
 2002-12-10 14:10:10.123-08
(1 row)

select add_months(to_date('2016-01-31','YYYY-MM-DD'),1) from dual;
     add_months      
---------------------
 2016-02-29 00:00:00
(1 row)

select add_months(to_date('2016-03-31','YYYY-MM-DD'),1) from dual;
     add_months      
---------------------
 2016-04-30 00:00:00
(1 row)

select add_months(to_date('2016-04-30','YYYY-MM-DD'),1) from dual;
     add_months      
---------------------
 2016-05-31 00:00:00
(1 row)

select add_months(to_date('2016-05-31','YYYY-MM-DD'),1) from dual;
     add_months      
---------------------
 2016-06-30 00:00:00
(1 row)

select add_months(to_date('2016-06-30','YYYY-MM-DD'),1) from dual;
     add_months      
---------------------
 2016-07-31 00:00:00
(1 row)

select add_months(to_date('2016-07-31','YYYY-MM-DD'),1) from dual;
     add_months      
---------------------
 2016-08-31 00:00:00
(1 row)

select add_months(to_date('2016-08-31','YYYY-MM-DD'),1) from dual;
     add_months      
---------------------
 2016-09-30 00:00:00
(1 row)

select add_months(to_date('2016-09-30','YYYY-MM-DD'),1) from dual;
     add_months      
---------------------
 2016-10-31 00:00:00
(1 row)

select add_months(to_date('2016-10-31','YYYY-MM-DD'),1) from dual;
     add_months      
---------------------
 2016-11-30 00:00:00
(1 row)

select add_months(to_date('2016-11-30','YYYY-MM-DD'),1) from dual;
     add_months      
---------------------
 2016-12-31 00:00:00
(1 row)

select add_months(to_date('2016-12-31','YYYY-MM-DD'),1) from dual;
     add_months      
---------------------
 2017-01-31 00:00:00
(1 row)

select add_months(to_date('2017-02-28','YYYY-MM-DD'),1) from dual;
     add_months      
---------------------
 2017-03-31 00:00:00
(1 row)

select add_months(to_date('2016-02-29','YYYY-MM-DD'),1) from dual;
     add_months      
---------------------
 2016-03-31 00:00:00
(1 row)

SELECT pg_catalog.timestamp_pl_interval('2003-08-01 10:12:21', pg_catalog.interval_mul(interval '1 month', 3));
 timestamp_pl_interval 
-----------------------
 2003-11-01 10:12:21
(1 row)

SELECT pg_catalog.timestamptz_pl_interval(TO_TIMESTAMP_TZ('10-Sep-02 14:10:10.123000', 'DD-Mon-YY HH24:MI:SS.FF'), pg_catalog.interval_mul(interval '1 month', 3));
 timestamptz_pl_interval 
-------------------------
 2002-12-10 14:10:10-08
(1 row)

select add_months(to_date('2005-01-01 13:14:20', 'YYYY-MM-DD HH24:MI:SS'), 3) from dual;
     add_months      
---------------------
 2005-04-01 13:14:20
(1 row)

-- test last_day
SELECT last_day(to_date('2003/03/15', 'yyyy/mm/dd'));
      last_day       
---------------------
 2003-03-31 00:00:00
(1 row)

SELECT last_day(to_date('2003/02/03', 'yyyy/mm/dd'));
      last_day       
---------------------
 2003-02-28 00:00:00
(1 row)

SELECT last_day(to_date('2004/02/03', 'yyyy/mm/dd'));
      last_day       
---------------------
 2004-02-29 00:00:00
(1 row)

SELECT last_day('1900-02-01');
        last_day        
------------------------
 1900-02-28 00:00:00-08
(1 row)

SELECT last_day('2000-02-01');
        last_day        
------------------------
 2000-02-29 00:00:00-08
(1 row)

SELECT last_day('2007-02-01');
        last_day        
------------------------
 2007-02-28 00:00:00-08
(1 row)

SELECT last_day('2008-02-01');
        last_day        
------------------------
 2008-02-29 00:00:00-08
(1 row)

SELECT last_day(to_date('2003/03/15 11:12:21', 'yyyy/mm/dd hh:mi:ss'));
      last_day       
---------------------
 2003-03-31 11:12:21
(1 row)

SELECT last_day(to_date('2003/02/03 10:21:32', 'yyyy/mm/dd hh:mi:ss'));
      last_day       
---------------------
 2003-02-28 10:21:32
(1 row)

SELECT last_day(to_date('2004/02/03 11:32:12', 'yyyy/mm/dd hh:mi:ss'));
      last_day       
---------------------
 2004-02-29 11:32:12
(1 row)

SELECT last_day('1900-02-01 12:12:11');
        last_day        
------------------------
 1900-02-28 12:12:11-08
(1 row)

SELECT last_day('2000-02-01 121143');
        last_day        
------------------------
 2000-02-29 12:11:43-08
(1 row)

SELECT last_day('2007-02-01 12:21:33');
        last_day        
------------------------
 2007-02-28 12:21:33-08
(1 row)

SELECT last_day('2008-02-01 121212');
        last_day        
------------------------
 2008-02-29 12:12:12-08
(1 row)

SELECT (pg_catalog.date_trunc('MONTH', '1900-02-01 12:12:11'::timestamp) + INTERVAL '1 MONTH - 1 day' + '1900-02-01 12:12:11'::time)::pg_catalog.timestamp;
      timestamp      
---------------------
 1900-02-28 12:12:11
(1 row)

SELECT (pg_catalog.date_trunc('MONTH', TO_TIMESTAMP_TZ('10-Sep-02 14:10:10.123000', 'DD-Mon-YY HH24:MI:SS.FF')) + INTERVAL '1 MONTH - 1 day' + TO_TIMESTAMP_TZ('10-Sep-02 14:10:10.123000', 'DD-Mon-YY HH24:MI:SS.FF')::time)::pg_catalog.timestamptz;
      timestamptz       
------------------------
 2002-09-30 14:10:10-07
(1 row)

SELECT last_day ('10-Sep-02 14:10:10.123000'::date);
  last_day  
------------
 2002-09-30
(1 row)

SELECT last_day ('10-Sep-02 14:10:10.123000'::timestamp);
        last_day         
-------------------------
 2002-09-30 14:10:10.123
(1 row)

SELECT last_day ('10-Sep-02 14:10:10.123000'::timestamptz);
          last_day          
----------------------------
 2002-09-30 14:10:10.123-07
(1 row)

-- test months_between
SELECT months_between (to_date ('2003/01/01', 'yyyy/mm/dd'), to_date ('2003/03/14', 'yyyy/mm/dd'));
  months_between   
-------------------
 -2.41935483870968
(1 row)

SELECT months_between (to_date ('2003/07/01', 'yyyy/mm/dd'), to_date ('2003/03/14', 'yyyy/mm/dd'));
  months_between  
------------------
 3.58064516129032
(1 row)

SELECT months_between (to_date ('2003/07/02', 'yyyy/mm/dd'), to_date ('2003/07/02', 'yyyy/mm/dd'));
 months_between 
----------------
              0
(1 row)

SELECT months_between (to_date ('2003/08/02', 'yyyy/mm/dd'), to_date ('2003/06/02', 'yyyy/mm/dd'));
 months_between 
----------------
              2
(1 row)

SELECT months_between ('2007-02-28', '2007-04-30');
 months_between 
----------------
             -2
(1 row)

SELECT months_between ('2008-01-31', '2008-02-29');
 months_between 
----------------
             -1
(1 row)

SELECT months_between ('2008-02-29', '2008-03-31');
 months_between 
----------------
             -1
(1 row)

SELECT months_between ('2008-02-29', '2008-04-30');
 months_between 
----------------
             -2
(1 row)

SELECT trunc(months_between('21-feb-2008', '2008-02-29'));
 trunc 
-------
     0
(1 row)

SELECT months_between (to_date ('2003/01/01 12:12:12', 'yyyy/mm/dd h24:mi:ss'), to_date ('2003/03/14 11:11:11', 'yyyy/mm/dd h24:mi:ss'));
  months_between   
-------------------
 -2.41935483870968
(1 row)

SELECT months_between (to_date ('2003/07/01 10:11:11', 'yyyy/mm/dd h24:mi:ss'), to_date ('2003/03/14 10:12:12', 'yyyy/mm/dd h24:mi:ss'));
  months_between  
------------------
 3.58064516129032
(1 row)

SELECT months_between (to_date ('2003/07/02 11:21:21', 'yyyy/mm/dd h24:mi:ss'), to_date ('2003/07/02 11:11:11', 'yyyy/mm/dd h24:mi:ss'));
 months_between 
----------------
              0
(1 row)

SELECT months_between (to_timestamp ('2003/08/02 10:11:12', 'yyyy/mm/dd h24:mi:ss'), to_date ('2003/06/02 10:10:11', 'yyyy/mm/dd h24:mi:ss'));
 months_between 
----------------
              2
(1 row)

SELECT months_between ('2007-02-28 111111', '2007-04-30 112121');
 months_between 
----------------
             -2
(1 row)

SELECT months_between ('2008-01-31 11:32:11', '2008-02-29 11:12:12');
 months_between 
----------------
             -1
(1 row)

SELECT months_between ('2008-02-29 10:11:13', '2008-03-31 10:12:11' );
 months_between 
----------------
             -1
(1 row)

SELECT months_between ('2008-02-29 111111', '2008-04-30 12:12:12');
 months_between 
----------------
             -2
(1 row)

SELECT trunc(months_between('21-feb-2008 12:11:11', '2008-02-29 11:11:11'));
 trunc 
-------
     0
(1 row)

SELECT months_between ( last_day ('10-Sep-02 14:10:10.123000'::date), add_months ('10-Sep-02 14:10:10.123000'::date, 3));
  months_between   
-------------------
 -2.35483870967742
(1 row)

SELECT months_between ( last_day ('10-Sep-02 14:10:10.123000'::timestamp), add_months ('10-Sep-02 14:10:10.123000'::timestamp, 3));
  months_between   
-------------------
 -2.35483870967742
(1 row)

SELECT months_between ( last_day ('10-Sep-02 14:10:10.123000'::timestamptz), add_months ('10-Sep-02 14:10:10.123000'::timestamptz, 3));
  months_between   
-------------------
 -2.35483870967742
(1 row)

-- test next_day
SELECT next_day ('2003-08-01', 'TUESDAY');
        next_day        
------------------------
 2003-08-05 00:00:00-07
(1 row)

SELECT next_day ('2003-08-06', 'WEDNESDAY');
        next_day        
------------------------
 2003-08-13 00:00:00-07
(1 row)

SELECT next_day ('2003-08-06', 'SUNDAY');
        next_day        
------------------------
 2003-08-10 00:00:00-07
(1 row)

SELECT next_day ('2008-01-01', 'sun');
        next_day        
------------------------
 2008-01-06 00:00:00-08
(1 row)

SELECT next_day ('2008-01-01', 'sunAAA');
        next_day        
------------------------
 2008-01-06 00:00:00-08
(1 row)

SELECT next_day ('2008-01-01', 1);
        next_day        
------------------------
 2008-01-06 00:00:00-08
(1 row)

SELECT next_day ('2008-01-01', 7);
        next_day        
------------------------
 2008-01-05 00:00:00-08
(1 row)

SELECT next_day ('2003-08-01 111211', 'TUESDAY');
        next_day        
------------------------
 2003-08-05 11:12:11-07
(1 row)

SELECT next_day ('2003-08-06 10:11:43', 'WEDNESDAY');
        next_day        
------------------------
 2003-08-13 10:11:43-07
(1 row)

SELECT next_day ('2003-08-06 11:21:21', 'SUNDAY');
        next_day        
------------------------
 2003-08-10 11:21:21-07
(1 row)

SELECT next_day ('2008-01-01 111343', 'sun');
        next_day        
------------------------
 2008-01-06 11:13:43-08
(1 row)

SELECT next_day ('2008-01-01 121212', 'sunAAA');
        next_day        
------------------------
 2008-01-06 12:12:12-08
(1 row)

SELECT next_day ('2008-01-01 111213', 1);
        next_day        
------------------------
 2008-01-06 11:12:13-08
(1 row)

SELECT next_day ('2008-01-01 11:12:13', 7);
        next_day        
------------------------
 2008-01-05 11:12:13-08
(1 row)

SELECT (pg_oracle.next_day('2003-08-06 10:11:43'::pg_catalog.date, 'WEDNESDAY') + '2003-08-06 10:11:43'::time)::pg_catalog.timestamp;
      timestamp      
---------------------
 2003-08-13 10:11:43
(1 row)

SELECT (pg_oracle.next_day(TO_TIMESTAMP_TZ('10-Sep-02 14:10:10.123000', 'DD-Mon-YY HH24:MI:SS.FF')::pg_catalog.date, 'WEDNESDAY') + TO_TIMESTAMP_TZ('10-Sep-02 14:10:10.123000', 'DD-Mon-YY HH24:MI:SS.FF')::timetz)::pg_catalog.timestamptz;
      timestamptz       
------------------------
 2002-09-11 14:10:10-07
(1 row)

select next_day(to_date('01-Aug-03', 'DD-MON-YY'), 'TUESDAY')  =  to_date ('05-Aug-03', 'DD-MON-YY');
 ?column? 
----------
 t
(1 row)

select next_day(to_date('06-Aug-03', 'DD-MON-YY'), 'WEDNESDAY') =  to_date ('13-Aug-03', 'DD-MON-YY');
 ?column? 
----------
 t
(1 row)

select next_day(to_date('06-Aug-03', 'DD-MON-YY'), 'SUNDAY')  =  to_date ('10-Aug-03', 'DD-MON-YY');
 ?column? 
----------
 t
(1 row)

select next_day(to_date('01-Aug-03 101111', 'DD-MON-YY h24miss'), 'TUESDAY') = to_date ('05-Aug-03 101111', 'DD-MON-YY h24miss');
 ?column? 
----------
 t
(1 row)

select next_day(to_date('06-Aug-03 10:12:13', 'DD-MON-YY H24:MI:SS'), 'WEDNESDAY') = to_date ('13-Aug-03 10:12:13', 'DD-MON-YY H24:MI:SS');
 ?column? 
----------
 t
(1 row)

select next_day(to_date('06-Aug-03 11:11:11', 'DD-MON-YY HH:MI:SS'), 'SUNDAY') = to_date ('10-Aug-03 11:11:11', 'DD-MON-YY HH:MI:SS');
 ?column? 
----------
 t
(1 row)

SELECT next_day ('10-Sep-02 14:10:10.123000'::date, 4), next_day ('10-Sep-02 14:10:10.123000'::date, 'WEDNESDAY');
  next_day  |  next_day  
------------+------------
 2002-09-11 | 2002-09-11
(1 row)

SELECT next_day ('10-Sep-02 14:10:10.123000'::timestamp, 4), next_day ('10-Sep-02 14:10:10.123000'::timestamp, 'WEDNESDAY');
        next_day         |        next_day         
-------------------------+-------------------------
 2002-09-11 14:10:10.123 | 2002-09-11 14:10:10.123
(1 row)

SELECT next_day ('10-Sep-02 14:10:10.123000'::timestamptz, 4), next_day ('10-Sep-02 14:10:10.123000'::timestamptz, 'WEDNESDAY');
          next_day          |          next_day          
----------------------------+----------------------------
 2002-09-11 14:10:10.123-07 | 2002-09-11 14:10:10.123-07
(1 row)

select next_day('2013-08-01', 'TUESDAY') - next_day('2003-08-01', 'TUESDAY') from dual;
 ?column? 
----------
     3654
(1 row)

select to_date('2013-08-01 11:21:22', 'yyyy-mm-dd hh24:mi:ss') - next_day('2013-08-01', 'TUESDAY') from dual; 
     ?column?     
------------------
 -4.5268287037037
(1 row)

-- test round
select round(TIMESTAMP WITH TIME ZONE'12/08/1990 05:35:25','YEAR') = '1991-01-01 00:00:00';
 ?column? 
----------
 t
(1 row)

select round(TIMESTAMP WITH TIME ZONE'05/08/1990 05:35:25','Q') = '1990-04-01 00:00:00';
 ?column? 
----------
 t
(1 row)

select round(TIMESTAMP WITH TIME ZONE'12/08/1990 05:35:25','MONTH') = '1990-12-01 00:00:00';
 ?column? 
----------
 t
(1 row)

select round(TIMESTAMP WITH TIME ZONE'12/08/1990 05:35:25','DDD') = '1990-12-08 00:00:00';
 ?column? 
----------
 t
(1 row)

select round(TIMESTAMP WITH TIME ZONE'12/08/1990 05:35:25','DAY') = '1990-12-09 00:00:00';
 ?column? 
----------
 t
(1 row)

select round(TIMESTAMP WITH TIME ZONE'12/08/1990 05:35:25','hh') = '1990-12-08 06:00:00';
 ?column? 
----------
 t
(1 row)

select round(TIMESTAMP WITH TIME ZONE'12/08/1990 05:35:25','mi') = '1990-12-08 05:35:00';
 ?column? 
----------
 t
(1 row)

select round(to_date ('22-AUG-03', 'DD-MON-YY'),'YEAR')  =  to_date ('01-JAN-04', 'DD-MON-YY');
 ?column? 
----------
 t
(1 row)

select round(to_date ('22-AUG-03', 'DD-MON-YY'),'Q')  =  to_date ('01-OCT-03', 'DD-MON-YY');
 ?column? 
----------
 t
(1 row)

select round(to_date ('22-AUG-03', 'DD-MON-YY'),'MONTH') =  to_date ('01-SEP-03', 'DD-MON-YY');
 ?column? 
----------
 t
(1 row)

select round(to_date ('22-AUG-03', 'DD-MON-YY'),'DDD')  =  to_date ('22-AUG-03', 'DD-MON-YY');
 ?column? 
----------
 t
(1 row)

select round(to_date ('22-AUG-03', 'DD-MON-YY'),'DAY')  =  to_date ('24-AUG-03', 'DD-MON-YY');
 ?column? 
----------
 t
(1 row)

SELECT round(to_date('210514 12:13:44','DDMMYY HH24:MI:SS'));
        round        
---------------------
 2014-05-22 00:00:00
(1 row)

SELECT round(1.234::double precision, 2), trunc(1.234::double precision, 2);
 round | trunc 
-------+-------
  1.23 |  1.23
(1 row)

SELECT round(1.234::float, 2), trunc(1.234::float, 2);
 round | trunc 
-------+-------
  1.23 |  1.23
(1 row)

SELECT round(1.234::double precision), trunc(1.234::double precision);
 round | trunc 
-------+-------
     1 |     1
(1 row)

SELECT round(1.234::float), trunc(1.234::float);
 round | trunc 
-------+-------
     1 |     1
(1 row)

SELECT round ('10-Sep-02 14:10:10.123000'::date);
   round    
------------
 2002-09-10
(1 row)

SELECT round ('10-Sep-02 14:10:10.123000'::timestamp);
          round          
-------------------------
 2002-09-11 00:00:00.123
(1 row)

SELECT round ('10-Sep-02 14:10:10.123000'::timestamptz);
           round            
----------------------------
 2002-09-11 00:00:00.123-07
(1 row)

SELECT round ('10-Sep-02 14:10:10.123000'::date, 'MONTH');
   round    
------------
 2002-09-01
(1 row)

SELECT round ('10-Sep-02 14:10:10.123000'::timestamp, 'MONTH');
          round          
-------------------------
 2002-09-01 00:00:00.123
(1 row)

SELECT round ('10-Sep-02 14:10:10.123000'::timestamptz, 'MONTH');
           round            
----------------------------
 2002-09-01 00:00:00.123-07
(1 row)

-- test trunc
SELECT trunc(to_date('210514 12:13:44','DDMMYY HH24:MI:SS'));
        trunc        
---------------------
 2014-05-21 00:00:00
(1 row)

select trunc(to_date('22-AUG-03', 'DD-MON-YY'), 'YEAR')  =  to_date ('01-JAN-03', 'DD-MON-YY');
 ?column? 
----------
 t
(1 row)

select trunc(to_date('22-AUG-03', 'DD-MON-YY'), 'Q')  =  to_date ('01-JUL-03', 'DD-MON-YY');
 ?column? 
----------
 t
(1 row)

select trunc(to_date('22-AUG-03', 'DD-MON-YY'), 'MONTH') =  to_date ('01-AUG-03', 'DD-MON-YY');
 ?column? 
----------
 t
(1 row)

select trunc(to_date('22-AUG-03', 'DD-MON-YY'), 'DDD')  =  to_date ('22-AUG-03', 'DD-MON-YY');
 ?column? 
----------
 t
(1 row)

select trunc(to_date('22-AUG-03', 'DD-MON-YY'), 'DAY')  =  to_date ('17-AUG-03', 'DD-MON-YY');
 ?column? 
----------
 t
(1 row)

select trunc(TIMESTAMP WITH TIME ZONE '2004-10-19 10:23:54+02','YEAR') = '2004-01-01 00:00:00-08';
 ?column? 
----------
 t
(1 row)

select trunc(TIMESTAMP WITH TIME ZONE '2004-10-19 10:23:54+02','Q') = '2004-10-01 00:00:00-07';
 ?column? 
----------
 t
(1 row)

select trunc(TIMESTAMP WITH TIME ZONE '2004-10-19 10:23:54+02','MONTH') = '2004-10-01 00:00:00-07';
 ?column? 
----------
 t
(1 row)

select trunc(TIMESTAMP WITH TIME ZONE '2004-10-19 10:23:54+02','DDD') = '2004-10-19 00:00:00-07';
 ?column? 
----------
 t
(1 row)

select trunc(TIMESTAMP WITH TIME ZONE '2004-10-19 10:23:54+02','DAY') = '2004-10-17 00:00:00-07';
 ?column? 
----------
 t
(1 row)

select trunc(TIMESTAMP WITH TIME ZONE '2004-10-19 10:23:54+02','HH') = '2004-10-19 01:00:00-07';
 ?column? 
----------
 t
(1 row)

select trunc(TIMESTAMP WITH TIME ZONE '2004-10-19 10:23:54+02','MI') = '2004-10-19 01:23:00-07';
 ?column? 
----------
 t
(1 row)

SELECT trunc ('10-Sep-02 14:10:10.123000'::date);
   trunc    
------------
 2002-09-10
(1 row)

SELECT trunc ('10-Sep-02 14:10:10.123000'::timestamp);
        trunc        
---------------------
 2002-09-10 00:00:00
(1 row)

SELECT trunc ('10-Sep-02 14:10:10.123000'::timestamptz);
         trunc          
------------------------
 2002-09-10 00:00:00-07
(1 row)

SELECT trunc ('10-Sep-02 14:10:10.123000'::date, 'MONTH');
   trunc    
------------
 2002-09-01
(1 row)

SELECT trunc ('10-Sep-02 14:10:10.123000'::timestamp, 'MONTH');
        trunc        
---------------------
 2002-09-01 00:00:00
(1 row)

SELECT trunc ('10-Sep-02 14:10:10.123000'::timestamptz, 'MONTH');
         trunc          
------------------------
 2002-09-01 00:00:00-07
(1 row)

-- test numtoyminterval
select numtoyminterval(100, 'year') from dual;
 numtoyminterval 
-----------------
 100-0
(1 row)

select numtoyminterval(100, 'month') from dual;
 numtoyminterval 
-----------------
 8-4
(1 row)

select numtoyminterval(100, 'day') from dual;
ERROR:  Invalid interval unit for function "numtoyminterval": 'day'
HINT:  Valid interval unit can be 'YEAR' or 'MONTH', case-insensitive.
select numtoyminterval(100, 'hour') from dual;
ERROR:  Invalid interval unit for function "numtoyminterval": 'hour'
HINT:  Valid interval unit can be 'YEAR' or 'MONTH', case-insensitive.
select numtoyminterval(100, 'minute') from dual;
ERROR:  Invalid interval unit for function "numtoyminterval": 'minute'
HINT:  Valid interval unit can be 'YEAR' or 'MONTH', case-insensitive.
select numtoyminterval(100, 'second') from dual;
ERROR:  Invalid interval unit for function "numtoyminterval": 'second'
HINT:  Valid interval unit can be 'YEAR' or 'MONTH', case-insensitive.
select numtoyminterval(0.45, 'year') from dual;
 numtoyminterval 
-----------------
 0-5
(1 row)

select numtoyminterval(0.36, 'month') from dual;
 numtoyminterval 
-----------------
 10 19:12:00
(1 row)

select numtoyminterval(12.254, 'month') from dual;
  numtoyminterval  
-------------------
 +1-0 +7 +14:52:48
(1 row)

select numtoyminterval(-0.45, 'year') from dual;
 numtoyminterval 
-----------------
 -0-5
(1 row)

select numtoyminterval(-0.36, 'month') from dual;
 numtoyminterval 
-----------------
 -10 19:12:00
(1 row)

-- test numtodsinterval
select numtodsinterval(100, 'year') from dual;
ERROR:  Invalid interval unit for function "numtodsinterval": 'year'
HINT:  Valid interval unit can be 'DAY', 'HOUR', 'MINUTE' or 'SECOND', case-insensitive.
select numtodsinterval(100, 'month') from dual;
ERROR:  Invalid interval unit for function "numtodsinterval": 'month'
HINT:  Valid interval unit can be 'DAY', 'HOUR', 'MINUTE' or 'SECOND', case-insensitive.
select numtodsinterval(100, 'day') from dual;
 numtodsinterval 
-----------------
 100 0:00:00
(1 row)

select numtodsinterval(100, 'hour') from dual;
 numtodsinterval 
-----------------
 4 4:00:00
(1 row)

select numtodsinterval(100, 'minute') from dual;
 numtodsinterval 
-----------------
 1:40:00
(1 row)

select numtodsinterval(100, 'second') from dual;
 numtodsinterval 
-----------------
 0:01:40
(1 row)

select numtodsinterval(120,'hour') from dual;
 numtodsinterval 
-----------------
 5 0:00:00
(1 row)

select numtodsinterval(60,'hour') from dual;
 numtodsinterval 
-----------------
 2 12:00:00
(1 row)

select numtodsinterval(30,'hour') from dual;
 numtodsinterval 
-----------------
 1 6:00:00
(1 row)

select numtodsinterval(24,'hour') from dual;
 numtodsinterval 
-----------------
 1 0:00:00
(1 row)

select numtodsinterval(23,'hour') from dual;
 numtodsinterval 
-----------------
 23:00:00
(1 row)

select numtodsinterval(120,'day') from dual;
 numtodsinterval 
-----------------
 120 0:00:00
(1 row)

select numtodsinterval(120,'minute') from dual;
 numtodsinterval 
-----------------
 2:00:00
(1 row)

select numtodsinterval(120,'second') from dual;
 numtodsinterval 
-----------------
 0:02:00
(1 row)

select numtodsinterval(-120.45,'day') from dual;
 numtodsinterval 
-----------------
 -120 10:48:00
(1 row)

select numtodsinterval(120.39,'day') from dual;
 numtodsinterval 
-----------------
 120 9:21:36
(1 row)

select numtodsinterval(-48.34,'hour') from dual;
 numtodsinterval 
-----------------
 -2 0:20:24
(1 row)

select numtodsinterval(48.34,'hour') from dual;
 numtodsinterval 
-----------------
 2 0:20:24
(1 row)

select numtodsinterval(-120.59,'minute') from dual;
 numtodsinterval 
-----------------
 -2:00:35.4
(1 row)

select numtodsinterval(120.59,'minute') from dual;
 numtodsinterval 
-----------------
 2:00:35.4
(1 row)

select numtodsinterval(-120.59,'second') from dual;
 numtodsinterval 
-----------------
 -0:02:00.59
(1 row)

select numtodsinterval(120.59,'second') from dual;
 numtodsinterval 
-----------------
 0:02:00.59
(1 row)

select numtodsinterval(100/3,'minute') from dual;
 numtodsinterval 
-----------------
 0:33:20
(1 row)

select numtodsinterval(0.1,'day') from dual;
 numtodsinterval 
-----------------
 2:24:00
(1 row)

select numtodsinterval(0.1,'hour') from dual;
 numtodsinterval 
-----------------
 0:06:00
(1 row)

select numtodsinterval(0.1,'minute') from dual;
 numtodsinterval 
-----------------
 0:00:06
(1 row)

select numtodsinterval(0.1,'second') from dual;
 numtodsinterval 
-----------------
 0:00:00.1
(1 row)

select numtodsinterval(1.1,'day') from dual;
 numtodsinterval 
-----------------
 1 2:24:00
(1 row)

select numtodsinterval(1.1,'hour') from dual;
 numtodsinterval 
-----------------
 1:06:00
(1 row)

select numtodsinterval(1.1,'minute') from dual;
 numtodsinterval 
-----------------
 0:01:06
(1 row)

select numtodsinterval(1.1,'second') from dual;
 numtodsinterval 
-----------------
 0:00:01.1
(1 row)

-- test to_yminterval
select TO_YMINTERVAL('01-02') "14 months" from dual;
 14 months 
-----------
 1-2
(1 row)

select TO_YMINTERVAL('P1Y2M') from dual;
 to_yminterval 
---------------
 1-2
(1 row)

-- test to_dsinterval
select TO_DSINTERVAL('100 00:00:00') from dual;
 to_dsinterval 
---------------
 100 0:00:00
(1 row)

select TO_DSINTERVAL('P100DT05H') from dual;
 to_dsinterval 
---------------
 100 5:00:00
(1 row)

select to_dsinterval('99999999 23:59:59') from dual;
   to_dsinterval   
-------------------
 99999999 23:59:59
(1 row)

select to_dsinterval('999999999 23:59:59') from dual;
   to_dsinterval    
--------------------
 999999999 23:59:59
(1 row)

select to_dsinterval('1000000000 23:59:59') from dual;
    to_dsinterval    
---------------------
 1000000000 23:59:59
(1 row)

select to_dsinterval('0 23:59:59') from dual;
 to_dsinterval 
---------------
 23:59:59
(1 row)

select to_dsinterval('-1 23:59:59') from dual;
 to_dsinterval 
---------------
 -1 23:59:59
(1 row)

select to_dsinterval('-999999999 23:59:59') from dual;
    to_dsinterval    
---------------------
 -999999999 23:59:59
(1 row)

select to_dsinterval('100 24:00:00') from dual;
 to_dsinterval 
---------------
 101 0:00:00
(1 row)

select to_dsinterval('100 25:00:00') from dual;
 to_dsinterval 
---------------
 101 1:00:00
(1 row)

select to_dsinterval('100 11:60:00') from dual;
ERROR:  interval field value out of range: "100 11:60:00"
select to_dsinterval('100 11:00:60') from dual;
 to_dsinterval 
---------------
 100 11:01:00
(1 row)

select to_dsinterval('95 18:30:00') * 3 from dual;
  ?column?   
-------------
 287 7:30:00
(1 row)

select to_dsinterval('95 18:30:00') * 1 from dual;
  ?column?   
-------------
 95 18:30:00
(1 row)

select to_dsinterval('95 18:30:00') * 1.5 from dual;
   ?column?   
--------------
 143 15:45:00
(1 row)

select to_dsinterval('95 18:30:00') * 3.5 from dual;
  ?column?   
-------------
 335 4:45:00
(1 row)

select to_dsinterval('95 18:30:00') * -3 from dual;
   ?column?   
--------------
 -287 7:30:00
(1 row)

select to_dsinterval('95 18:30:00') * -3.5 from dual;
   ?column?   
--------------
 -335 4:45:00
(1 row)

-- test dbtimezone
--select dbtimezone from dual;
--select dbtimezone() from dual;
-- test sessiontimezone
--select sessiontimezone from dual;
--select sessiontimezone() from dual;
-- test instr
select instr('Tech on the net', 'e') = 2;
 ?column? 
----------
 t
(1 row)

select instr('Tech on the net', 'e', 1, 1) = 2;
 ?column? 
----------
 t
(1 row)

select instr('Tech on the net', 'e', 1, 2) = 11;
 ?column? 
----------
 t
(1 row)

select instr('Tech on the net', 'e', 1, 3) = 14;
 ?column? 
----------
 t
(1 row)

select instr('Tech on the net', 'e', -3, 2) = 2;
 ?column? 
----------
 t
(1 row)

select instr('abc', NULL) IS NULL;
 ?column? 
----------
 t
(1 row)

select instr('abc', '') IS NULL;
 ?column? 
----------
 t
(1 row)

select instr('', 'a') IS NULL;
 ?column? 
----------
 t
(1 row)

select 1 = instr('abc', 'a');
 ?column? 
----------
 t
(1 row)

select 3 = instr('abc', 'c');
 ?column? 
----------
 t
(1 row)

select 0 = instr('abc', 'z');
 ?column? 
----------
 t
(1 row)

select 1 = instr('abcabcabc', 'abca', 1);
 ?column? 
----------
 t
(1 row)

select 4 = instr('abcabcabc', 'abca', 2);
 ?column? 
----------
 t
(1 row)

select 0 = instr('abcabcabc', 'abca', 7);
 ?column? 
----------
 t
(1 row)

select 0 = instr('abcabcabc', 'abca', 9);
 ?column? 
----------
 t
(1 row)

select 4 = instr('abcabcabc', 'abca', -1);
 ?column? 
----------
 t
(1 row)

select 1 = instr('abcabcabc', 'abca', -8);
 ?column? 
----------
 t
(1 row)

select 1 = instr('abcabcabc', 'abca', -9);
 ?column? 
----------
 t
(1 row)

select 0 = instr('abcabcabc', 'abca', -10);
 ?column? 
----------
 t
(1 row)

select 1 = instr('abcabcabc', 'abca', 1, 1);
 ?column? 
----------
 t
(1 row)

select 4 = instr('abcabcabc', 'abca', 1, 2);
 ?column? 
----------
 t
(1 row)

select 0 = instr('abcabcabc', 'abca', 1, 3);
 ?column? 
----------
 t
(1 row)

--test to_char
select to_char(22);
 to_char 
---------
 22
(1 row)

select to_char(99::smallint);
 to_char 
---------
 99
(1 row)

select to_char(-44444);
 to_char 
---------
 -44444
(1 row)

select to_char(1234567890123456::bigint);
     to_char      
------------------
 1234567890123456
(1 row)

select to_char(123.456::real);
 to_char 
---------
 123.456
(1 row)

select to_char(1234.5678::double precision);
  to_char  
-----------
 1234.5678
(1 row)

select to_char(12345678901234567890::numeric);
       to_char        
----------------------
 12345678901234567890
(1 row)

select to_char(1234567890.12345);
     to_char      
------------------
 1234567890.12345
(1 row)

select to_char('4.00'::numeric);
 to_char 
---------
 4.00
(1 row)

select to_char('4.0010'::numeric);
 to_char 
---------
 4.0010
(1 row)

SET nls_date_format to '';
select pg_oracle.to_char(to_date('19-APR-16 21:41:48'));
          to_char           
----------------------------
 2016-04-19 21:41:48.000000
(1 row)

set nls_date_format='YY-MonDD HH24:MI:SS';
select pg_oracle.to_char(to_date('14-Jan08 11:44:49+05:30'));
          to_char           
----------------------------
 2014-01-08 11:44:49.000000
(1 row)

set nls_date_format='YY-DDMon HH24:MI:SS';
select pg_oracle.to_char(to_date('14-08Jan 11:44:49+05:30'));
          to_char           
----------------------------
 2014-01-08 11:44:49.000000
(1 row)

set nls_date_format='DDMMYYYY HH24:MI:SS';
select pg_oracle.to_char(to_date('21052014 12:13:44+05:30'));
          to_char           
----------------------------
 2014-05-21 12:13:44.000000
(1 row)

set nls_date_format='DDMMYY HH24:MI:SS';
select pg_oracle.to_char(to_date('210514 12:13:44+05:30'));
          to_char           
----------------------------
 2014-05-21 12:13:44.000000
(1 row)

set nls_date_format='DDMMYYYY HH24:MI:SS';
select pg_oracle.to_char(pg_oracle.to_date('2014/04/25 10:13', 'YYYY/MM/DD HH:MI'));
          to_char           
----------------------------
 2014-04-25 10:13:00.000000
(1 row)

set nls_date_format='YY-DDMon HH24:MI:SS';
select pg_oracle.to_char(pg_oracle.to_date('16-Feb-09 10:11:11', 'DD-Mon-YY HH:MI:SS'));
          to_char           
----------------------------
 2009-02-16 10:11:11.000000
(1 row)

set nls_date_format='YY-DDMon HH24:MI:SS';
select pg_oracle.to_char(pg_oracle.to_date('02/16/09 04:12:12', 'MM/DD/YY HH24:MI:SS'));
          to_char           
----------------------------
 2009-02-16 04:12:12.000000
(1 row)

set nls_date_format='YY-MonDD HH24:MI:SS';
select pg_oracle.to_char(pg_oracle.to_date('021609 111213', 'MMDDYY HHMISS'));
          to_char           
----------------------------
 2009-02-16 11:12:13.000000
(1 row)

set nls_date_format='DDMMYYYY HH24:MI:SS';
select pg_oracle.to_char(pg_oracle.to_date('16-Feb-09 11:12:12', 'DD-Mon-YY HH:MI:SS'));
          to_char           
----------------------------
 2009-02-16 11:12:12.000000
(1 row)

set nls_date_format='DDMMYYYY HH24:MI:SS';
select pg_oracle.to_char(pg_oracle.to_date('Feb/16/09 11:21:23', 'Mon/DD/YY HH:MI:SS'));
          to_char           
----------------------------
 2009-02-16 11:21:23.000000
(1 row)

set nls_date_format='DDMMYYYY HH24:MI:SS';
select pg_oracle.to_char(pg_oracle.to_date('February.16.2009 10:11:12', 'Month.DD.YYYY HH:MI:SS'));
          to_char           
----------------------------
 2009-02-16 10:11:12.000000
(1 row)

set nls_date_format='YY-MonDD HH24:MI:SS';
select pg_oracle.to_char(pg_oracle.to_date('20020315111212', 'yyyymmddhh12miss'));
          to_char           
----------------------------
 2002-03-15 11:12:12.000000
(1 row)

set nls_date_format='DDMMYYYY HH24:MI:SS';
select pg_oracle.to_char(pg_oracle.to_date('January 15, 1989, 11:00 A.M.','Month dd, YYYY, HH:MI A.M.'));
          to_char           
----------------------------
 1989-01-15 11:00:00.000000
(1 row)

set nls_date_format='DDMMYY HH24:MI:SS';
select pg_oracle.to_char(pg_oracle.to_date('14-Jan08 11:44:49+05:30' ,'YY-MonDD HH24:MI:SS'));
          to_char           
----------------------------
 2014-01-08 11:44:49.000000
(1 row)

set nls_date_format='DDMMYYYY HH24:MI:SS';
select pg_oracle.to_char(pg_oracle.to_date('14-08Jan 11:44:49+05:30','YY-DDMon HH24:MI:SS'));
          to_char           
----------------------------
 2014-01-08 11:44:49.000000
(1 row)

set nls_date_format='YY-MonDD HH24:MI:SS';
select pg_oracle.to_char(pg_oracle.to_date('21052014 12:13:44+05:30','DDMMYYYY HH24:MI:SS'));
          to_char           
----------------------------
 2014-05-21 12:13:44.000000
(1 row)

set nls_date_format='DDMMYY HH24:MI:SS';
select pg_oracle.to_char(pg_oracle.to_date('210514 12:13:44+05:30','DDMMYY HH24:MI:SS'));
          to_char           
----------------------------
 2014-05-21 12:13:44.000000
(1 row)

select to_char(TO_YMINTERVAL('01-02')) from dual;
          to_char           
----------------------------
 0001-02-00 00:00:00.000000
(1 row)

select to_char(TO_YMINTERVAL('P1Y2M')) from dual;
          to_char           
----------------------------
 0001-02-00 00:00:00.000000
(1 row)

select to_char(TO_DSINTERVAL('100 00:00:00')) from dual;
           to_char           
-----------------------------
 0000-00-100 00:00:00.000000
(1 row)

select to_char(TO_DSINTERVAL('P100DT05H')) from dual;
           to_char           
-----------------------------
 0000-00-100 05:00:00.000000
(1 row)

--test to_number
SELECT to_number('-34,338,492', '99G999G999') from dual;
 to_number 
-----------
 -34338492
(1 row)

SELECT to_number('-34,338,492.654,878', '99G999G999D999G999') from dual;
    to_number     
------------------
 -34338492.654878
(1 row)

SELECT to_number('<564646.654564>', '999999.999999PR') from dual;
   to_number    
----------------
 -564646.654564
(1 row)

SELECT to_number('0.00001-', '9.999999S') from dual;
 to_number 
-----------
  -0.00001
(1 row)

SELECT to_number('5.01-', 'FM9.999999S') from dual;
 to_number 
-----------
     -5.01
(1 row)

SELECT to_number('5.01-', 'FM9.999999MI') from dual;
 to_number 
-----------
     -5.01
(1 row)

SELECT to_number('5 4 4 4 4 8 . 7 8', '9 9 9 9 9 9 . 9 9') from dual;
 to_number 
-----------
 544448.78
(1 row)

SELECT to_number('.01', 'FM9.99') from dual;
 to_number 
-----------
      0.01
(1 row)

SELECT to_number('.0', '99999999.99999999') from dual;
 to_number 
-----------
       0.0
(1 row)

SELECT to_number('0', '99.99') from dual;
 to_number 
-----------
         0
(1 row)

SELECT to_number('.-01', 'S99.99') from dual;
 to_number 
-----------
     -0.01
(1 row)

SELECT to_number('.01-', '99.99S') from dual;
 to_number 
-----------
     -0.01
(1 row)

SELECT to_number(' . 0 1-', ' 9 9 . 9 9 S') from dual;
 to_number 
-----------
     -0.01
(1 row)

SELECT to_number('-34338492') from dual;
 to_number 
-----------
 -34338492
(1 row)

SELECT to_number('-34338492.654878') from dual;
    to_number     
------------------
 -34338492.654878
(1 row)

SELECT to_number('564646.654564') from dual;
   to_number   
---------------
 564646.654564
(1 row)

SELECT to_number('0.00001') from dual;
 to_number 
-----------
   0.00001
(1 row)

SELECT to_number('5.01') from dual;
 to_number 
-----------
      5.01
(1 row)

SELECT to_number('.01') from dual;
 to_number 
-----------
      0.01
(1 row)

SELECT to_number('.0') from dual;
 to_number 
-----------
       0.0
(1 row)

SELECT to_number('0') from dual;
 to_number 
-----------
         0
(1 row)

SELECT to_number('01') from dual;
 to_number 
-----------
         1
(1 row)

select to_number(123.09e34::float4) from dual;
               to_number               
---------------------------------------
 1230900000000000000000000000000000000
(1 row)

select to_number(1234.094e23::float8) from dual;
          to_number          
-----------------------------
 123409400000000000000000000
(1 row)

SELECT to_number('123'::text);
 to_number 
-----------
       123
(1 row)

SELECT to_number('123.456'::text);
 to_number 
-----------
   123.456
(1 row)

SELECT to_number(123);
 to_number 
-----------
       123
(1 row)

SELECT to_number(123::smallint);
 to_number 
-----------
       123
(1 row)

SELECT to_number(123::int);
 to_number 
-----------
       123
(1 row)

SELECT to_number(123::bigint);
 to_number 
-----------
       123
(1 row)

SELECT to_number(123::numeric);
 to_number 
-----------
       123
(1 row)

SELECT to_number(123.456);
 to_number 
-----------
   123.456
(1 row)

-- test to_multi_byte
-- SELECT to_multi_byte('123$test') from dual;
-- SELECT octet_length('abc') from dual;
-- SELECT octet_length(to_multi_byte('abc')) from dual;
-- testto_single_byte
-- SELECT to_single_byte('123$test') from dual;
-- SELECT to_single_byte('１２３＄ｔｅｓｔ') from dual;
-- SELECT octet_length('ａｂｃ');
-- SELECT octet_length(to_single_byte('ａｂｃ')) from dual;
-- test sinh cosh tanh
SELECT sinh(1.570796), cosh(1.570796), tanh(4);
        sinh         |        cosh         |       tanh        
---------------------+---------------------+-------------------
 2.30129808232069620 | 2.50917772660545390 | 0.999329299739067
(1 row)

SELECT sinh(1.570796::numeric), cosh(1.570796::numeric), tanh(4::numeric);
        sinh         |        cosh         |          tanh          
---------------------+---------------------+------------------------
 2.30129808232069620 | 2.50917772660545390 | 0.99932929973906704380
(1 row)

--test nanvl
SELECT nanvl(12345, 1), nanvl('NaN', 1);
 nanvl | nanvl 
-------+-------
 12345 |     1
(1 row)

SELECT nanvl(12345::float4, 1), nanvl('NaN'::float4, 1);
 nanvl | nanvl 
-------+-------
 12345 |     1
(1 row)

SELECT nanvl(12345::float8, 1), nanvl('NaN'::float8, 1);
 nanvl | nanvl 
-------+-------
 12345 |     1
(1 row)

SELECT nanvl(12345::numeric, 1), nanvl('NaN'::numeric, 1);
 nanvl | nanvl 
-------+-------
 12345 |     1
(1 row)

SELECT nanvl(12345, '1'::varchar), nanvl('NaN', 1::varchar);
 nanvl | nanvl 
-------+-------
 12345 |     1
(1 row)

SELECT nanvl(12345::float4, '1'::varchar), nanvl('NaN'::float4, '1'::varchar);
 nanvl | nanvl 
-------+-------
 12345 |     1
(1 row)

SELECT nanvl(12345::float8, '1'::varchar), nanvl('NaN'::float8, '1'::varchar);
 nanvl | nanvl 
-------+-------
 12345 |     1
(1 row)

SELECT nanvl(12345::numeric, '1'::varchar), nanvl('NaN'::numeric, '1'::varchar);
 nanvl | nanvl 
-------+-------
 12345 |     1
(1 row)

SELECT nanvl(12345, '1'::char), nanvl('NaN', 1::char);
 nanvl | nanvl 
-------+-------
 12345 |     1
(1 row)

SELECT nanvl(12345::float4, '1'::char), nanvl('NaN'::float4, '1'::char);
 nanvl | nanvl 
-------+-------
 12345 |     1
(1 row)

SELECT nanvl(12345::float8, '1'::char), nanvl('NaN'::float8, '1'::char);
 nanvl | nanvl 
-------+-------
 12345 |     1
(1 row)

SELECT nanvl(12345::numeric, '1'::char), nanvl('NaN'::numeric, '1'::char);
 nanvl | nanvl 
-------+-------
 12345 |     1
(1 row)

--test nvl
select nvl('A'::text, 'B');
 nvl 
-----
 A
(1 row)

select nvl(NULL::text, 'B');
 nvl 
-----
 B
(1 row)

select nvl(NULL::text, NULL);
 nvl 
-----
 
(1 row)

select nvl(1, 2);
 nvl 
-----
   1
(1 row)

select nvl(NULL, 2);
 nvl 
-----
   2
(1 row)

--test nvl2
select nvl2('A'::text, 'B', 'C');
 nvl2 
------
 B
(1 row)

select nvl2(NULL::text, 'B', 'C');
 nvl2 
------
 C
(1 row)

select nvl2('A'::text, NULL, 'C');
 nvl2 
------
 
(1 row)

select nvl2(NULL::text, 'B', NULL);
 nvl2 
------
 
(1 row)

select nvl2(1, 2, 3);
 nvl2 
------
    2
(1 row)

select nvl2(NULL, 2, 3);
 nvl2 
------
    3
(1 row)

-- test lnnvl
select lnnvl(true);
 lnnvl 
-------
 f
(1 row)

select lnnvl(false);
 lnnvl 
-------
 t
(1 row)

select lnnvl(NULL);
 lnnvl 
-------
 t
(1 row)

set enable_oracle_compatible to on;
-- test dump
SELECT dump('Yellow dog'::text) ~ E'^Typ=25 Len=(\\d+): \\d+(,\\d+)*$' AS t;
 t 
---
 t
(1 row)

SELECT dump('Yellow dog'::text, 10) ~ E'^Typ=25 Len=(\\d+): \\d+(,\\d+)*$' AS t;
 t 
---
 t
(1 row)

SELECT dump('Yellow dog'::text, 17) ~ E'^Typ=25 Len=(\\d+): .(,.)*$' AS t;
 t 
---
 t
(1 row)

SELECT dump(10::int2) ~ E'^Typ=21 Len=2: \\d+(,\\d+){1}$' AS t;
 t 
---
 t
(1 row)

SELECT dump(10::int4) ~ E'^Typ=23 Len=4: \\d+(,\\d+){3}$' AS t;
 t 
---
 t
(1 row)

SELECT dump(10::int8) ~ E'^Typ=20 Len=8: \\d+(,\\d+){7}$' AS t;
 t 
---
 t
(1 row)

SELECT dump(10.23::float4) ~ E'^Typ=700 Len=4: \\d+(,\\d+){3}$' AS t;
 t 
---
 t
(1 row)

SELECT dump(10.23::float8) ~ E'^Typ=701 Len=8: \\d+(,\\d+){7}$' AS t;
 t 
---
 t
(1 row)

SELECT dump(10.23::numeric) ~ E'^Typ=1700 Len=(\\d+): \\d+(,\\d+)*$' AS t;
 t 
---
 t
(1 row)

SELECT dump('2008-10-10'::date) ~ E'^Typ=1082 Len=4: \\d+(,\\d+){3}$' AS t;
 t 
---
 t
(1 row)

SELECT dump('2008-10-10'::timestamp) ~ E'^Typ=1114 Len=8: \\d+(,\\d+){7}$' AS t;
 t 
---
 t
(1 row)

SELECT dump('2009-10-10'::timestamp) ~ E'^Typ=1114 Len=8: \\d+(,\\d+){7}$' AS t;
 t 
---
 t
(1 row)

-- test substr
select substr('This is a test', 6, 2) = 'is';
 ?column? 
----------
 t
(1 row)

select substr('This is a test', 6) =  'is a test';
 ?column? 
----------
 t
(1 row)

select substr('TechOnTheNet', 1, 4) =  'Tech';
 ?column? 
----------
 t
(1 row)

select substr('TechOnTheNet', -3, 3) =  'Net';
 ?column? 
----------
 t
(1 row)

select substr('TechOnTheNet', -6, 3) =  'The';
 ?column? 
----------
 t
(1 row)

select substr('TechOnTheNet', -8, 2) =  'On';
 ?column? 
----------
 t
(1 row)

select substr('TechOnTheNet', -8, 0) =  '';
 ?column? 
----------
 t
(1 row)

select substr('TechOnTheNet', -8, -1) =  '';
 ?column? 
----------
 
(1 row)

select substr(1234567,3.6::smallint)='4567';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::int)='4567';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::bigint)='4567';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::numeric)='34567';
 ?column? 
----------
 t
(1 row)

select substr(1234567,-1)='7';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::smallint,2.6)='45';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::smallint,2.6::smallint)='456';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::smallint,2.6::int)='456';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::smallint,2.6::bigint)='456';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::smallint,2.6::numeric)='45';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::int,2.6::smallint)='456';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::int,2.6::int)='456';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::int,2.6::bigint)='456';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::int,2.6::numeric)='45';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::bigint,2.6::smallint)='456';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::bigint,2.6::int)='456';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::bigint,2.6::bigint)='456';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::bigint,2.6::numeric)='45';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::numeric,2.6::smallint)='345';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::numeric,2.6::int)='345';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::numeric,2.6::bigint)='345';
 ?column? 
----------
 t
(1 row)

select substr(1234567,3.6::numeric,2.6::numeric)='34';
 ?column? 
----------
 t
(1 row)

select substr('abcdef'::varchar,3.6::smallint)='def';
 ?column? 
----------
 t
(1 row)

select substr('abcdef'::varchar,3.6::int)='def';
 ?column? 
----------
 t
(1 row)

select substr('abcdef'::varchar,3.6::bigint)='def';
 ?column? 
----------
 t
(1 row)

select substr('abcdef'::varchar,3.6::numeric)='cdef';
 ?column? 
----------
 t
(1 row)

select substr('abcdef'::varchar,3.5::int,3.5::int)='def';
 ?column? 
----------
 t
(1 row)

select substr('abcdef'::varchar,3.5::numeric,3.5::numeric)='cde';
 ?column? 
----------
 t
(1 row)

select substr('abcdef'::varchar,3.5::numeric,3.5::int)='cdef';
 ?column? 
----------
 t
(1 row)

-- test lengthb
select length('oracle'),lengthB('oracle') from dual;
 length | lengthb 
--------+---------
      6 |       6
(1 row)

-- test strposb
select strposb('abc', '') from dual;
 strposb 
---------
       1
(1 row)

select strposb('abc', 'a') from dual;
 strposb 
---------
       1
(1 row)

select strposb('abc', 'c') from dual;
 strposb 
---------
       3
(1 row)

select strposb('abc', 'z') from dual;
 strposb 
---------
       0
(1 row)

select strposb('abcabcabc', 'abca') from dual;
 strposb 
---------
       1
(1 row)

--test decode
select decode(1, 1, 100, 2, 200);
 decode 
--------
    100
(1 row)

select decode(2, 1, 100, 2, 200);
 decode 
--------
    200
(1 row)

select decode(3, 1, 100, 2, 200);
 decode 
--------
       
(1 row)

select decode(3, 1, 100, 2, 200, 300);
 decode 
--------
    300
(1 row)

select decode(NULL, 1, 100, NULL, 200, 300);
 decode 
--------
    200
(1 row)

select decode('1'::text, '1', 100, '2', 200);
 decode 
--------
    100
(1 row)

select decode(2, 1, 'ABC', 2, 'DEF');
 decode 
--------
 DEF
(1 row)

select decode('2009-02-05'::date, '2009-02-05', 'ok');
 decode 
--------
 ok
(1 row)

select decode('2009-02-05 01:02:03'::timestamp, '2009-02-05 01:02:03', 'ok');
 decode 
--------
 ok
(1 row)

-- For type 'bpchar'
select decode('a'::bpchar, 'a'::bpchar,'postgres'::bpchar);
  decode  
----------
 postgres
(1 row)

select decode('c'::bpchar, 'a'::bpchar,'postgres'::bpchar);
 decode 
--------
 
(1 row)

select decode('a'::bpchar, 'a'::bpchar,'postgres'::bpchar,'default value'::bpchar);
  decode  
----------
 postgres
(1 row)

select decode('c', 'a'::bpchar,'postgres'::bpchar,'default value'::bpchar);
    decode     
---------------
 default value
(1 row)

select decode('a'::bpchar, 'a'::bpchar,'postgres'::bpchar,'b'::bpchar,'database'::bpchar);
  decode  
----------
 postgres
(1 row)

select decode('d'::bpchar, 'a'::bpchar,'postgres'::bpchar,'b'::bpchar,'database'::bpchar);
 decode 
--------
 
(1 row)

select decode('a'::bpchar, 'a'::bpchar,'postgres'::bpchar,'b'::bpchar,'database'::bpchar,'default value'::bpchar);
  decode  
----------
 postgres
(1 row)

select decode('d'::bpchar, 'a'::bpchar,'postgres'::bpchar,'b'::bpchar,'database'::bpchar,'default value'::bpchar);
    decode     
---------------
 default value
(1 row)

select decode('a'::bpchar, 'a'::bpchar,'postgres'::bpchar,'b'::bpchar,'database'::bpchar, 'c'::bpchar, 'system'::bpchar);
  decode  
----------
 postgres
(1 row)

select decode('d'::bpchar, 'a'::bpchar,'postgres'::bpchar,'b'::bpchar,'database'::bpchar, 'c'::bpchar, 'system'::bpchar);
 decode 
--------
 
(1 row)

select decode('a'::bpchar, 'a'::bpchar,'postgres'::bpchar,'b'::bpchar,'database'::bpchar, 'c'::bpchar, 'system'::bpchar,'default value'::bpchar);
  decode  
----------
 postgres
(1 row)

select decode('d'::bpchar, 'a'::bpchar,'postgres'::bpchar,'b'::bpchar,'database'::bpchar, 'c'::bpchar, 'system'::bpchar,'default value'::bpchar);
    decode     
---------------
 default value
(1 row)

select decode(NULL, 'a'::bpchar, 'postgres'::bpchar, NULL,'database'::bpchar);
  decode  
----------
 database
(1 row)

select decode(NULL, 'a'::bpchar, 'postgres'::bpchar, 'b'::bpchar,'database'::bpchar);
 decode 
--------
 
(1 row)

select decode(NULL, 'a'::bpchar, 'postgres'::bpchar, NULL,'database'::bpchar,'default value'::bpchar);
  decode  
----------
 database
(1 row)

select decode(NULL, 'a'::bpchar, 'postgres'::bpchar, 'b'::bpchar,'database'::bpchar,'default value'::bpchar);
    decode     
---------------
 default value
(1 row)

-- For type 'bigint'
select decode(2147483651::bigint, 2147483650::bigint,2147483650::bigint);
 decode 
--------
       
(1 row)

select decode(2147483653::bigint, 2147483651::bigint,2147483650::bigint);
 decode 
--------
       
(1 row)

select decode(2147483653::bigint, 2147483651::bigint,2147483650::bigint,9999999999::bigint);
   decode   
------------
 9999999999
(1 row)

select decode(2147483653::bigint, 2147483651::bigint,2147483650::bigint,9999999999::bigint);
   decode   
------------
 9999999999
(1 row)

select decode(2147483651::bigint, 2147483651::bigint,2147483650::bigint,2147483652::bigint,2147483651::bigint);
   decode   
------------
 2147483650
(1 row)

select decode(2147483654::bigint, 2147483651::bigint,2147483650::bigint,2147483652::bigint,2147483651::bigint);
 decode 
--------
       
(1 row)

select decode(2147483651::bigint, 2147483651::bigint,2147483650::bigint,2147483652::bigint,2147483651::bigint,9999999999::bigint);
   decode   
------------
 2147483650
(1 row)

select decode(2147483654::bigint, 2147483651::bigint,2147483650::bigint,2147483652::bigint,2147483651::bigint,9999999999::bigint);
   decode   
------------
 9999999999
(1 row)

select decode(2147483651::bigint, 2147483651::bigint,2147483650::bigint, 2147483652::bigint,2147483651::bigint, 2147483653::bigint, 2147483652::bigint);
   decode   
------------
 2147483650
(1 row)

select decode(2147483654::bigint, 2147483651::bigint,2147483650::bigint, 2147483652::bigint,2147483651::bigint, 2147483653::bigint, 2147483652::bigint);
 decode 
--------
       
(1 row)

select decode(2147483651::bigint, 2147483651::bigint,2147483650::bigint, 2147483652::bigint,2147483651::bigint, 2147483653::bigint, 2147483652::bigint,9999999999::bigint);
   decode   
------------
 2147483650
(1 row)

select decode(2147483654::bigint, 2147483651::bigint,2147483650::bigint, 2147483652::bigint,2147483651::bigint, 2147483653::bigint, 2147483652::bigint,9999999999::bigint);
   decode   
------------
 9999999999
(1 row)

select decode(NULL, 2147483651::bigint, 2147483650::bigint, NULL,2147483651::bigint);
   decode   
------------
 2147483651
(1 row)

select decode(NULL, 2147483651::bigint, 2147483650::bigint, 2147483652::bigint,2147483651::bigint);
 decode 
--------
       
(1 row)

select decode(NULL, 2147483651::bigint, 2147483650::bigint, NULL,2147483651::bigint,9999999999::bigint);
   decode   
------------
 2147483651
(1 row)

select decode(NULL, 2147483651::bigint, 2147483650::bigint, 2147483652::bigint,2147483651::bigint,9999999999::bigint);
   decode   
------------
 9999999999
(1 row)

-- For type 'numeric'
select decode(12.001::numeric(5,3), 12.001::numeric(5,3),214748.3650::numeric(10,4));
   decode    
-------------
 214748.3650
(1 row)

select decode(12.003::numeric(5,3), 12.001::numeric(5,3),214748.3650::numeric(10,4));
 decode 
--------
       
(1 row)

select decode(12.001::numeric(5,3), 12.001::numeric(5,3),214748.3650::numeric(10,4),999999.9999::numeric(10,4));
   decode    
-------------
 214748.3650
(1 row)

select decode(12.003::numeric(5,3), 12.001::numeric(5,3),214748.3650::numeric(10,4),999999.9999::numeric(10,4));
   decode    
-------------
 999999.9999
(1 row)

select decode(12.001::numeric(5,3), 12.001::numeric(5,3),214748.3650::numeric(10,4),12.002::numeric(5,3),214748.3651::numeric(10,4));
   decode    
-------------
 214748.3650
(1 row)

select decode(12.004::numeric(5,3), 12.001::numeric(5,3),214748.3650::numeric(10,4),12.002::numeric(5,3),214748.3651::numeric(10,4));
 decode 
--------
       
(1 row)

select decode(12.001::numeric(5,3), 12.001::numeric(5,3),214748.3650::numeric(10,4),12.002::numeric(5,3),214748.3651::numeric(10,4),999999.9999::numeric(10,4));
   decode    
-------------
 214748.3650
(1 row)

select decode(12.004::numeric(5,3), 12.001::numeric(5,3),214748.3650::numeric(10,4),12.002::numeric(5,3),214748.3651::numeric(10,4),999999.9999::numeric(10,4));
   decode    
-------------
 999999.9999
(1 row)

select decode(12.001::numeric(5,3), 12.001::numeric(5,3),214748.3650::numeric(10,4),12.002::numeric(5,3),214748.3651::numeric(10,4), 12.003::numeric(5,3), 214748.3652::numeric(10,4));
   decode    
-------------
 214748.3650
(1 row)

select decode(12.004::numeric(5,3), 12.001::numeric(5,3),214748.3650::numeric(10,4),12.002::numeric(5,3),214748.3651::numeric(10,4), 12.003::numeric(5,3), 214748.3652::numeric(10,4));
 decode 
--------
       
(1 row)

select decode(12.001::numeric(5,3), 12.001::numeric(5,3),214748.3650::numeric(10,4),12.002::numeric(5,3),214748.3651::numeric(10,4), 12.003::numeric(5,3), 214748.3652::numeric(10,4),999999.9999::numeric(10,4));
   decode    
-------------
 214748.3650
(1 row)

select decode(12.004::numeric(5,3), 12.001::numeric(5,3),214748.3650::numeric(10,4),12.002::numeric(5,3),214748.3651::numeric(10,4), 12.003::numeric(5,3), 214748.3652::numeric(10,4),999999.9999::numeric(10,4));
   decode    
-------------
 999999.9999
(1 row)

select decode(NULL, 12.001::numeric(5,3), 214748.3650::numeric(10,4), NULL,214748.3651::numeric(10,4));
   decode    
-------------
 214748.3651
(1 row)

select decode(NULL, 12.001::numeric(5,3), 214748.3650::numeric(10,4), 12.002::numeric(5,3),214748.3651::numeric(10,4));
 decode 
--------
       
(1 row)

select decode(NULL, 12.001::numeric(5,3), 214748.3650::numeric(10,4), NULL,214748.3651::numeric(10,4),999999.9999::numeric(10,4));
   decode    
-------------
 214748.3651
(1 row)

select decode(NULL, 12.001::numeric(5,3), 214748.3650::numeric(10,4), 12.002::numeric(5,3),214748.3651::numeric(10,4),999999.9999::numeric(10,4));
   decode    
-------------
 999999.9999
(1 row)

--For type 'date'
select decode('2020-01-01'::date, '2020-01-01'::date,'2012-12-20'::date);
   decode   
------------
 2012-12-20
(1 row)

select decode('2020-01-03'::date, '2020-01-01'::date,'2012-12-20'::date);
 decode 
--------
 
(1 row)

select decode('2020-01-01'::date, '2020-01-01'::date,'2012-12-20'::date,'2012-12-21'::date);
   decode   
------------
 2012-12-20
(1 row)

select decode('2020-01-03'::date, '2020-01-01'::date,'2012-12-20'::date,'2012-12-21'::date);
   decode   
------------
 2012-12-21
(1 row)

select decode('2020-01-01'::date, '2020-01-01'::date,'2012-12-20'::date,'2020-01-02'::date,'2012-12-21'::date);
   decode   
------------
 2012-12-20
(1 row)

select decode('2020-01-04'::date, '2020-01-01'::date,'2012-12-20'::date,'2020-01-02'::date,'2012-12-21'::date);
 decode 
--------
 
(1 row)

select decode('2020-01-01'::date, '2020-01-01'::date,'2012-12-20'::date,'2020-01-02'::date,'2012-12-21'::date,'2012-12-31'::date);
   decode   
------------
 2012-12-20
(1 row)

select decode('2020-01-04'::date, '2020-01-01'::date,'2012-12-20'::date,'2020-01-02'::date,'2012-12-21'::date,'2012-12-31'::date);
   decode   
------------
 2012-12-31
(1 row)

select decode('2020-01-01'::date, '2020-01-01'::date,'2012-12-20'::date,'2020-01-02'::date,'2012-12-21'::date, '2020-01-03'::date, '2012-12-31'::date);
   decode   
------------
 2012-12-20
(1 row)

select decode('2020-01-04'::date, '2020-01-01'::date,'2012-12-20'::date,'2020-01-02'::date,'2012-12-21'::date, '2020-01-03'::date, '2012-12-31'::date);
 decode 
--------
 
(1 row)

select decode('2020-01-01'::date, '2020-01-01'::date,'2012-12-20'::date,'2020-01-02'::date,'2012-12-21'::date, '2020-01-03'::date, '2012-12-31'::date,'2013-01-01'::date);
   decode   
------------
 2012-12-20
(1 row)

select decode('2020-01-04'::date, '2020-01-01'::date,'2012-12-20'::date,'2020-01-02'::date,'2012-12-21'::date, '2020-01-03'::date, '2012-12-31'::date,'2013-01-01'::date);
   decode   
------------
 2013-01-01
(1 row)

select decode(NULL, '2020-01-01'::date, '2012-12-20'::date, NULL,'2012-12-21'::date);
   decode   
------------
 2012-12-21
(1 row)

select decode(NULL, '2020-01-01'::date, '2012-12-20'::date, '2020-01-02'::date,'2012-12-21'::date);
 decode 
--------
 
(1 row)

select decode(NULL, '2020-01-01'::date, '2012-12-20'::date, NULL,'2012-12-21'::date,'2012-12-31'::date);
   decode   
------------
 2012-12-21
(1 row)

select decode(NULL, '2020-01-01'::date, '2012-12-20'::date, '2020-01-02'::date,'2012-12-21'::date,'2012-12-31'::date);
   decode   
------------
 2012-12-31
(1 row)

-- For type 'time'
select decode('01:00:01'::time, '01:00:01'::time,'09:00:00'::time);
  decode  
----------
 09:00:00
(1 row)

select decode('01:00:03'::time, '01:00:01'::time,'09:00:00'::time);
 decode 
--------
 
(1 row)

select decode('01:00:01'::time, '01:00:01'::time,'09:00:00'::time,'00:00:00'::time);
  decode  
----------
 09:00:00
(1 row)

select decode('01:00:03'::time, '01:00:01'::time,'09:00:00'::time,'00:00:00'::time);
  decode  
----------
 00:00:00
(1 row)

select decode('01:00:01'::time, '01:00:01'::time,'09:00:00'::time,'01:00:02'::time,'12:00:00'::time);
  decode  
----------
 09:00:00
(1 row)

select decode('01:00:04'::time, '01:00:01'::time,'09:00:00'::time,'01:00:02'::time,'12:00:00'::time);
 decode 
--------
 
(1 row)

select decode('01:00:01'::time, '01:00:01'::time,'09:00:00'::time,'01:00:02'::time,'12:00:00'::time,'00:00:00'::time);
  decode  
----------
 09:00:00
(1 row)

select decode('01:00:04'::time, '01:00:01'::time,'09:00:00'::time,'01:00:01'::time,'12:00:00'::time,'00:00:00'::time);
  decode  
----------
 00:00:00
(1 row)

select decode('01:00:01'::time, '01:00:01'::time,'09:00:00'::time,'01:00:02'::time,'12:00:00'::time, '01:00:03'::time, '15:00:00'::time);
  decode  
----------
 09:00:00
(1 row)

select decode('01:00:04'::time, '01:00:01'::time,'09:00:00'::time,'01:00:02'::time,'12:00:00'::time, '01:00:03'::time, '15:00:00'::time);
 decode 
--------
 
(1 row)

select decode('01:00:01'::time, '01:00:01'::time,'09:00:00'::time,'01:00:02'::time,'12:00:00'::time, '01:00:03'::time, '15:00:00'::time,'00:00:00'::time);
  decode  
----------
 09:00:00
(1 row)

select decode('01:00:04'::time, '01:00:01'::time,'09:00:00'::time,'01:00:02'::time,'12:00:00'::time, '01:00:03'::time, '15:00:00'::time,'00:00:00'::time);
  decode  
----------
 00:00:00
(1 row)

select decode(NULL, '01:00:01'::time, '09:00:00'::time, NULL,'12:00:00'::time);
  decode  
----------
 12:00:00
(1 row)

select decode(NULL, '01:00:01'::time, '09:00:00'::time, '01:00:02'::time,'12:00:00'::time);
 decode 
--------
 
(1 row)

select decode(NULL, '01:00:01'::time, '09:00:00'::time, NULL,'12:00:00'::time,'00:00:00'::time);
  decode  
----------
 12:00:00
(1 row)

select decode(NULL, '01:00:01'::time, '09:00:00'::time, '01:00:02'::time,'12:00:00'::time,'00:00:00'::time);
  decode  
----------
 00:00:00
(1 row)

-- For type 'timestamp'
select decode('2020-01-01 01:00:01'::timestamp, '2020-01-01 01:00:01'::timestamp,'2012-12-20 09:00:00'::timestamp);
       decode        
---------------------
 2012-12-20 09:00:00
(1 row)

select decode('2020-01-03 01:00:01'::timestamp, '2020-01-01 01:00:01'::timestamp,'2012-12-20 09:00:00'::timestamp);
 decode 
--------
 
(1 row)

select decode('2020-01-01 01:00:01'::timestamp, '2020-01-01 01:00:01'::timestamp,'2012-12-20 09:00:00'::timestamp,'2012-12-20 00:00:00'::timestamp);
       decode        
---------------------
 2012-12-20 09:00:00
(1 row)

select decode('2020-01-03 01:00:01'::timestamp, '2020-01-01 01:00:01'::timestamp,'2012-12-20 09:00:00'::timestamp,'2012-12-20 00:00:00'::timestamp);
       decode        
---------------------
 2012-12-20 00:00:00
(1 row)

select decode('2020-01-01 01:00:01'::timestamp, '2020-01-01 01:00:01'::timestamp,'2012-12-20 09:00:00'::timestamp,'2020-01-02 01:00:01'::timestamp,'2012-12-20 12:00:00'::timestamp);
       decode        
---------------------
 2012-12-20 09:00:00
(1 row)

select decode('2020-01-04 01:00:01'::timestamp, '2020-01-01 01:00:01'::timestamp,'2012-12-20 09:00:00'::timestamp,'2020-01-02 01:00:01'::timestamp,'2012-12-20 12:00:00'::timestamp);
 decode 
--------
 
(1 row)

select decode('2020-01-01 01:00:01'::timestamp, '2020-01-01 01:00:01'::timestamp,'2012-12-20 09:00:00'::timestamp,'2020-01-02 01:00:01'::timestamp,'2012-12-20 12:00:00'::timestamp,'2012-12-20 00:00:00'::timestamp);
       decode        
---------------------
 2012-12-20 09:00:00
(1 row)

select decode('2020-01-04 01:00:01'::timestamp, '2020-01-01 01:00:01'::timestamp,'2012-12-20 09:00:00'::timestamp,'2020-01-02 01:00:01'::timestamp,'2012-12-20 12:00:00'::timestamp,'2012-12-20 00:00:00'::timestamp);
       decode        
---------------------
 2012-12-20 00:00:00
(1 row)

select decode('2020-01-01 01:00:01'::timestamp, '2020-01-01 01:00:01'::timestamp,'2012-12-20 09:00:00'::timestamp,'2020-01-02 01:00:01'::timestamp,'2012-12-20 12:00:00'::timestamp, '2020-01-03 01:00:01'::timestamp, '2012-12-20 15:00:00'::timestamp);
       decode        
---------------------
 2012-12-20 09:00:00
(1 row)

select decode('2020-01-04 01:00:01'::timestamp, '2020-01-01 01:00:01'::timestamp,'2012-12-20 09:00:00'::timestamp,'2020-01-02 01:00:01'::timestamp,'2012-12-20 12:00:00'::timestamp, '2020-01-03 01:00:01'::timestamp, '2012-12-20 15:00:00'::timestamp);
 decode 
--------
 
(1 row)

select decode('2020-01-01 01:00:01'::timestamp, '2020-01-01 01:00:01'::timestamp,'2012-12-20 09:00:00'::timestamp,'2020-01-02 01:00:01'::timestamp,'2012-12-20 12:00:00'::timestamp, '2020-01-03 01:00:01'::timestamp, '2012-12-20 15:00:00'::timestamp,'2012-12-20 00:00:00'::timestamp);
       decode        
---------------------
 2012-12-20 09:00:00
(1 row)

select decode('2020-01-04 01:00:01'::timestamp, '2020-01-01 01:00:01'::timestamp,'2012-12-20 09:00:00'::timestamp,'2020-01-02 01:00:01'::timestamp,'2012-12-20 12:00:00'::timestamp, '2020-01-03 01:00:01'::timestamp, '2012-12-20 15:00:00'::timestamp,'2012-12-20 00:00:00'::timestamp);
       decode        
---------------------
 2012-12-20 00:00:00
(1 row)

select decode(NULL, '2020-01-01 01:00:01'::timestamp, '2012-12-20 09:00:00'::timestamp, NULL,'2012-12-20 12:00:00'::timestamp);
       decode        
---------------------
 2012-12-20 12:00:00
(1 row)

select decode(NULL, '2020-01-01 01:00:01'::timestamp, '2012-12-20 09:00:00'::timestamp, '2020-01-02 01:00:01'::timestamp,'2012-12-20 12:00:00'::timestamp);
 decode 
--------
 
(1 row)

select decode(NULL, '2020-01-01 01:00:01'::timestamp, '2012-12-20 09:00:00'::timestamp, NULL,'2012-12-20 12:00:00'::timestamp,'2012-12-20 00:00:00'::timestamp);
       decode        
---------------------
 2012-12-20 12:00:00
(1 row)

select decode(NULL, '2020-01-01 01:00:01'::timestamp, '2012-12-20 09:00:00'::timestamp, '2020-01-02 01:00:01'::timestamp,'2012-12-20 12:00:00'::timestamp,'2012-12-20 00:00:00'::timestamp);
       decode        
---------------------
 2012-12-20 00:00:00
(1 row)

-- For type 'timestamptz'
select decode('2020-01-01 01:00:01-08'::timestamptz, '2020-01-01 01:00:01-08'::timestamptz,'2012-12-20 09:00:00-08'::timestamptz);
         decode         
------------------------
 2012-12-20 09:00:00-08
(1 row)

select decode('2020-01-03 01:00:01-08'::timestamptz, '2020-01-01 01:00:01-08'::timestamptz,'2012-12-20 09:00:00-08'::timestamptz);
 decode 
--------
 
(1 row)

select decode('2020-01-01 01:00:01-08'::timestamptz, '2020-01-01 01:00:01-08'::timestamptz,'2012-12-20 09:00:00-08'::timestamptz,'2012-12-20 00:00:00-08'::timestamptz);
         decode         
------------------------
 2012-12-20 09:00:00-08
(1 row)

select decode('2020-01-03 01:00:01-08'::timestamptz, '2020-01-01 01:00:01-08'::timestamptz,'2012-12-20 09:00:00-08'::timestamptz,'2012-12-20 00:00:00-08'::timestamptz);
         decode         
------------------------
 2012-12-20 00:00:00-08
(1 row)

select decode('2020-01-01 01:00:01-08'::timestamptz, '2020-01-01 01:00:01-08'::timestamptz,'2012-12-20 09:00:00-08'::timestamptz,'2020-01-02 01:00:01-08'::timestamptz,'2012-12-20 12:00:00-08'::timestamptz);
         decode         
------------------------
 2012-12-20 09:00:00-08
(1 row)

select decode('2020-01-04 01:00:01-08'::timestamptz, '2020-01-01 01:00:01-08'::timestamptz,'2012-12-20 09:00:00-08'::timestamptz,'2020-01-02 01:00:01-08'::timestamptz,'2012-12-20 12:00:00-08'::timestamptz);
 decode 
--------
 
(1 row)

select decode('2020-01-01 01:00:01-08'::timestamptz, '2020-01-01 01:00:01-08'::timestamptz,'2012-12-20 09:00:00-08'::timestamptz,'2020-01-02 01:00:01-08'::timestamptz,'2012-12-20 12:00:00-08'::timestamptz,'2012-12-20 00:00:00-08'::timestamptz);
         decode         
------------------------
 2012-12-20 09:00:00-08
(1 row)

select decode('2020-01-04 01:00:01-08'::timestamptz, '2020-01-01 01:00:01-08'::timestamptz,'2012-12-20 09:00:00-08'::timestamptz,'2020-01-02 01:00:01-08'::timestamptz,'2012-12-20 12:00:00-08'::timestamptz,'2012-12-20 00:00:00-08'::timestamptz);
         decode         
------------------------
 2012-12-20 00:00:00-08
(1 row)

select decode('2020-01-01 01:00:01-08'::timestamptz, '2020-01-01 01:00:01-08'::timestamptz,'2012-12-20 09:00:00-08'::timestamptz,'2020-01-02 01:00:01-08'::timestamptz,'2012-12-20 12:00:00-08'::timestamptz, '2020-01-03 01:00:01-08'::timestamptz, '2012-12-20 15:00:00-08'::timestamptz);
         decode         
------------------------
 2012-12-20 09:00:00-08
(1 row)

select decode('2020-01-04 01:00:01-08'::timestamptz, '2020-01-01 01:00:01-08'::timestamptz,'2012-12-20 09:00:00-08'::timestamptz,'2020-01-02 01:00:01-08'::timestamptz,'2012-12-20 12:00:00-08'::timestamptz, '2020-01-03 01:00:01-08'::timestamptz, '2012-12-20 15:00:00-08'::timestamptz);
 decode 
--------
 
(1 row)

select decode('2020-01-01 01:00:01-08'::timestamptz, '2020-01-01 01:00:01-08'::timestamptz,'2012-12-20 09:00:00-08'::timestamptz,'2020-01-02 01:00:01-08'::timestamptz,'2012-12-20 12:00:00-08'::timestamptz, '2020-01-03 01:00:01-08'::timestamptz, '2012-12-20 15:00:00-08'::timestamptz,'2012-12-20 00:00:00-08'::timestamptz);
         decode         
------------------------
 2012-12-20 09:00:00-08
(1 row)

select decode(4, 1,'2012-12-20 09:00:00-08'::timestamptz,2,'2012-12-20 12:00:00-08'::timestamptz, 3, '2012-12-20 15:00:00-08'::timestamptz,'2012-12-20 00:00:00-08'::timestamptz);
         decode         
------------------------
 2012-12-20 00:00:00-08
(1 row)

select decode(NULL, '2020-01-01 01:00:01-08'::timestamptz, '2012-12-20 09:00:00-08'::timestamptz, NULL,'2012-12-20 12:00:00-08'::timestamptz);
         decode         
------------------------
 2012-12-20 12:00:00-08
(1 row)

select decode(NULL, '2020-01-01 01:00:01-08'::timestamptz, '2012-12-20 09:00:00-08'::timestamptz, '2020-01-02 01:00:01-08'::timestamptz,'2012-12-20 12:00:00-08'::timestamptz);
 decode 
--------
 
(1 row)

select decode(NULL, '2020-01-01 01:00:01-08'::timestamptz, '2012-12-20 09:00:00-08'::timestamptz, NULL,'2012-12-20 12:00:00-08'::timestamptz,'2012-12-20 00:00:00-08'::timestamptz);
         decode         
------------------------
 2012-12-20 12:00:00-08
(1 row)

select decode(NULL, '2020-01-01 01:00:01-08'::timestamptz, '2012-12-20 09:00:00-08'::timestamptz, '2020-01-02 01:00:01-08'::timestamptz,'2012-12-20 12:00:00-08'::timestamptz,'2012-12-20 00:00:00-08'::timestamptz);
         decode         
------------------------
 2012-12-20 00:00:00-08
(1 row)

select decode(1, 1,'2011-12-20 09:00:00-08',2,'2012-12-20 12:00:00-08', 3, '2013-12-20 15:00:00-08', 4, '2014-12-20 00:00:00-08', 5,'2015-12-20 00:00:00-08',6 ,'2016-12-20 00:00:00-08', 7 ,'2017-12-20 00:00:00-08', 8 ,'2012-18-20 00:00:00-08', 9 ,'2019-12-20 00:00:00-08',  10 ,'2020-12-20 00:00:00-08',  11 ,'2021-12-20 00:00:00-08',  12 ,'2022-12-20 00:00:00-08',  13 ,'20123-12-20 00:00:00-08',  14 ,'2024-12-20 00:00:00-08',  15 ,'2025-12-20 00:00:00-08', 16,'2026-12-20 00:00:00-08', 17,'2027-12-20 00:00:00-08', 18,'2028-12-20 00:00:00-08', 19,'2029-12-20 00:00:00-08', 'default');
         decode         
------------------------
 2011-12-20 09:00:00-08
(1 row)

select decode(2, 1,'2011-12-20 09:00:00-08',2,'2012-12-20 12:00:00-08', 3, '2013-12-20 15:00:00-08', 4, '2014-12-20 00:00:00-08', 5,'2015-12-20 00:00:00-08',6 ,'2016-12-20 00:00:00-08', 7 ,'2017-12-20 00:00:00-08', 8 ,'2012-18-20 00:00:00-08', 9 ,'2019-12-20 00:00:00-08',  10 ,'2020-12-20 00:00:00-08',  11 ,'2021-12-20 00:00:00-08',  12 ,'2022-12-20 00:00:00-08',  13 ,'20123-12-20 00:00:00-08',  14 ,'2024-12-20 00:00:00-08',  15 ,'2025-12-20 00:00:00-08', 16,'2026-12-20 00:00:00-08', 17,'2027-12-20 00:00:00-08', 18,'2028-12-20 00:00:00-08', 19,'2029-12-20 00:00:00-08', 'default');
         decode         
------------------------
 2012-12-20 12:00:00-08
(1 row)

select decode(19, 1,'2011-12-20 09:00:00-08',2,'2012-12-20 12:00:00-08', 3, '2013-12-20 15:00:00-08', 4, '2014-12-20 00:00:00-08', 5,'2015-12-20 00:00:00-08',6 ,'2016-12-20 00:00:00-08', 7 ,'2017-12-20 00:00:00-08', 8 ,'2012-18-20 00:00:00-08', 9 ,'2019-12-20 00:00:00-08',  10 ,'2020-12-20 00:00:00-08',  11 ,'2021-12-20 00:00:00-08',  12 ,'2022-12-20 00:00:00-08',  13 ,'20123-12-20 00:00:00-08',  14 ,'2024-12-20 00:00:00-08',  15 ,'2025-12-20 00:00:00-08', 16,'2026-12-20 00:00:00-08', 17,'2027-12-20 00:00:00-08', 18,'2028-12-20 00:00:00-08', 19,'2029-12-20 00:00:00-08', 'default');
         decode         
------------------------
 2029-12-20 00:00:00-08
(1 row)

select decode(20, 1,'2011-12-20 09:00:00-08',2,'2012-12-20 12:00:00-08', 3, '2013-12-20 15:00:00-08', 4, '2014-12-20 00:00:00-08', 5,'2015-12-20 00:00:00-08',6 ,'2016-12-20 00:00:00-08', 7 ,'2017-12-20 00:00:00-08', 8 ,'2012-18-20 00:00:00-08', 9 ,'2019-12-20 00:00:00-08',  10 ,'2020-12-20 00:00:00-08',  11 ,'2021-12-20 00:00:00-08',  12 ,'2022-12-20 00:00:00-08',  13 ,'20123-12-20 00:00:00-08',  14 ,'2024-12-20 00:00:00-08',  15 ,'2025-12-20 00:00:00-08', 16,'2026-12-20 00:00:00-08', 17,'2027-12-20 00:00:00-08', 18,'2028-12-20 00:00:00-08', 19,'2029-12-20 00:00:00-08', 'default');
 decode  
---------
 default
(1 row)

select decode(21, 1,'2011-12-20 09:00:00-08',2,'2012-12-20 12:00:00-08', 3, '2013-12-20 15:00:00-08', 4, '2014-12-20 00:00:00-08', 5,'2015-12-20 00:00:00-08',6 ,'2016-12-20 00:00:00-08', 7 ,'2017-12-20 00:00:00-08', 8 ,'2012-18-20 00:00:00-08', 9 ,'2019-12-20 00:00:00-08',  10 ,'2020-12-20 00:00:00-08',  11 ,'2021-12-20 00:00:00-08',  12 ,'2022-12-20 00:00:00-08',  13 ,'20123-12-20 00:00:00-08',  14 ,'2024-12-20 00:00:00-08',  15 ,'2025-12-20 00:00:00-08', 16,'2026-12-20 00:00:00-08', 17,'2027-12-20 00:00:00-08', 18,'2028-12-20 00:00:00-08', 19,'2029-12-20 00:00:00-08', 'default');
 decode  
---------
 default
(1 row)

select decode(22, 1,'2011-12-20 09:00:00-08',2,'2012-12-20 12:00:00-08', 3, '2013-12-20 15:00:00-08', 4, '2014-12-20 00:00:00-08', 5,'2015-12-20 00:00:00-08',6 ,'2016-12-20 00:00:00-08', 7 ,'2017-12-20 00:00:00-08', 8 ,'2012-18-20 00:00:00-08', 9 ,'2019-12-20 00:00:00-08',  10 ,'2020-12-20 00:00:00-08',  11 ,'2021-12-20 00:00:00-08',  12 ,'2022-12-20 00:00:00-08',  13 ,'20123-12-20 00:00:00-08',  14 ,'2024-12-20 00:00:00-08',  15 ,'2025-12-20 00:00:00-08', 16,'2026-12-20 00:00:00-08', 17,'2027-12-20 00:00:00-08', 18,'2028-12-20 00:00:00-08', 19,'2029-12-20 00:00:00-08', 'default');
 decode  
---------
 default
(1 row)

select decode(23, 1,'2011-12-20 09:00:00-08',2,'2012-12-20 12:00:00-08', 3, '2013-12-20 15:00:00-08', 4, '2014-12-20 00:00:00-08', 5,'2015-12-20 00:00:00-08',6 ,'2016-12-20 00:00:00-08', 7 ,'2017-12-20 00:00:00-08', 8 ,'2012-18-20 00:00:00-08', 9 ,'2019-12-20 00:00:00-08',  10 ,'2020-12-20 00:00:00-08',  11 ,'2021-12-20 00:00:00-08',  12 ,'2022-12-20 00:00:00-08',  13 ,'20123-12-20 00:00:00-08',  14 ,'2024-12-20 00:00:00-08',  15 ,'2025-12-20 00:00:00-08', 16,'2026-12-20 00:00:00-08', 17,'2027-12-20 00:00:00-08', 18,'2028-12-20 00:00:00-08', 19,'2029-12-20 00:00:00-08', 'default');
 decode  
---------
 default
(1 row)

select decode(20, 1,'2011-12-20 09:00:00-08',2,'2012-12-20 12:00:00-08', 3, '2013-12-20 15:00:00-08', 4, '2014-12-20 00:00:00-08', 5,'2015-12-20 00:00:00-08',6 ,'2016-12-20 00:00:00-08', 7 ,'2017-12-20 00:00:00-08', 8 ,'2012-18-20 00:00:00-08', 9 ,'2019-12-20 00:00:00-08',  10 ,'2020-12-20 00:00:00-08',  11 ,'2021-12-20 00:00:00-08',  12 ,'2022-12-20 00:00:00-08',  13 ,'20123-12-20 00:00:00-08',  14 ,'2024-12-20 00:00:00-08',  15 ,'2025-12-20 00:00:00-08', 16,'2026-12-20 00:00:00-08', 17,'2027-12-20 00:00:00-08', 18,'2028-12-20 00:00:00-08', 19,'2029-12-20 00:00:00-08');
 decode 
--------
 
(1 row)

select decode(21, 1,'2011-12-20 09:00:00-08',2,'2012-12-20 12:00:00-08', 3, '2013-12-20 15:00:00-08', 4, '2014-12-20 00:00:00-08', 5,'2015-12-20 00:00:00-08',6 ,'2016-12-20 00:00:00-08', 7 ,'2017-12-20 00:00:00-08', 8 ,'2012-18-20 00:00:00-08', 9 ,'2019-12-20 00:00:00-08',  10 ,'2020-12-20 00:00:00-08',  11 ,'2021-12-20 00:00:00-08',  12 ,'2022-12-20 00:00:00-08',  13 ,'20123-12-20 00:00:00-08',  14 ,'2024-12-20 00:00:00-08',  15 ,'2025-12-20 00:00:00-08', 16,'2026-12-20 00:00:00-08', 17,'2027-12-20 00:00:00-08', 18,'2028-12-20 00:00:00-08', 19,'2029-12-20 00:00:00-08');
 decode 
--------
 
(1 row)

select decode(22, 1,'2011-12-20 09:00:00-08',2,'2012-12-20 12:00:00-08', 3, '2013-12-20 15:00:00-08', 4, '2014-12-20 00:00:00-08', 5,'2015-12-20 00:00:00-08',6 ,'2016-12-20 00:00:00-08', 7 ,'2017-12-20 00:00:00-08', 8 ,'2012-18-20 00:00:00-08', 9 ,'2019-12-20 00:00:00-08',  10 ,'2020-12-20 00:00:00-08',  11 ,'2021-12-20 00:00:00-08',  12 ,'2022-12-20 00:00:00-08',  13 ,'20123-12-20 00:00:00-08',  14 ,'2024-12-20 00:00:00-08',  15 ,'2025-12-20 00:00:00-08', 16,'2026-12-20 00:00:00-08', 17,'2027-12-20 00:00:00-08', 18,'2028-12-20 00:00:00-08', 19,'2029-12-20 00:00:00-08');
 decode 
--------
 
(1 row)

select decode(23, 1,'2011-12-20 09:00:00-08',2,'2012-12-20 12:00:00-08', 3, '2013-12-20 15:00:00-08', 4, '2014-12-20 00:00:00-08', 5,'2015-12-20 00:00:00-08',6 ,'2016-12-20 00:00:00-08', 7 ,'2017-12-20 00:00:00-08', 8 ,'2012-18-20 00:00:00-08', 9 ,'2019-12-20 00:00:00-08',  10 ,'2020-12-20 00:00:00-08',  11 ,'2021-12-20 00:00:00-08',  12 ,'2022-12-20 00:00:00-08',  13 ,'20123-12-20 00:00:00-08',  14 ,'2024-12-20 00:00:00-08',  15 ,'2025-12-20 00:00:00-08', 16,'2026-12-20 00:00:00-08', 17,'2027-12-20 00:00:00-08', 18,'2028-12-20 00:00:00-08', 19,'2029-12-20 00:00:00-08');
 decode 
--------
 
(1 row)

-- test lpad
SELECT '|' || lpad('X123bcd'::char(8), 10) || '|';
   ?column?   
--------------
 |   X123bcd|
(1 row)

SELECT '|' || lpad('X123bcd'::char(8),  5) || '|';
 ?column? 
----------
 |X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::char(8), 1) || '|';
 ?column? 
----------
 |X|
(1 row)

SELECT '|' || lpad('X123bcd'::char(5), 10, '321X'::char(3)) || '|';
   ?column?   
--------------
 |32132X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::char(5),  5, '321X'::char(3)) || '|';
 ?column? 
----------
 |X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::char(5), 10, '321X'::text) || '|';
   ?column?   
--------------
 |321X3X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::char(5), 10, '321X'::varchar2(5)) || '|';
   ?column?   
--------------
 |321X3X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::char(5), 10, '321X'::nvarchar2(3)) || '|';
   ?column?   
--------------
 |32132X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::text, 10, '321X'::char(3)) || '|';
   ?column?   
--------------
 |321X123bcd|
(1 row)

SELECT '|' || lpad('X123bcd'::text,  5, '321X'::char(3)) || '|';
 ?column? 
----------
 |X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::varchar2(5), 10, '321X'::char(3)) || '|';
   ?column?   
--------------
 |32132X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::varchar2(5),  5, '321X'::char(3)) || '|';
 ?column? 
----------
 |X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::nvarchar2(5), 10, '321X'::char(3)) || '|';
   ?column?   
--------------
 |32132X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::nvarchar2(5),  5, '321X'::char(3)) || '|';
 ?column? 
----------
 |X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::text, 10) || '|';
   ?column?   
--------------
 |   X123bcd|
(1 row)

SELECT '|' || lpad('X123bcd'::text,  5) || '|';
 ?column? 
----------
 |X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::varchar2(10), 10) || '|';
   ?column?   
--------------
 |   X123bcd|
(1 row)

SELECT '|' || lpad('X123bcd'::varchar2(10), 5) || '|';
 ?column? 
----------
 |X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::nvarchar2(10), 10) || '|';
   ?column?   
--------------
 |   X123bcd|
(1 row)

SELECT '|' || lpad('X123bcd'::nvarchar2(10), 5) || '|';
 ?column? 
----------
 |X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::text, 10, '321X'::text) || '|';
   ?column?   
--------------
 |321X123bcd|
(1 row)

SELECT '|' || lpad('X123bcd'::text, 10, '321X'::varchar2(5)) || '|';
   ?column?   
--------------
 |321X123bcd|
(1 row)

SELECT '|' || lpad('X123bcd'::text, 10, '321X'::nvarchar2(3)) || '|';
   ?column?   
--------------
 |321X123bcd|
(1 row)

SELECT '|' || lpad('X123bcd'::varchar2(5), 10, '321X'::text) || '|';
   ?column?   
--------------
 |321X3X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::varchar2(5), 10, '321X'::varchar2(5)) || '|';
   ?column?   
--------------
 |321X3X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::varchar2(5), 10, '321X'::nvarchar2(5)) || '|';
   ?column?   
--------------
 |321X3X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::nvarchar2(5), 10, '321X'::text) || '|';
   ?column?   
--------------
 |321X3X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::nvarchar2(5), 10, '321X'::varchar2(5)) || '|';
   ?column?   
--------------
 |321X3X123b|
(1 row)

SELECT '|' || lpad('X123bcd'::nvarchar2(5), 10, '321X'::nvarchar2(5)) || '|';
   ?column?   
--------------
 |321X3X123b|
(1 row)

-- test number like text
select 9999 like '9%' from dual;
 ?column? 
----------
 t
(1 row)

select 9999 like '09%' from dual;
 ?column? 
----------
 f
(1 row)

select 9999 ilike '9%' from dual;
 ?column? 
----------
 t
(1 row)

select 9999 ilike '09%' from dual;
 ?column? 
----------
 f
(1 row)

select 9999 not like '9%' from dual;
 ?column? 
----------
 f
(1 row)

select 9999 not like '09%' from dual;
 ?column? 
----------
 t
(1 row)

select 9999 not ilike '9%' from dual;
 ?column? 
----------
 f
(1 row)

select 9999 not ilike '09%' from dual;
 ?column? 
----------
 t
(1 row)

reset enable_oracle_compatible;
reset client_min_messages;
reset datestyle;
reset intervalstyle;
reset client_encoding;
